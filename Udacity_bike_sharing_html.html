<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>9d8869f35cf44b5eb6468b8edd25e092</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<section id="predict-bike-sharing-demand-with-autogluon-template"
class="cell markdown" id="3QodsciME86r">
<h1>Predict Bike Sharing Demand with AutoGluon Template</h1>
</section>
<section id="project-predict-bike-sharing-demand-with-autogluon"
class="cell markdown" id="bfLL0E0oE86x">
<h2>Project: Predict Bike Sharing Demand with AutoGluon</h2>
<p>This notebook is a template with each step that you need to complete
for the project.</p>
<p>Please fill in your code where there are explicit <code>?</code>
markers in the notebook. You are welcome to add more cells and code as
you see fit.</p>
<p>Once you have completed all the code implementations, please export
your notebook as a HTML file so the reviews can view your code. Make
sure you have all outputs correctly outputted.</p>
<p><code>File-&gt; Export Notebook As... -&gt; Export Notebook as HTML</code></p>
<p>There is a writeup to complete as well after all code implememtation
is done. Please answer all questions and attach the necessary tables and
charts. You can complete the writeup in either markdown or PDF.</p>
<p>Completing the code template and writeup template will cover all of
the rubric points for this project.</p>
<p>The rubric contains "Stand Out Suggestions" for enhancing the project
beyond the minimum requirements. The stand out suggestions are optional.
If you decide to pursue the "stand out suggestions", you can include the
code in this notebook and also discuss the results in the writeup
file.</p>
</section>
<section id="step-1-create-an-account-with-kaggle" class="cell markdown"
id="WIEGnLolE86z">
<h2>Step 1: Create an account with Kaggle</h2>
</section>
<section id="create-kaggle-account-and-download-api-key"
class="cell markdown" id="vK_vjFOtE86z">
<h3>Create Kaggle Account and download API key</h3>
<p>Below is example of steps to get the API username and key. Each
student will have their own username and key.</p>
</section>
<div class="cell markdown" id="7esS7ZnxE860">
<ol>
<li>Open account settings. <span class="image placeholder"
data-original-image-src="kaggle1.png"
data-original-image-title="">kaggle1.png</span> <span
class="image placeholder" data-original-image-src="kaggle2.png"
data-original-image-title="">kaggle2.png</span></li>
<li>Scroll down to API and click Create New API Token. <span
class="image placeholder" data-original-image-src="kaggle3.png"
data-original-image-title="">kaggle3.png</span> <span
class="image placeholder" data-original-image-src="kaggle4.png"
data-original-image-title="">kaggle4.png</span></li>
<li>Open up <code>kaggle.json</code> and use the username and key. <span
class="image placeholder" data-original-image-src="kaggle5.png"
data-original-image-title="">kaggle5.png</span></li>
</ol>
</div>
<section
id="step-2-download-the-kaggle-dataset-using-the-kaggle-python-library"
class="cell markdown" id="k-ZNMin7E860">
<h2>Step 2: Download the Kaggle dataset using the kaggle python
library</h2>
</section>
<section id="open-up-sagemaker-studio-and-use-starter-template"
class="cell markdown" id="KRiEDnmCE861">
<h3>Open up Sagemaker Studio and use starter template</h3>
</section>
<div class="cell markdown" id="iayxLuA4E861">
<ol>
<li>Notebook should be using a <code>ml.t3.medium</code> instance (2
vCPU + 4 GiB)</li>
<li>Notebook should be using kernal:
<code>Python 3 (MXNet 1.8 Python 3.7 CPU Optimized)</code></li>
</ol>
</div>
<section id="install-packages" class="cell markdown" id="aIooW2C8E862">
<h3>Install packages</h3>
</section>
<div class="cell code" data-execution_count="1"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="BGgzXOGOE862" data-outputId="14d3db81-ae65-49d7-d158-31b3780cdcaf">
<div class="sourceCode" id="cb1"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install <span class="op">-</span>U pip</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install <span class="op">-</span>U setuptools wheel</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install <span class="op">-</span>U <span class="st">&quot;mxnet&lt;2.0.0&quot;</span> bokeh<span class="op">==</span><span class="fl">2.0.1</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install autogluon <span class="op">--</span>no<span class="op">-</span>cache<span class="op">-</span><span class="bu">dir</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Without --no-cache-dir, smaller aws instances may have trouble installing</span></span></code></pre></div>
<div class="output stream stdout">
<pre><code>Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/
Requirement already satisfied: pip in /usr/local/lib/python3.10/dist-packages (23.1.2)
Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/
Requirement already satisfied: setuptools in /usr/local/lib/python3.10/dist-packages (67.8.0)
Requirement already satisfied: wheel in /usr/local/lib/python3.10/dist-packages (0.40.0)
Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/
Requirement already satisfied: mxnet&lt;2.0.0 in /usr/local/lib/python3.10/dist-packages (1.9.1)
Requirement already satisfied: bokeh==2.0.1 in /usr/local/lib/python3.10/dist-packages (2.0.1)
Requirement already satisfied: PyYAML&gt;=3.10 in /usr/local/lib/python3.10/dist-packages (from bokeh==2.0.1) (6.0)
Requirement already satisfied: python-dateutil&gt;=2.1 in /usr/local/lib/python3.10/dist-packages (from bokeh==2.0.1) (2.8.2)
Requirement already satisfied: Jinja2&gt;=2.7 in /usr/local/lib/python3.10/dist-packages (from bokeh==2.0.1) (3.1.2)
Requirement already satisfied: numpy&gt;=1.11.3 in /usr/local/lib/python3.10/dist-packages (from bokeh==2.0.1) (1.22.4)
Requirement already satisfied: pillow&gt;=4.0 in /usr/local/lib/python3.10/dist-packages (from bokeh==2.0.1) (9.5.0)
Requirement already satisfied: packaging&gt;=16.8 in /usr/local/lib/python3.10/dist-packages (from bokeh==2.0.1) (23.1)
Requirement already satisfied: tornado&gt;=5 in /usr/local/lib/python3.10/dist-packages (from bokeh==2.0.1) (6.3.1)
Requirement already satisfied: typing-extensions&gt;=3.7.4 in /usr/local/lib/python3.10/dist-packages (from bokeh==2.0.1) (4.5.0)
Requirement already satisfied: requests&lt;3,&gt;=2.20.0 in /usr/local/lib/python3.10/dist-packages (from mxnet&lt;2.0.0) (2.27.1)
Requirement already satisfied: graphviz&lt;0.9.0,&gt;=0.8.1 in /usr/local/lib/python3.10/dist-packages (from mxnet&lt;2.0.0) (0.8.4)
Requirement already satisfied: MarkupSafe&gt;=2.0 in /usr/local/lib/python3.10/dist-packages (from Jinja2&gt;=2.7-&gt;bokeh==2.0.1) (2.1.2)
Requirement already satisfied: six&gt;=1.5 in /usr/local/lib/python3.10/dist-packages (from python-dateutil&gt;=2.1-&gt;bokeh==2.0.1) (1.16.0)
Requirement already satisfied: urllib3&lt;1.27,&gt;=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests&lt;3,&gt;=2.20.0-&gt;mxnet&lt;2.0.0) (1.26.15)
Requirement already satisfied: certifi&gt;=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests&lt;3,&gt;=2.20.0-&gt;mxnet&lt;2.0.0) (2022.12.7)
Requirement already satisfied: charset-normalizer~=2.0.0 in /usr/local/lib/python3.10/dist-packages (from requests&lt;3,&gt;=2.20.0-&gt;mxnet&lt;2.0.0) (2.0.12)
Requirement already satisfied: idna&lt;4,&gt;=2.5 in /usr/local/lib/python3.10/dist-packages (from requests&lt;3,&gt;=2.20.0-&gt;mxnet&lt;2.0.0) (3.4)
Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/
Requirement already satisfied: autogluon in /usr/local/lib/python3.10/dist-packages (0.7.0)
Requirement already satisfied: autogluon.core[all]==0.7.0 in /usr/local/lib/python3.10/dist-packages (from autogluon) (0.7.0)
Requirement already satisfied: autogluon.features==0.7.0 in /usr/local/lib/python3.10/dist-packages (from autogluon) (0.7.0)
Requirement already satisfied: autogluon.tabular[all]==0.7.0 in /usr/local/lib/python3.10/dist-packages (from autogluon) (0.7.0)
Requirement already satisfied: autogluon.multimodal==0.7.0 in /usr/local/lib/python3.10/dist-packages (from autogluon) (0.7.0)
Requirement already satisfied: autogluon.timeseries[all]==0.7.0 in /usr/local/lib/python3.10/dist-packages (from autogluon) (0.7.0)
Requirement already satisfied: numpy&lt;1.27,&gt;=1.21 in /usr/local/lib/python3.10/dist-packages (from autogluon.core[all]==0.7.0-&gt;autogluon) (1.22.4)
Requirement already satisfied: scipy&lt;1.12,&gt;=1.5.4 in /usr/local/lib/python3.10/dist-packages (from autogluon.core[all]==0.7.0-&gt;autogluon) (1.10.1)
Requirement already satisfied: scikit-learn&lt;1.3,&gt;=1.0 in /usr/local/lib/python3.10/dist-packages (from autogluon.core[all]==0.7.0-&gt;autogluon) (1.2.2)
Requirement already satisfied: networkx&lt;3.0,&gt;=2.3 in /usr/local/lib/python3.10/dist-packages (from autogluon.core[all]==0.7.0-&gt;autogluon) (2.8.8)
Requirement already satisfied: pandas&lt;1.6,&gt;=1.4.1 in /usr/local/lib/python3.10/dist-packages (from autogluon.core[all]==0.7.0-&gt;autogluon) (1.5.3)
Requirement already satisfied: tqdm&lt;5,&gt;=4.38 in /usr/local/lib/python3.10/dist-packages (from autogluon.core[all]==0.7.0-&gt;autogluon) (4.65.0)
Requirement already satisfied: requests in /usr/local/lib/python3.10/dist-packages (from autogluon.core[all]==0.7.0-&gt;autogluon) (2.27.1)
Requirement already satisfied: matplotlib in /usr/local/lib/python3.10/dist-packages (from autogluon.core[all]==0.7.0-&gt;autogluon) (3.7.1)
Requirement already satisfied: boto3&lt;2,&gt;=1.10 in /usr/local/lib/python3.10/dist-packages (from autogluon.core[all]==0.7.0-&gt;autogluon) (1.26.142)
Requirement already satisfied: autogluon.common==0.7.0 in /usr/local/lib/python3.10/dist-packages (from autogluon.core[all]==0.7.0-&gt;autogluon) (0.7.0)
Requirement already satisfied: hyperopt&lt;0.2.8,&gt;=0.2.7 in /usr/local/lib/python3.10/dist-packages (from autogluon.core[all]==0.7.0-&gt;autogluon) (0.2.7)
Requirement already satisfied: ray[tune]&lt;2.3,&gt;=2.2 in /usr/local/lib/python3.10/dist-packages (from autogluon.core[all]==0.7.0-&gt;autogluon) (2.2.0)
Requirement already satisfied: Pillow&lt;9.6,&gt;=9.3 in /usr/local/lib/python3.10/dist-packages (from autogluon.multimodal==0.7.0-&gt;autogluon) (9.5.0)
Requirement already satisfied: jsonschema&lt;4.18,&gt;=4.14 in /usr/local/lib/python3.10/dist-packages (from autogluon.multimodal==0.7.0-&gt;autogluon) (4.17.3)
Requirement already satisfied: seqeval&lt;1.3.0,&gt;=1.2.2 in /usr/local/lib/python3.10/dist-packages (from autogluon.multimodal==0.7.0-&gt;autogluon) (1.2.2)
Requirement already satisfied: evaluate&lt;0.4.0,&gt;=0.2.2 in /usr/local/lib/python3.10/dist-packages (from autogluon.multimodal==0.7.0-&gt;autogluon) (0.3.0)
Requirement already satisfied: accelerate&lt;0.17,&gt;=0.9 in /usr/local/lib/python3.10/dist-packages (from autogluon.multimodal==0.7.0-&gt;autogluon) (0.16.0)
Requirement already satisfied: timm&lt;0.7.0,&gt;=0.6.12 in /usr/local/lib/python3.10/dist-packages (from autogluon.multimodal==0.7.0-&gt;autogluon) (0.6.13)
Requirement already satisfied: torch&lt;1.14,&gt;=1.9 in /usr/local/lib/python3.10/dist-packages (from autogluon.multimodal==0.7.0-&gt;autogluon) (1.13.1)
Requirement already satisfied: torchvision&lt;0.15.0 in /usr/local/lib/python3.10/dist-packages (from autogluon.multimodal==0.7.0-&gt;autogluon) (0.14.1)
Requirement already satisfied: fairscale&lt;0.4.14,&gt;=0.4.5 in /usr/local/lib/python3.10/dist-packages (from autogluon.multimodal==0.7.0-&gt;autogluon) (0.4.13)
Requirement already satisfied: scikit-image&lt;0.20.0,&gt;=0.19.1 in /usr/local/lib/python3.10/dist-packages (from autogluon.multimodal==0.7.0-&gt;autogluon) (0.19.3)
Requirement already satisfied: pytorch-lightning&lt;1.10.0,&gt;=1.9.0 in /usr/local/lib/python3.10/dist-packages (from autogluon.multimodal==0.7.0-&gt;autogluon) (1.9.5)
Requirement already satisfied: text-unidecode&lt;1.4,&gt;=1.3 in /usr/local/lib/python3.10/dist-packages (from autogluon.multimodal==0.7.0-&gt;autogluon) (1.3)
Requirement already satisfied: torchmetrics&lt;0.9.0,&gt;=0.8.0 in /usr/local/lib/python3.10/dist-packages (from autogluon.multimodal==0.7.0-&gt;autogluon) (0.8.2)
Requirement already satisfied: transformers&lt;4.27.0,&gt;=4.23.0 in /usr/local/lib/python3.10/dist-packages (from autogluon.multimodal==0.7.0-&gt;autogluon) (4.26.1)
Requirement already satisfied: nptyping&lt;2.5.0,&gt;=1.4.4 in /usr/local/lib/python3.10/dist-packages (from autogluon.multimodal==0.7.0-&gt;autogluon) (2.4.1)
Requirement already satisfied: omegaconf&lt;2.3.0,&gt;=2.1.1 in /usr/local/lib/python3.10/dist-packages (from autogluon.multimodal==0.7.0-&gt;autogluon) (2.2.3)
Requirement already satisfied: sentencepiece&lt;0.2.0,&gt;=0.1.95 in /usr/local/lib/python3.10/dist-packages (from autogluon.multimodal==0.7.0-&gt;autogluon) (0.1.99)
Requirement already satisfied: pytorch-metric-learning&lt;2.0,&gt;=1.3.0 in /usr/local/lib/python3.10/dist-packages (from autogluon.multimodal==0.7.0-&gt;autogluon) (1.7.3)
Requirement already satisfied: nlpaug&lt;1.2.0,&gt;=1.1.10 in /usr/local/lib/python3.10/dist-packages (from autogluon.multimodal==0.7.0-&gt;autogluon) (1.1.11)
Requirement already satisfied: nltk&lt;4.0.0,&gt;=3.4.5 in /usr/local/lib/python3.10/dist-packages (from autogluon.multimodal==0.7.0-&gt;autogluon) (3.8.1)
Requirement already satisfied: openmim&lt;0.4.0,&gt;0.1.5 in /usr/local/lib/python3.10/dist-packages (from autogluon.multimodal==0.7.0-&gt;autogluon) (0.3.7)
Requirement already satisfied: defusedxml&lt;0.7.2,&gt;=0.7.1 in /usr/local/lib/python3.10/dist-packages (from autogluon.multimodal==0.7.0-&gt;autogluon) (0.7.1)
Requirement already satisfied: jinja2&lt;3.2,&gt;=3.0.3 in /usr/local/lib/python3.10/dist-packages (from autogluon.multimodal==0.7.0-&gt;autogluon) (3.1.2)
Requirement already satisfied: tensorboard&lt;3,&gt;=2.9 in /usr/local/lib/python3.10/dist-packages (from autogluon.multimodal==0.7.0-&gt;autogluon) (2.12.2)
Requirement already satisfied: pytesseract&lt;0.3.11,&gt;=0.3.9 in /usr/local/lib/python3.10/dist-packages (from autogluon.multimodal==0.7.0-&gt;autogluon) (0.3.10)
Requirement already satisfied: catboost&lt;1.2,&gt;=1.0 in /usr/local/lib/python3.10/dist-packages (from autogluon.tabular[all]==0.7.0-&gt;autogluon) (1.1.1)
Requirement already satisfied: lightgbm&lt;3.4,&gt;=3.3 in /usr/local/lib/python3.10/dist-packages (from autogluon.tabular[all]==0.7.0-&gt;autogluon) (3.3.5)
Requirement already satisfied: xgboost&lt;1.8,&gt;=1.6 in /usr/local/lib/python3.10/dist-packages (from autogluon.tabular[all]==0.7.0-&gt;autogluon) (1.7.5)
Requirement already satisfied: fastai&lt;2.8,&gt;=2.3.1 in /usr/local/lib/python3.10/dist-packages (from autogluon.tabular[all]==0.7.0-&gt;autogluon) (2.7.12)
Requirement already satisfied: joblib&lt;2,&gt;=1.1 in /usr/local/lib/python3.10/dist-packages (from autogluon.timeseries[all]==0.7.0-&gt;autogluon) (1.2.0)
Requirement already satisfied: statsmodels&lt;0.14,&gt;=0.13.0 in /usr/local/lib/python3.10/dist-packages (from autogluon.timeseries[all]==0.7.0-&gt;autogluon) (0.13.5)
Requirement already satisfied: gluonts&lt;0.13,&gt;=0.12.0 in /usr/local/lib/python3.10/dist-packages (from autogluon.timeseries[all]==0.7.0-&gt;autogluon) (0.12.8)
Requirement already satisfied: statsforecast&lt;1.5,&gt;=1.4.0 in /usr/local/lib/python3.10/dist-packages (from autogluon.timeseries[all]==0.7.0-&gt;autogluon) (1.4.0)
Requirement already satisfied: ujson&lt;6,&gt;=5 in /usr/local/lib/python3.10/dist-packages (from autogluon.timeseries[all]==0.7.0-&gt;autogluon) (5.7.0)
Requirement already satisfied: sktime&lt;0.16,&gt;=0.14 in /usr/local/lib/python3.10/dist-packages (from autogluon.timeseries[all]==0.7.0-&gt;autogluon) (0.15.1)
Requirement already satisfied: tbats&lt;2,&gt;=1.1 in /usr/local/lib/python3.10/dist-packages (from autogluon.timeseries[all]==0.7.0-&gt;autogluon) (1.1.3)
Requirement already satisfied: pmdarima&lt;1.9,&gt;=1.8.2 in /usr/local/lib/python3.10/dist-packages (from autogluon.timeseries[all]==0.7.0-&gt;autogluon) (1.8.5)
Requirement already satisfied: psutil&lt;6,&gt;=5.7.3 in /usr/local/lib/python3.10/dist-packages (from autogluon.common==0.7.0-&gt;autogluon.core[all]==0.7.0-&gt;autogluon) (5.9.5)
Requirement already satisfied: setuptools in /usr/local/lib/python3.10/dist-packages (from autogluon.common==0.7.0-&gt;autogluon.core[all]==0.7.0-&gt;autogluon) (67.8.0)
Requirement already satisfied: packaging&gt;=20.0 in /usr/local/lib/python3.10/dist-packages (from accelerate&lt;0.17,&gt;=0.9-&gt;autogluon.multimodal==0.7.0-&gt;autogluon) (23.1)
Requirement already satisfied: pyyaml in /usr/local/lib/python3.10/dist-packages (from accelerate&lt;0.17,&gt;=0.9-&gt;autogluon.multimodal==0.7.0-&gt;autogluon) (6.0)
Requirement already satisfied: botocore&lt;1.30.0,&gt;=1.29.142 in /usr/local/lib/python3.10/dist-packages (from boto3&lt;2,&gt;=1.10-&gt;autogluon.core[all]==0.7.0-&gt;autogluon) (1.29.142)
Requirement already satisfied: jmespath&lt;2.0.0,&gt;=0.7.1 in /usr/local/lib/python3.10/dist-packages (from boto3&lt;2,&gt;=1.10-&gt;autogluon.core[all]==0.7.0-&gt;autogluon) (1.0.1)
Requirement already satisfied: s3transfer&lt;0.7.0,&gt;=0.6.0 in /usr/local/lib/python3.10/dist-packages (from boto3&lt;2,&gt;=1.10-&gt;autogluon.core[all]==0.7.0-&gt;autogluon) (0.6.1)
Requirement already satisfied: graphviz in /usr/local/lib/python3.10/dist-packages (from catboost&lt;1.2,&gt;=1.0-&gt;autogluon.tabular[all]==0.7.0-&gt;autogluon) (0.8.4)
Requirement already satisfied: plotly in /usr/local/lib/python3.10/dist-packages (from catboost&lt;1.2,&gt;=1.0-&gt;autogluon.tabular[all]==0.7.0-&gt;autogluon) (5.13.1)
Requirement already satisfied: six in /usr/local/lib/python3.10/dist-packages (from catboost&lt;1.2,&gt;=1.0-&gt;autogluon.tabular[all]==0.7.0-&gt;autogluon) (1.16.0)
Requirement already satisfied: datasets&gt;=2.0.0 in /usr/local/lib/python3.10/dist-packages (from evaluate&lt;0.4.0,&gt;=0.2.2-&gt;autogluon.multimodal==0.7.0-&gt;autogluon) (2.12.0)
Requirement already satisfied: dill in /usr/local/lib/python3.10/dist-packages (from evaluate&lt;0.4.0,&gt;=0.2.2-&gt;autogluon.multimodal==0.7.0-&gt;autogluon) (0.3.6)
Requirement already satisfied: xxhash in /usr/local/lib/python3.10/dist-packages (from evaluate&lt;0.4.0,&gt;=0.2.2-&gt;autogluon.multimodal==0.7.0-&gt;autogluon) (3.2.0)
Requirement already satisfied: multiprocess in /usr/local/lib/python3.10/dist-packages (from evaluate&lt;0.4.0,&gt;=0.2.2-&gt;autogluon.multimodal==0.7.0-&gt;autogluon) (0.70.14)
Requirement already satisfied: fsspec[http]&gt;=2021.05.0 in /usr/local/lib/python3.10/dist-packages (from evaluate&lt;0.4.0,&gt;=0.2.2-&gt;autogluon.multimodal==0.7.0-&gt;autogluon) (2023.4.0)
Requirement already satisfied: huggingface-hub&gt;=0.7.0 in /usr/local/lib/python3.10/dist-packages (from evaluate&lt;0.4.0,&gt;=0.2.2-&gt;autogluon.multimodal==0.7.0-&gt;autogluon) (0.14.1)
Requirement already satisfied: responses&lt;0.19 in /usr/local/lib/python3.10/dist-packages (from evaluate&lt;0.4.0,&gt;=0.2.2-&gt;autogluon.multimodal==0.7.0-&gt;autogluon) (0.18.0)
Requirement already satisfied: pip in /usr/local/lib/python3.10/dist-packages (from fastai&lt;2.8,&gt;=2.3.1-&gt;autogluon.tabular[all]==0.7.0-&gt;autogluon) (23.1.2)
Requirement already satisfied: fastdownload&lt;2,&gt;=0.0.5 in /usr/local/lib/python3.10/dist-packages (from fastai&lt;2.8,&gt;=2.3.1-&gt;autogluon.tabular[all]==0.7.0-&gt;autogluon) (0.0.7)
Requirement already satisfied: fastcore&lt;1.6,&gt;=1.5.29 in /usr/local/lib/python3.10/dist-packages (from fastai&lt;2.8,&gt;=2.3.1-&gt;autogluon.tabular[all]==0.7.0-&gt;autogluon) (1.5.29)
Requirement already satisfied: fastprogress&gt;=0.2.4 in /usr/local/lib/python3.10/dist-packages (from fastai&lt;2.8,&gt;=2.3.1-&gt;autogluon.tabular[all]==0.7.0-&gt;autogluon) (1.0.3)
Requirement already satisfied: spacy&lt;4 in /usr/local/lib/python3.10/dist-packages (from fastai&lt;2.8,&gt;=2.3.1-&gt;autogluon.tabular[all]==0.7.0-&gt;autogluon) (3.5.2)
Requirement already satisfied: pydantic~=1.7 in /usr/local/lib/python3.10/dist-packages (from gluonts&lt;0.13,&gt;=0.12.0-&gt;autogluon.timeseries[all]==0.7.0-&gt;autogluon) (1.10.7)
Requirement already satisfied: toolz~=0.10 in /usr/local/lib/python3.10/dist-packages (from gluonts&lt;0.13,&gt;=0.12.0-&gt;autogluon.timeseries[all]==0.7.0-&gt;autogluon) (0.12.0)
Requirement already satisfied: typing-extensions~=4.0 in /usr/local/lib/python3.10/dist-packages (from gluonts&lt;0.13,&gt;=0.12.0-&gt;autogluon.timeseries[all]==0.7.0-&gt;autogluon) (4.5.0)
Requirement already satisfied: future in /usr/local/lib/python3.10/dist-packages (from hyperopt&lt;0.2.8,&gt;=0.2.7-&gt;autogluon.core[all]==0.7.0-&gt;autogluon) (0.18.3)
Requirement already satisfied: cloudpickle in /usr/local/lib/python3.10/dist-packages (from hyperopt&lt;0.2.8,&gt;=0.2.7-&gt;autogluon.core[all]==0.7.0-&gt;autogluon) (2.2.1)
Requirement already satisfied: py4j in /usr/local/lib/python3.10/dist-packages (from hyperopt&lt;0.2.8,&gt;=0.2.7-&gt;autogluon.core[all]==0.7.0-&gt;autogluon) (0.10.9.7)
Requirement already satisfied: MarkupSafe&gt;=2.0 in /usr/local/lib/python3.10/dist-packages (from jinja2&lt;3.2,&gt;=3.0.3-&gt;autogluon.multimodal==0.7.0-&gt;autogluon) (2.1.2)
Requirement already satisfied: attrs&gt;=17.4.0 in /usr/local/lib/python3.10/dist-packages (from jsonschema&lt;4.18,&gt;=4.14-&gt;autogluon.multimodal==0.7.0-&gt;autogluon) (23.1.0)
Requirement already satisfied: pyrsistent!=0.17.0,!=0.17.1,!=0.17.2,&gt;=0.14.0 in /usr/local/lib/python3.10/dist-packages (from jsonschema&lt;4.18,&gt;=4.14-&gt;autogluon.multimodal==0.7.0-&gt;autogluon) (0.19.3)
Requirement already satisfied: wheel in /usr/local/lib/python3.10/dist-packages (from lightgbm&lt;3.4,&gt;=3.3-&gt;autogluon.tabular[all]==0.7.0-&gt;autogluon) (0.40.0)
Requirement already satisfied: gdown&gt;=4.0.0 in /usr/local/lib/python3.10/dist-packages (from nlpaug&lt;1.2.0,&gt;=1.1.10-&gt;autogluon.multimodal==0.7.0-&gt;autogluon) (4.6.6)
Requirement already satisfied: click in /usr/local/lib/python3.10/dist-packages (from nltk&lt;4.0.0,&gt;=3.4.5-&gt;autogluon.multimodal==0.7.0-&gt;autogluon) (8.1.3)
Requirement already satisfied: regex&gt;=2021.8.3 in /usr/local/lib/python3.10/dist-packages (from nltk&lt;4.0.0,&gt;=3.4.5-&gt;autogluon.multimodal==0.7.0-&gt;autogluon) (2022.10.31)
Requirement already satisfied: antlr4-python3-runtime==4.9.* in /usr/local/lib/python3.10/dist-packages (from omegaconf&lt;2.3.0,&gt;=2.1.1-&gt;autogluon.multimodal==0.7.0-&gt;autogluon) (4.9.3)
Requirement already satisfied: colorama in /usr/local/lib/python3.10/dist-packages (from openmim&lt;0.4.0,&gt;0.1.5-&gt;autogluon.multimodal==0.7.0-&gt;autogluon) (0.4.6)
Requirement already satisfied: model-index in /usr/local/lib/python3.10/dist-packages (from openmim&lt;0.4.0,&gt;0.1.5-&gt;autogluon.multimodal==0.7.0-&gt;autogluon) (0.1.11)
Requirement already satisfied: rich in /usr/local/lib/python3.10/dist-packages (from openmim&lt;0.4.0,&gt;0.1.5-&gt;autogluon.multimodal==0.7.0-&gt;autogluon) (13.3.4)
Requirement already satisfied: tabulate in /usr/local/lib/python3.10/dist-packages (from openmim&lt;0.4.0,&gt;0.1.5-&gt;autogluon.multimodal==0.7.0-&gt;autogluon) (0.8.10)
Requirement already satisfied: python-dateutil&gt;=2.8.1 in /usr/local/lib/python3.10/dist-packages (from pandas&lt;1.6,&gt;=1.4.1-&gt;autogluon.core[all]==0.7.0-&gt;autogluon) (2.8.2)
Requirement already satisfied: pytz&gt;=2020.1 in /usr/local/lib/python3.10/dist-packages (from pandas&lt;1.6,&gt;=1.4.1-&gt;autogluon.core[all]==0.7.0-&gt;autogluon) (2022.7.1)
Requirement already satisfied: Cython!=0.29.18,&gt;=0.29 in /usr/local/lib/python3.10/dist-packages (from pmdarima&lt;1.9,&gt;=1.8.2-&gt;autogluon.timeseries[all]==0.7.0-&gt;autogluon) (0.29.34)
Requirement already satisfied: urllib3 in /usr/local/lib/python3.10/dist-packages (from pmdarima&lt;1.9,&gt;=1.8.2-&gt;autogluon.timeseries[all]==0.7.0-&gt;autogluon) (1.26.15)
Requirement already satisfied: lightning-utilities&gt;=0.6.0.post0 in /usr/local/lib/python3.10/dist-packages (from pytorch-lightning&lt;1.10.0,&gt;=1.9.0-&gt;autogluon.multimodal==0.7.0-&gt;autogluon) (0.8.0)
Requirement already satisfied: filelock in /usr/local/lib/python3.10/dist-packages (from ray[tune]&lt;2.3,&gt;=2.2-&gt;autogluon.core[all]==0.7.0-&gt;autogluon) (3.12.0)
Requirement already satisfied: msgpack&lt;2.0.0,&gt;=1.0.0 in /usr/local/lib/python3.10/dist-packages (from ray[tune]&lt;2.3,&gt;=2.2-&gt;autogluon.core[all]==0.7.0-&gt;autogluon) (1.0.5)
Requirement already satisfied: protobuf!=3.19.5,&gt;=3.15.3 in /usr/local/lib/python3.10/dist-packages (from ray[tune]&lt;2.3,&gt;=2.2-&gt;autogluon.core[all]==0.7.0-&gt;autogluon) (3.20.3)
Requirement already satisfied: aiosignal in /usr/local/lib/python3.10/dist-packages (from ray[tune]&lt;2.3,&gt;=2.2-&gt;autogluon.core[all]==0.7.0-&gt;autogluon) (1.3.1)
Requirement already satisfied: frozenlist in /usr/local/lib/python3.10/dist-packages (from ray[tune]&lt;2.3,&gt;=2.2-&gt;autogluon.core[all]==0.7.0-&gt;autogluon) (1.3.3)
Requirement already satisfied: virtualenv&gt;=20.0.24 in /usr/local/lib/python3.10/dist-packages (from ray[tune]&lt;2.3,&gt;=2.2-&gt;autogluon.core[all]==0.7.0-&gt;autogluon) (20.23.0)
Requirement already satisfied: grpcio&gt;=1.42.0 in /usr/local/lib/python3.10/dist-packages (from ray[tune]&lt;2.3,&gt;=2.2-&gt;autogluon.core[all]==0.7.0-&gt;autogluon) (1.54.0)
Requirement already satisfied: tensorboardX&gt;=1.9 in /usr/local/lib/python3.10/dist-packages (from ray[tune]&lt;2.3,&gt;=2.2-&gt;autogluon.core[all]==0.7.0-&gt;autogluon) (2.6)
Requirement already satisfied: certifi&gt;=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests-&gt;autogluon.core[all]==0.7.0-&gt;autogluon) (2022.12.7)
Requirement already satisfied: charset-normalizer~=2.0.0 in /usr/local/lib/python3.10/dist-packages (from requests-&gt;autogluon.core[all]==0.7.0-&gt;autogluon) (2.0.12)
Requirement already satisfied: idna&lt;4,&gt;=2.5 in /usr/local/lib/python3.10/dist-packages (from requests-&gt;autogluon.core[all]==0.7.0-&gt;autogluon) (3.4)
Requirement already satisfied: imageio&gt;=2.4.1 in /usr/local/lib/python3.10/dist-packages (from scikit-image&lt;0.20.0,&gt;=0.19.1-&gt;autogluon.multimodal==0.7.0-&gt;autogluon) (2.25.1)
Requirement already satisfied: tifffile&gt;=2019.7.26 in /usr/local/lib/python3.10/dist-packages (from scikit-image&lt;0.20.0,&gt;=0.19.1-&gt;autogluon.multimodal==0.7.0-&gt;autogluon) (2023.4.12)
Requirement already satisfied: PyWavelets&gt;=1.1.1 in /usr/local/lib/python3.10/dist-packages (from scikit-image&lt;0.20.0,&gt;=0.19.1-&gt;autogluon.multimodal==0.7.0-&gt;autogluon) (1.4.1)
Requirement already satisfied: threadpoolctl&gt;=2.0.0 in /usr/local/lib/python3.10/dist-packages (from scikit-learn&lt;1.3,&gt;=1.0-&gt;autogluon.core[all]==0.7.0-&gt;autogluon) (3.1.0)
Requirement already satisfied: deprecated&gt;=1.2.13 in /usr/local/lib/python3.10/dist-packages (from sktime&lt;0.16,&gt;=0.14-&gt;autogluon.timeseries[all]==0.7.0-&gt;autogluon) (1.2.14)
Requirement already satisfied: numba&gt;=0.55 in /usr/local/lib/python3.10/dist-packages (from sktime&lt;0.16,&gt;=0.14-&gt;autogluon.timeseries[all]==0.7.0-&gt;autogluon) (0.56.4)
Requirement already satisfied: patsy&gt;=0.5.2 in /usr/local/lib/python3.10/dist-packages (from statsmodels&lt;0.14,&gt;=0.13.0-&gt;autogluon.timeseries[all]==0.7.0-&gt;autogluon) (0.5.3)
Requirement already satisfied: absl-py&gt;=0.4 in /usr/local/lib/python3.10/dist-packages (from tensorboard&lt;3,&gt;=2.9-&gt;autogluon.multimodal==0.7.0-&gt;autogluon) (1.4.0)
Requirement already satisfied: google-auth&lt;3,&gt;=1.6.3 in /usr/local/lib/python3.10/dist-packages (from tensorboard&lt;3,&gt;=2.9-&gt;autogluon.multimodal==0.7.0-&gt;autogluon) (2.17.3)
Requirement already satisfied: google-auth-oauthlib&lt;1.1,&gt;=0.5 in /usr/local/lib/python3.10/dist-packages (from tensorboard&lt;3,&gt;=2.9-&gt;autogluon.multimodal==0.7.0-&gt;autogluon) (1.0.0)
Requirement already satisfied: markdown&gt;=2.6.8 in /usr/local/lib/python3.10/dist-packages (from tensorboard&lt;3,&gt;=2.9-&gt;autogluon.multimodal==0.7.0-&gt;autogluon) (3.4.3)
Requirement already satisfied: tensorboard-data-server&lt;0.8.0,&gt;=0.7.0 in /usr/local/lib/python3.10/dist-packages (from tensorboard&lt;3,&gt;=2.9-&gt;autogluon.multimodal==0.7.0-&gt;autogluon) (0.7.0)
Requirement already satisfied: tensorboard-plugin-wit&gt;=1.6.0 in /usr/local/lib/python3.10/dist-packages (from tensorboard&lt;3,&gt;=2.9-&gt;autogluon.multimodal==0.7.0-&gt;autogluon) (1.8.1)
Requirement already satisfied: werkzeug&gt;=1.0.1 in /usr/local/lib/python3.10/dist-packages (from tensorboard&lt;3,&gt;=2.9-&gt;autogluon.multimodal==0.7.0-&gt;autogluon) (2.3.0)
Requirement already satisfied: nvidia-cuda-runtime-cu11==11.7.99 in /usr/local/lib/python3.10/dist-packages (from torch&lt;1.14,&gt;=1.9-&gt;autogluon.multimodal==0.7.0-&gt;autogluon) (11.7.99)
Requirement already satisfied: nvidia-cudnn-cu11==8.5.0.96 in /usr/local/lib/python3.10/dist-packages (from torch&lt;1.14,&gt;=1.9-&gt;autogluon.multimodal==0.7.0-&gt;autogluon) (8.5.0.96)
Requirement already satisfied: nvidia-cublas-cu11==11.10.3.66 in /usr/local/lib/python3.10/dist-packages (from torch&lt;1.14,&gt;=1.9-&gt;autogluon.multimodal==0.7.0-&gt;autogluon) (11.10.3.66)
Requirement already satisfied: nvidia-cuda-nvrtc-cu11==11.7.99 in /usr/local/lib/python3.10/dist-packages (from torch&lt;1.14,&gt;=1.9-&gt;autogluon.multimodal==0.7.0-&gt;autogluon) (11.7.99)
Requirement already satisfied: pyDeprecate==0.3.* in /usr/local/lib/python3.10/dist-packages (from torchmetrics&lt;0.9.0,&gt;=0.8.0-&gt;autogluon.multimodal==0.7.0-&gt;autogluon) (0.3.2)
Requirement already satisfied: tokenizers!=0.11.3,&lt;0.14,&gt;=0.11.1 in /usr/local/lib/python3.10/dist-packages (from transformers&lt;4.27.0,&gt;=4.23.0-&gt;autogluon.multimodal==0.7.0-&gt;autogluon) (0.13.3)
Requirement already satisfied: contourpy&gt;=1.0.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib-&gt;autogluon.core[all]==0.7.0-&gt;autogluon) (1.0.7)
Requirement already satisfied: cycler&gt;=0.10 in /usr/local/lib/python3.10/dist-packages (from matplotlib-&gt;autogluon.core[all]==0.7.0-&gt;autogluon) (0.11.0)
Requirement already satisfied: fonttools&gt;=4.22.0 in /usr/local/lib/python3.10/dist-packages (from matplotlib-&gt;autogluon.core[all]==0.7.0-&gt;autogluon) (4.39.3)
Requirement already satisfied: kiwisolver&gt;=1.0.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib-&gt;autogluon.core[all]==0.7.0-&gt;autogluon) (1.4.4)
Requirement already satisfied: pyparsing&gt;=2.3.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib-&gt;autogluon.core[all]==0.7.0-&gt;autogluon) (3.0.9)
Requirement already satisfied: pyarrow&gt;=8.0.0 in /usr/local/lib/python3.10/dist-packages (from datasets&gt;=2.0.0-&gt;evaluate&lt;0.4.0,&gt;=0.2.2-&gt;autogluon.multimodal==0.7.0-&gt;autogluon) (9.0.0)
Requirement already satisfied: aiohttp in /usr/local/lib/python3.10/dist-packages (from datasets&gt;=2.0.0-&gt;evaluate&lt;0.4.0,&gt;=0.2.2-&gt;autogluon.multimodal==0.7.0-&gt;autogluon) (3.8.4)
Requirement already satisfied: wrapt&lt;2,&gt;=1.10 in /usr/local/lib/python3.10/dist-packages (from deprecated&gt;=1.2.13-&gt;sktime&lt;0.16,&gt;=0.14-&gt;autogluon.timeseries[all]==0.7.0-&gt;autogluon) (1.14.1)
Requirement already satisfied: beautifulsoup4 in /usr/local/lib/python3.10/dist-packages (from gdown&gt;=4.0.0-&gt;nlpaug&lt;1.2.0,&gt;=1.1.10-&gt;autogluon.multimodal==0.7.0-&gt;autogluon) (4.11.2)
Requirement already satisfied: cachetools&lt;6.0,&gt;=2.0.0 in /usr/local/lib/python3.10/dist-packages (from google-auth&lt;3,&gt;=1.6.3-&gt;tensorboard&lt;3,&gt;=2.9-&gt;autogluon.multimodal==0.7.0-&gt;autogluon) (5.3.0)
Requirement already satisfied: pyasn1-modules&gt;=0.2.1 in /usr/local/lib/python3.10/dist-packages (from google-auth&lt;3,&gt;=1.6.3-&gt;tensorboard&lt;3,&gt;=2.9-&gt;autogluon.multimodal==0.7.0-&gt;autogluon) (0.3.0)
Requirement already satisfied: rsa&lt;5,&gt;=3.1.4 in /usr/local/lib/python3.10/dist-packages (from google-auth&lt;3,&gt;=1.6.3-&gt;tensorboard&lt;3,&gt;=2.9-&gt;autogluon.multimodal==0.7.0-&gt;autogluon) (4.9)
Requirement already satisfied: requests-oauthlib&gt;=0.7.0 in /usr/local/lib/python3.10/dist-packages (from google-auth-oauthlib&lt;1.1,&gt;=0.5-&gt;tensorboard&lt;3,&gt;=2.9-&gt;autogluon.multimodal==0.7.0-&gt;autogluon) (1.3.1)
Requirement already satisfied: llvmlite&lt;0.40,&gt;=0.39.0dev0 in /usr/local/lib/python3.10/dist-packages (from numba&gt;=0.55-&gt;sktime&lt;0.16,&gt;=0.14-&gt;autogluon.timeseries[all]==0.7.0-&gt;autogluon) (0.39.1)
Requirement already satisfied: spacy-legacy&lt;3.1.0,&gt;=3.0.11 in /usr/local/lib/python3.10/dist-packages (from spacy&lt;4-&gt;fastai&lt;2.8,&gt;=2.3.1-&gt;autogluon.tabular[all]==0.7.0-&gt;autogluon) (3.0.12)
Requirement already satisfied: spacy-loggers&lt;2.0.0,&gt;=1.0.0 in /usr/local/lib/python3.10/dist-packages (from spacy&lt;4-&gt;fastai&lt;2.8,&gt;=2.3.1-&gt;autogluon.tabular[all]==0.7.0-&gt;autogluon) (1.0.4)
Requirement already satisfied: murmurhash&lt;1.1.0,&gt;=0.28.0 in /usr/local/lib/python3.10/dist-packages (from spacy&lt;4-&gt;fastai&lt;2.8,&gt;=2.3.1-&gt;autogluon.tabular[all]==0.7.0-&gt;autogluon) (1.0.9)
Requirement already satisfied: cymem&lt;2.1.0,&gt;=2.0.2 in /usr/local/lib/python3.10/dist-packages (from spacy&lt;4-&gt;fastai&lt;2.8,&gt;=2.3.1-&gt;autogluon.tabular[all]==0.7.0-&gt;autogluon) (2.0.7)
Requirement already satisfied: preshed&lt;3.1.0,&gt;=3.0.2 in /usr/local/lib/python3.10/dist-packages (from spacy&lt;4-&gt;fastai&lt;2.8,&gt;=2.3.1-&gt;autogluon.tabular[all]==0.7.0-&gt;autogluon) (3.0.8)
Requirement already satisfied: thinc&lt;8.2.0,&gt;=8.1.8 in /usr/local/lib/python3.10/dist-packages (from spacy&lt;4-&gt;fastai&lt;2.8,&gt;=2.3.1-&gt;autogluon.tabular[all]==0.7.0-&gt;autogluon) (8.1.9)
Requirement already satisfied: wasabi&lt;1.2.0,&gt;=0.9.1 in /usr/local/lib/python3.10/dist-packages (from spacy&lt;4-&gt;fastai&lt;2.8,&gt;=2.3.1-&gt;autogluon.tabular[all]==0.7.0-&gt;autogluon) (1.1.1)
Requirement already satisfied: srsly&lt;3.0.0,&gt;=2.4.3 in /usr/local/lib/python3.10/dist-packages (from spacy&lt;4-&gt;fastai&lt;2.8,&gt;=2.3.1-&gt;autogluon.tabular[all]==0.7.0-&gt;autogluon) (2.4.6)
Requirement already satisfied: catalogue&lt;2.1.0,&gt;=2.0.6 in /usr/local/lib/python3.10/dist-packages (from spacy&lt;4-&gt;fastai&lt;2.8,&gt;=2.3.1-&gt;autogluon.tabular[all]==0.7.0-&gt;autogluon) (2.0.8)
Requirement already satisfied: typer&lt;0.8.0,&gt;=0.3.0 in /usr/local/lib/python3.10/dist-packages (from spacy&lt;4-&gt;fastai&lt;2.8,&gt;=2.3.1-&gt;autogluon.tabular[all]==0.7.0-&gt;autogluon) (0.7.0)
Requirement already satisfied: pathy&gt;=0.10.0 in /usr/local/lib/python3.10/dist-packages (from spacy&lt;4-&gt;fastai&lt;2.8,&gt;=2.3.1-&gt;autogluon.tabular[all]==0.7.0-&gt;autogluon) (0.10.1)
Requirement already satisfied: smart-open&lt;7.0.0,&gt;=5.2.1 in /usr/local/lib/python3.10/dist-packages (from spacy&lt;4-&gt;fastai&lt;2.8,&gt;=2.3.1-&gt;autogluon.tabular[all]==0.7.0-&gt;autogluon) (6.3.0)
Requirement already satisfied: langcodes&lt;4.0.0,&gt;=3.2.0 in /usr/local/lib/python3.10/dist-packages (from spacy&lt;4-&gt;fastai&lt;2.8,&gt;=2.3.1-&gt;autogluon.tabular[all]==0.7.0-&gt;autogluon) (3.3.0)
Requirement already satisfied: distlib&lt;1,&gt;=0.3.6 in /usr/local/lib/python3.10/dist-packages (from virtualenv&gt;=20.0.24-&gt;ray[tune]&lt;2.3,&gt;=2.2-&gt;autogluon.core[all]==0.7.0-&gt;autogluon) (0.3.6)
Requirement already satisfied: platformdirs&lt;4,&gt;=3.2 in /usr/local/lib/python3.10/dist-packages (from virtualenv&gt;=20.0.24-&gt;ray[tune]&lt;2.3,&gt;=2.2-&gt;autogluon.core[all]==0.7.0-&gt;autogluon) (3.3.0)
Requirement already satisfied: ordered-set in /usr/local/lib/python3.10/dist-packages (from model-index-&gt;openmim&lt;0.4.0,&gt;0.1.5-&gt;autogluon.multimodal==0.7.0-&gt;autogluon) (4.1.0)
Requirement already satisfied: tenacity&gt;=6.2.0 in /usr/local/lib/python3.10/dist-packages (from plotly-&gt;catboost&lt;1.2,&gt;=1.0-&gt;autogluon.tabular[all]==0.7.0-&gt;autogluon) (8.2.2)
Requirement already satisfied: markdown-it-py&lt;3.0.0,&gt;=2.2.0 in /usr/local/lib/python3.10/dist-packages (from rich-&gt;openmim&lt;0.4.0,&gt;0.1.5-&gt;autogluon.multimodal==0.7.0-&gt;autogluon) (2.2.0)
Requirement already satisfied: pygments&lt;3.0.0,&gt;=2.13.0 in /usr/local/lib/python3.10/dist-packages (from rich-&gt;openmim&lt;0.4.0,&gt;0.1.5-&gt;autogluon.multimodal==0.7.0-&gt;autogluon) (2.14.0)
Requirement already satisfied: multidict&lt;7.0,&gt;=4.5 in /usr/local/lib/python3.10/dist-packages (from aiohttp-&gt;datasets&gt;=2.0.0-&gt;evaluate&lt;0.4.0,&gt;=0.2.2-&gt;autogluon.multimodal==0.7.0-&gt;autogluon) (6.0.4)
Requirement already satisfied: async-timeout&lt;5.0,&gt;=4.0.0a3 in /usr/local/lib/python3.10/dist-packages (from aiohttp-&gt;datasets&gt;=2.0.0-&gt;evaluate&lt;0.4.0,&gt;=0.2.2-&gt;autogluon.multimodal==0.7.0-&gt;autogluon) (4.0.2)
Requirement already satisfied: yarl&lt;2.0,&gt;=1.0 in /usr/local/lib/python3.10/dist-packages (from aiohttp-&gt;datasets&gt;=2.0.0-&gt;evaluate&lt;0.4.0,&gt;=0.2.2-&gt;autogluon.multimodal==0.7.0-&gt;autogluon) (1.9.2)
Requirement already satisfied: mdurl~=0.1 in /usr/local/lib/python3.10/dist-packages (from markdown-it-py&lt;3.0.0,&gt;=2.2.0-&gt;rich-&gt;openmim&lt;0.4.0,&gt;0.1.5-&gt;autogluon.multimodal==0.7.0-&gt;autogluon) (0.1.2)
Requirement already satisfied: pyasn1&lt;0.6.0,&gt;=0.4.6 in /usr/local/lib/python3.10/dist-packages (from pyasn1-modules&gt;=0.2.1-&gt;google-auth&lt;3,&gt;=1.6.3-&gt;tensorboard&lt;3,&gt;=2.9-&gt;autogluon.multimodal==0.7.0-&gt;autogluon) (0.5.0)
Requirement already satisfied: oauthlib&gt;=3.0.0 in /usr/local/lib/python3.10/dist-packages (from requests-oauthlib&gt;=0.7.0-&gt;google-auth-oauthlib&lt;1.1,&gt;=0.5-&gt;tensorboard&lt;3,&gt;=2.9-&gt;autogluon.multimodal==0.7.0-&gt;autogluon) (3.2.2)
Requirement already satisfied: blis&lt;0.8.0,&gt;=0.7.8 in /usr/local/lib/python3.10/dist-packages (from thinc&lt;8.2.0,&gt;=8.1.8-&gt;spacy&lt;4-&gt;fastai&lt;2.8,&gt;=2.3.1-&gt;autogluon.tabular[all]==0.7.0-&gt;autogluon) (0.7.9)
Requirement already satisfied: confection&lt;1.0.0,&gt;=0.0.1 in /usr/local/lib/python3.10/dist-packages (from thinc&lt;8.2.0,&gt;=8.1.8-&gt;spacy&lt;4-&gt;fastai&lt;2.8,&gt;=2.3.1-&gt;autogluon.tabular[all]==0.7.0-&gt;autogluon) (0.0.4)
Requirement already satisfied: soupsieve&gt;1.2 in /usr/local/lib/python3.10/dist-packages (from beautifulsoup4-&gt;gdown&gt;=4.0.0-&gt;nlpaug&lt;1.2.0,&gt;=1.1.10-&gt;autogluon.multimodal==0.7.0-&gt;autogluon) (2.4.1)
Requirement already satisfied: PySocks!=1.5.7,&gt;=1.5.6 in /usr/local/lib/python3.10/dist-packages (from requests-&gt;autogluon.core[all]==0.7.0-&gt;autogluon) (1.7.1)
</code></pre>
</div>
</div>
<section id="setup-kaggle-api-key" class="cell markdown"
id="Dzif5bt_E864">
<h3>Setup Kaggle API Key</h3>
</section>
<div class="cell code" data-execution_count="2" id="NpUJWDkvE864">
<div class="sourceCode" id="cb3"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create the .kaggle directory and an empty kaggle.json file</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>mkdir <span class="op">-</span>p <span class="op">/</span>root<span class="op">/</span>.kaggle</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>touch <span class="op">/</span>root<span class="op">/</span>.kaggle<span class="op">/</span>kaggle.json</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>chmod <span class="dv">600</span> <span class="op">/</span>root<span class="op">/</span>.kaggle<span class="op">/</span>kaggle.json</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="3" id="9rF1utumE864">
<div class="sourceCode" id="cb4"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fill in your user name and key from creating the kaggle account and API token file</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>kaggle_username <span class="op">=</span> <span class="st">&quot;mansoorimohdkhalid&quot;</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>kaggle_key <span class="op">=</span> <span class="st">&quot;8fa8f13a4f5d3093876354a891ac7487&quot;</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Save API token the kaggle.json file</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">&quot;/root/.kaggle/kaggle.json&quot;</span>, <span class="st">&quot;w&quot;</span>) <span class="im">as</span> f:</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    f.write(json.dumps({<span class="st">&quot;username&quot;</span>: kaggle_username, <span class="st">&quot;key&quot;</span>: kaggle_key}))</span></code></pre></div>
</div>
<section id="download-and-explore-dataset" class="cell markdown"
id="sHmFILmME865">
<h3>Download and explore dataset</h3>
</section>
<section
id="go-to-the-bike-sharing-demand-competition-and-agree-to-the-terms"
class="cell markdown" id="M9NRgYRkE865">
<h3>Go to the bike sharing demand competition and agree to the
terms</h3>
<p><span class="image placeholder" data-original-image-src="kaggle6.png"
data-original-image-title="">kaggle6.png</span></p>
</section>
<div class="cell code" data-execution_count="4"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="Y4B7pXNwE865" data-outputId="3de521d6-1f13-4662-ff97-7d518baf3e06">
<div class="sourceCode" id="cb5"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Download the dataset, it will be in a .zip file so you&#39;ll need to unzip it as well.</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>kaggle competitions download <span class="op">-</span>c bike<span class="op">-</span>sharing<span class="op">-</span>demand</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># If you already downloaded it you can use the -o command to overwrite the file</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>unzip <span class="op">-</span>o bike<span class="op">-</span>sharing<span class="op">-</span>demand.<span class="bu">zip</span></span></code></pre></div>
<div class="output stream stdout">
<pre><code>bike-sharing-demand.zip: Skipping, found more recently modified local copy (use --force to force download)
Archive:  bike-sharing-demand.zip
  inflating: sampleSubmission.csv    
  inflating: test.csv                
  inflating: train.csv               
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="5" id="1bOj57W2E865">
<div class="sourceCode" id="cb7"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> autogluon.tabular <span class="im">import</span> TabularPredictor</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="6"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:337}"
id="eHT9dFOrE866" data-outputId="5ebf9a35-befc-42c2-9aac-f127b56ae8af">
<div class="sourceCode" id="cb8"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the train dataset in pandas by reading the csv</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the parsing of the datetime column so you can use some of the `dt` features in pandas later</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>train <span class="op">=</span> pd.read_csv(<span class="st">&quot;/content/train.csv&quot;</span>, parse_dates<span class="op">=</span>[<span class="st">&quot;datetime&quot;</span>])</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>train.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="6">

  <div id="df-ba405822-1c9e-45b3-a65f-f9802b32ce09">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>datetime</th>
      <th>season</th>
      <th>holiday</th>
      <th>workingday</th>
      <th>weather</th>
      <th>temp</th>
      <th>atemp</th>
      <th>humidity</th>
      <th>windspeed</th>
      <th>casual</th>
      <th>registered</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2011-01-01 00:00:00</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>9.84</td>
      <td>14.395</td>
      <td>81</td>
      <td>0.0</td>
      <td>3</td>
      <td>13</td>
      <td>16</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2011-01-01 01:00:00</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>9.02</td>
      <td>13.635</td>
      <td>80</td>
      <td>0.0</td>
      <td>8</td>
      <td>32</td>
      <td>40</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2011-01-01 02:00:00</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>9.02</td>
      <td>13.635</td>
      <td>80</td>
      <td>0.0</td>
      <td>5</td>
      <td>27</td>
      <td>32</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2011-01-01 03:00:00</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>9.84</td>
      <td>14.395</td>
      <td>75</td>
      <td>0.0</td>
      <td>3</td>
      <td>10</td>
      <td>13</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2011-01-01 04:00:00</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>9.84</td>
      <td>14.395</td>
      <td>75</td>
      <td>0.0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-ba405822-1c9e-45b3-a65f-f9802b32ce09')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-ba405822-1c9e-45b3-a65f-f9802b32ce09 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-ba405822-1c9e-45b3-a65f-f9802b32ce09');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell code" data-execution_count="7"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:364}"
id="vdPMsCwhE866" data-outputId="cc9dfe01-1cf2-4e28-dd04-af747352f132">
<div class="sourceCode" id="cb9"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Simple output of the train dataset to view some of the min/max/varition of the dataset features.</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>train.describe()</span></code></pre></div>
<div class="output execute_result" data-execution_count="7">

  <div id="df-071b0db3-fc96-4434-96c4-aa19b19a5e2f">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>season</th>
      <th>holiday</th>
      <th>workingday</th>
      <th>weather</th>
      <th>temp</th>
      <th>atemp</th>
      <th>humidity</th>
      <th>windspeed</th>
      <th>casual</th>
      <th>registered</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>10886.000000</td>
      <td>10886.000000</td>
      <td>10886.000000</td>
      <td>10886.000000</td>
      <td>10886.00000</td>
      <td>10886.000000</td>
      <td>10886.000000</td>
      <td>10886.000000</td>
      <td>10886.000000</td>
      <td>10886.000000</td>
      <td>10886.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>2.506614</td>
      <td>0.028569</td>
      <td>0.680875</td>
      <td>1.418427</td>
      <td>20.23086</td>
      <td>23.655084</td>
      <td>61.886460</td>
      <td>12.799395</td>
      <td>36.021955</td>
      <td>155.552177</td>
      <td>191.574132</td>
    </tr>
    <tr>
      <th>std</th>
      <td>1.116174</td>
      <td>0.166599</td>
      <td>0.466159</td>
      <td>0.633839</td>
      <td>7.79159</td>
      <td>8.474601</td>
      <td>19.245033</td>
      <td>8.164537</td>
      <td>49.960477</td>
      <td>151.039033</td>
      <td>181.144454</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>0.82000</td>
      <td>0.760000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>2.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>13.94000</td>
      <td>16.665000</td>
      <td>47.000000</td>
      <td>7.001500</td>
      <td>4.000000</td>
      <td>36.000000</td>
      <td>42.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>3.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>20.50000</td>
      <td>24.240000</td>
      <td>62.000000</td>
      <td>12.998000</td>
      <td>17.000000</td>
      <td>118.000000</td>
      <td>145.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>4.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>2.000000</td>
      <td>26.24000</td>
      <td>31.060000</td>
      <td>77.000000</td>
      <td>16.997900</td>
      <td>49.000000</td>
      <td>222.000000</td>
      <td>284.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>4.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>4.000000</td>
      <td>41.00000</td>
      <td>45.455000</td>
      <td>100.000000</td>
      <td>56.996900</td>
      <td>367.000000</td>
      <td>886.000000</td>
      <td>977.000000</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-071b0db3-fc96-4434-96c4-aa19b19a5e2f')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-071b0db3-fc96-4434-96c4-aa19b19a5e2f button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-071b0db3-fc96-4434-96c4-aa19b19a5e2f');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell code" data-execution_count="8"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:206}"
id="fjRRqI-xE866" data-outputId="27e31995-7a85-45c3-9f6d-758c6baee181">
<div class="sourceCode" id="cb10"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the test pandas dataframe in pandas by reading the csv, remember to parse the datetime!</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>test <span class="op">=</span> pd.read_csv(<span class="st">&quot;/content/test.csv&quot;</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>test.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="8">

  <div id="df-6c82a486-8b9c-4493-9fc5-073f007d2b38">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>datetime</th>
      <th>season</th>
      <th>holiday</th>
      <th>workingday</th>
      <th>weather</th>
      <th>temp</th>
      <th>atemp</th>
      <th>humidity</th>
      <th>windspeed</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2011-01-20 00:00:00</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>10.66</td>
      <td>11.365</td>
      <td>56</td>
      <td>26.0027</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2011-01-20 01:00:00</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>10.66</td>
      <td>13.635</td>
      <td>56</td>
      <td>0.0000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2011-01-20 02:00:00</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>10.66</td>
      <td>13.635</td>
      <td>56</td>
      <td>0.0000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2011-01-20 03:00:00</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>10.66</td>
      <td>12.880</td>
      <td>56</td>
      <td>11.0014</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2011-01-20 04:00:00</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>10.66</td>
      <td>12.880</td>
      <td>56</td>
      <td>11.0014</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-6c82a486-8b9c-4493-9fc5-073f007d2b38')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-6c82a486-8b9c-4493-9fc5-073f007d2b38 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-6c82a486-8b9c-4493-9fc5-073f007d2b38');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell code" data-execution_count="9"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:206}"
id="aK2aNcqtE867" data-outputId="61f747a0-bd3a-4491-8d02-2e742ea9cb0e">
<div class="sourceCode" id="cb11"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Same thing as train and test dataset</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>submission <span class="op">=</span> pd.read_csv(<span class="st">&quot;/content/sampleSubmission.csv&quot;</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>submission.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="9">

  <div id="df-2a396c82-4aef-4333-a037-58ece5e505fe">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>datetime</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2011-01-20 00:00:00</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2011-01-20 01:00:00</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2011-01-20 02:00:00</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2011-01-20 03:00:00</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2011-01-20 04:00:00</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-2a396c82-4aef-4333-a037-58ece5e505fe')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-2a396c82-4aef-4333-a037-58ece5e505fe button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-2a396c82-4aef-4333-a037-58ece5e505fe');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<section id="step-3-train-a-model-using-autogluons-tabular-prediction"
class="cell markdown" id="TIWBTi1RE867">
<h2>Step 3: Train a model using AutoGluon’s Tabular Prediction</h2>
</section>
<div class="cell markdown" id="1joEH6EHE87H">
<p>Requirements:</p>
<ul>
<li>We are prediting <code>count</code>, so it is the label we are
setting.</li>
<li>Ignore <code>casual</code> and <code>registered</code> columns as
they are also not present in the test dataset.</li>
<li>Use the <code>root_mean_squared_error</code> as the metric to use
for evaluation.</li>
<li>Set a time limit of 10 minutes (600 seconds).</li>
<li>Use the preset <code>best_quality</code> to focus on creating the
best model.</li>
</ul>
</div>
<div class="cell code" data-execution_count="10"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="awUHvMsKE87I" data-outputId="b6eaf1bd-7a50-4dc9-9c01-5343e3712034">
<div class="sourceCode" id="cb12"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>predictor <span class="op">=</span> TabularPredictor(label<span class="op">=</span><span class="st">&quot;count&quot;</span>, eval_metric<span class="op">=</span><span class="st">&quot;rmse&quot;</span>).fit(train_data<span class="op">=</span>train.drop([<span class="st">&#39;casual&#39;</span> , <span class="st">&#39;registered&#39;</span>], axis<span class="op">=</span><span class="dv">1</span>), time_limit<span class="op">=</span><span class="dv">600</span>, presets<span class="op">=</span><span class="st">&quot;best_quality&quot;</span>)</span></code></pre></div>
<div class="output stream stderr">
<pre><code>No path specified. Models will be saved in: &quot;AutogluonModels/ag-20230528_092710/&quot;
Presets specified: [&#39;best_quality&#39;]
Stack configuration (auto_stack=True): num_stack_levels=1, num_bag_folds=8, num_bag_sets=20
Beginning AutoGluon training ... Time limit = 600s
AutoGluon will save models to &quot;AutogluonModels/ag-20230528_092710/&quot;
AutoGluon Version:  0.7.0
Python Version:     3.10.11
Operating System:   Linux
Platform Machine:   x86_64
Platform Version:   #1 SMP Sat Apr 29 09:15:28 UTC 2023
Train Data Rows:    10886
Train Data Columns: 9
Label Column: count
Preprocessing data ...
AutoGluon infers your prediction problem is: &#39;regression&#39; (because dtype of label-column == int and many unique label-values observed).
	Label info (max, min, mean, stddev): (977, 1, 191.57413, 181.14445)
	If &#39;regression&#39; is not the correct problem_type, please manually specify the problem_type parameter during predictor init (You may specify problem_type as one of: [&#39;binary&#39;, &#39;multiclass&#39;, &#39;regression&#39;])
Using Feature Generators to preprocess the data ...
Fitting AutoMLPipelineFeatureGenerator...
	Available Memory:                    12555.4 MB
	Train Data (Original)  Memory Usage: 0.78 MB (0.0% of available memory)
	Inferring data type of each feature based on column values. Set feature_metadata_in to manually specify special dtypes of the features.
	Stage 1 Generators:
		Fitting AsTypeFeatureGenerator...
			Note: Converting 2 features to boolean dtype as they only contain 2 unique values.
	Stage 2 Generators:
		Fitting FillNaFeatureGenerator...
	Stage 3 Generators:
		Fitting IdentityFeatureGenerator...
		Fitting DatetimeFeatureGenerator...
	Stage 4 Generators:
		Fitting DropUniqueFeatureGenerator...
	Types of features in original data (raw dtype, special dtypes):
		(&#39;datetime&#39;, []) : 1 | [&#39;datetime&#39;]
		(&#39;float&#39;, [])    : 3 | [&#39;temp&#39;, &#39;atemp&#39;, &#39;windspeed&#39;]
		(&#39;int&#39;, [])      : 5 | [&#39;season&#39;, &#39;holiday&#39;, &#39;workingday&#39;, &#39;weather&#39;, &#39;humidity&#39;]
	Types of features in processed data (raw dtype, special dtypes):
		(&#39;float&#39;, [])                : 3 | [&#39;temp&#39;, &#39;atemp&#39;, &#39;windspeed&#39;]
		(&#39;int&#39;, [])                  : 3 | [&#39;season&#39;, &#39;weather&#39;, &#39;humidity&#39;]
		(&#39;int&#39;, [&#39;bool&#39;])            : 2 | [&#39;holiday&#39;, &#39;workingday&#39;]
		(&#39;int&#39;, [&#39;datetime_as_int&#39;]) : 5 | [&#39;datetime&#39;, &#39;datetime.year&#39;, &#39;datetime.month&#39;, &#39;datetime.day&#39;, &#39;datetime.dayofweek&#39;]
	0.1s = Fit runtime
	9 features in original data used to generate 13 features in processed data.
	Train Data (Processed) Memory Usage: 0.98 MB (0.0% of available memory)
Data preprocessing and feature engineering runtime = 0.18s ...
AutoGluon will gauge predictive performance using evaluation metric: &#39;root_mean_squared_error&#39;
	This metric&#39;s sign has been flipped to adhere to being higher_is_better. The metric score can be multiplied by -1 to get the metric value.
	To change this, specify the eval_metric parameter of Predictor()
AutoGluon will fit 2 stack levels (L1 to L2) ...
Fitting 11 L1 models ...
Fitting model: KNeighborsUnif_BAG_L1 ... Training model for up to 399.78s of the 599.81s of remaining time.
	-101.5462	 = Validation score   (-root_mean_squared_error)
	0.06s	 = Training   runtime
	0.08s	 = Validation runtime
Fitting model: KNeighborsDist_BAG_L1 ... Training model for up to 393.38s of the 593.41s of remaining time.
	-84.1251	 = Validation score   (-root_mean_squared_error)
	0.06s	 = Training   runtime
	0.11s	 = Validation runtime
Fitting model: LightGBMXT_BAG_L1 ... Training model for up to 393.16s of the 593.19s of remaining time.
	Fitting 8 child models (S1F1 - S1F8) | Fitting with ParallelLocalFoldFittingStrategy
	-131.4609	 = Validation score   (-root_mean_squared_error)
	101.87s	 = Training   runtime
	17.1s	 = Validation runtime
Fitting model: LightGBM_BAG_L1 ... Training model for up to 258.38s of the 458.41s of remaining time.
	Fitting 8 child models (S1F1 - S1F8) | Fitting with ParallelLocalFoldFittingStrategy
	-131.0542	 = Validation score   (-root_mean_squared_error)
	44.03s	 = Training   runtime
	3.91s	 = Validation runtime
Fitting model: RandomForestMSE_BAG_L1 ... Training model for up to 209.34s of the 409.37s of remaining time.
	-116.5484	 = Validation score   (-root_mean_squared_error)
	19.55s	 = Training   runtime
	0.58s	 = Validation runtime
Fitting model: CatBoost_BAG_L1 ... Training model for up to 188.02s of the 388.05s of remaining time.
	Fitting 8 child models (S1F1 - S1F8) | Fitting with ParallelLocalFoldFittingStrategy
	-130.7885	 = Validation score   (-root_mean_squared_error)
	168.45s	 = Training   runtime
	0.1s	 = Validation runtime
Fitting model: ExtraTreesMSE_BAG_L1 ... Training model for up to 15.74s of the 215.77s of remaining time.
	-124.6007	 = Validation score   (-root_mean_squared_error)
	8.55s	 = Training   runtime
	0.8s	 = Validation runtime
Fitting model: NeuralNetFastAI_BAG_L1 ... Training model for up to 4.74s of the 204.77s of remaining time.
	Fitting 8 child models (S1F1 - S1F8) | Fitting with ParallelLocalFoldFittingStrategy
	Time limit exceeded... Skipping NeuralNetFastAI_BAG_L1.
Completed 1/20 k-fold bagging repeats ...
Fitting model: WeightedEnsemble_L2 ... Training model for up to 360.0s of the 178.93s of remaining time.
2023-05-28 09:34:12,866	ERROR worker.py:400 -- Unhandled error (suppress with &#39;RAY_IGNORE_UNHANDLED_ERRORS=1&#39;): The worker died unexpectedly while executing this task. Check python-core-worker-*.log files for more information.
	-84.1251	 = Validation score   (-root_mean_squared_error)
	1.33s	 = Training   runtime
	0.0s	 = Validation runtime
Fitting 9 L2 models ...
Fitting model: LightGBMXT_BAG_L2 ... Training model for up to 177.53s of the 177.51s of remaining time.
	Fitting 8 child models (S1F1 - S1F8) | Fitting with ParallelLocalFoldFittingStrategy
	-60.0862	 = Validation score   (-root_mean_squared_error)
	77.25s	 = Training   runtime
	7.27s	 = Validation runtime
Fitting model: LightGBM_BAG_L2 ... Training model for up to 93.28s of the 93.26s of remaining time.
	Fitting 8 child models (S1F1 - S1F8) | Fitting with ParallelLocalFoldFittingStrategy
	-55.114	 = Validation score   (-root_mean_squared_error)
	38.18s	 = Training   runtime
	0.43s	 = Validation runtime
Fitting model: RandomForestMSE_BAG_L2 ... Training model for up to 48.48s of the 48.45s of remaining time.
	-53.3971	 = Validation score   (-root_mean_squared_error)
	47.77s	 = Training   runtime
	0.67s	 = Validation runtime
Completed 1/20 k-fold bagging repeats ...
Fitting model: WeightedEnsemble_L3 ... Training model for up to 360.0s of the -1.61s of remaining time.
	-53.0918	 = Validation score   (-root_mean_squared_error)
	0.22s	 = Training   runtime
	0.0s	 = Validation runtime
AutoGluon training complete, total runtime = 601.86s ... Best model: &quot;WeightedEnsemble_L3&quot;
TabularPredictor saved. To load, use: predictor = TabularPredictor.load(&quot;AutogluonModels/ag-20230528_092710/&quot;)
</code></pre>
</div>
</div>
<section
id="review-autogluons-training-run-with-ranking-of-models-that-did-the-best"
class="cell markdown" id="E48WScz1E87I">
<h3>Review AutoGluon's training run with ranking of models that did the
best.</h3>
</section>
<div class="cell code" data-execution_count="11"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="mQYJeDvzE87I" data-outputId="09e5fccb-5d3a-4373-83cd-8c7da141d87d">
<div class="sourceCode" id="cb14"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>predictor.fit_summary()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>*** Summary of fit() ***
Estimated performance of each model:
                     model   score_val  pred_time_val    fit_time  pred_time_val_marginal  fit_time_marginal  stack_level  can_infer  fit_order
0      WeightedEnsemble_L3  -53.091802      31.059938  505.987334                0.000792           0.216398            3       True         12
1   RandomForestMSE_BAG_L2  -53.397135      23.358051  390.341132                0.674675          47.766219            2       True         11
2          LightGBM_BAG_L2  -55.114028      23.113285  380.751940                0.429909          38.177027            2       True         10
3        LightGBMXT_BAG_L2  -60.086248      29.954563  419.827690                7.271186          77.252777            2       True          9
4    KNeighborsDist_BAG_L1  -84.125061       0.108940    0.062858                0.108940           0.062858            1       True          2
5      WeightedEnsemble_L2  -84.125061       0.111899    1.396866                0.002959           1.334008            2       True          8
6    KNeighborsUnif_BAG_L1 -101.546199       0.082919    0.061265                0.082919           0.061265            1       True          1
7   RandomForestMSE_BAG_L1 -116.548359       0.583441   19.553150                0.583441          19.553150            1       True          5
8     ExtraTreesMSE_BAG_L1 -124.600676       0.798644    8.545218                0.798644           8.545218            1       True          7
9          CatBoost_BAG_L1 -130.788541       0.095567  168.454668                0.095567         168.454668            1       True          6
10         LightGBM_BAG_L1 -131.054162       3.910694   44.026463                3.910694          44.026463            1       True          4
11       LightGBMXT_BAG_L1 -131.460909      17.103172  101.871291               17.103172         101.871291            1       True          3
Number of models trained: 12
Types of models trained:
{&#39;StackerEnsembleModel_XT&#39;, &#39;StackerEnsembleModel_KNN&#39;, &#39;WeightedEnsembleModel&#39;, &#39;StackerEnsembleModel_RF&#39;, &#39;StackerEnsembleModel_CatBoost&#39;, &#39;StackerEnsembleModel_LGB&#39;}
Bagging used: True  (with 8 folds)
Multi-layer stack-ensembling used: True  (with 3 levels)
Feature Metadata (Processed):
(raw dtype, special dtypes):
(&#39;float&#39;, [])                : 3 | [&#39;temp&#39;, &#39;atemp&#39;, &#39;windspeed&#39;]
(&#39;int&#39;, [])                  : 3 | [&#39;season&#39;, &#39;weather&#39;, &#39;humidity&#39;]
(&#39;int&#39;, [&#39;bool&#39;])            : 2 | [&#39;holiday&#39;, &#39;workingday&#39;]
(&#39;int&#39;, [&#39;datetime_as_int&#39;]) : 5 | [&#39;datetime&#39;, &#39;datetime.year&#39;, &#39;datetime.month&#39;, &#39;datetime.day&#39;, &#39;datetime.dayofweek&#39;]
*** End of fit() summary ***
</code></pre>
</div>
<div class="output stream stderr">
<pre><code>/usr/local/lib/python3.10/dist-packages/autogluon/core/utils/plots.py:138: UserWarning: AutoGluon summary plots cannot be created because bokeh is not installed. To see plots, please do: &quot;pip install bokeh==2.0.1&quot;
  warnings.warn(&#39;AutoGluon summary plots cannot be created because bokeh is not installed. To see plots, please do: &quot;pip install bokeh==2.0.1&quot;&#39;)
</code></pre>
</div>
<div class="output execute_result" data-execution_count="11">
<pre><code>{&#39;model_types&#39;: {&#39;KNeighborsUnif_BAG_L1&#39;: &#39;StackerEnsembleModel_KNN&#39;,
  &#39;KNeighborsDist_BAG_L1&#39;: &#39;StackerEnsembleModel_KNN&#39;,
  &#39;LightGBMXT_BAG_L1&#39;: &#39;StackerEnsembleModel_LGB&#39;,
  &#39;LightGBM_BAG_L1&#39;: &#39;StackerEnsembleModel_LGB&#39;,
  &#39;RandomForestMSE_BAG_L1&#39;: &#39;StackerEnsembleModel_RF&#39;,
  &#39;CatBoost_BAG_L1&#39;: &#39;StackerEnsembleModel_CatBoost&#39;,
  &#39;ExtraTreesMSE_BAG_L1&#39;: &#39;StackerEnsembleModel_XT&#39;,
  &#39;WeightedEnsemble_L2&#39;: &#39;WeightedEnsembleModel&#39;,
  &#39;LightGBMXT_BAG_L2&#39;: &#39;StackerEnsembleModel_LGB&#39;,
  &#39;LightGBM_BAG_L2&#39;: &#39;StackerEnsembleModel_LGB&#39;,
  &#39;RandomForestMSE_BAG_L2&#39;: &#39;StackerEnsembleModel_RF&#39;,
  &#39;WeightedEnsemble_L3&#39;: &#39;WeightedEnsembleModel&#39;},
 &#39;model_performance&#39;: {&#39;KNeighborsUnif_BAG_L1&#39;: -101.54619908446061,
  &#39;KNeighborsDist_BAG_L1&#39;: -84.12506123181602,
  &#39;LightGBMXT_BAG_L1&#39;: -131.46090891834504,
  &#39;LightGBM_BAG_L1&#39;: -131.054161598899,
  &#39;RandomForestMSE_BAG_L1&#39;: -116.54835939455667,
  &#39;CatBoost_BAG_L1&#39;: -130.78854073008847,
  &#39;ExtraTreesMSE_BAG_L1&#39;: -124.60067564699747,
  &#39;WeightedEnsemble_L2&#39;: -84.12506123181602,
  &#39;LightGBMXT_BAG_L2&#39;: -60.08624760516539,
  &#39;LightGBM_BAG_L2&#39;: -55.11402828497163,
  &#39;RandomForestMSE_BAG_L2&#39;: -53.397135172342864,
  &#39;WeightedEnsemble_L3&#39;: -53.09180174481977},
 &#39;model_best&#39;: &#39;WeightedEnsemble_L3&#39;,
 &#39;model_paths&#39;: {&#39;KNeighborsUnif_BAG_L1&#39;: &#39;AutogluonModels/ag-20230528_092710/models/KNeighborsUnif_BAG_L1/&#39;,
  &#39;KNeighborsDist_BAG_L1&#39;: &#39;AutogluonModels/ag-20230528_092710/models/KNeighborsDist_BAG_L1/&#39;,
  &#39;LightGBMXT_BAG_L1&#39;: &#39;AutogluonModels/ag-20230528_092710/models/LightGBMXT_BAG_L1/&#39;,
  &#39;LightGBM_BAG_L1&#39;: &#39;AutogluonModels/ag-20230528_092710/models/LightGBM_BAG_L1/&#39;,
  &#39;RandomForestMSE_BAG_L1&#39;: &#39;AutogluonModels/ag-20230528_092710/models/RandomForestMSE_BAG_L1/&#39;,
  &#39;CatBoost_BAG_L1&#39;: &#39;AutogluonModels/ag-20230528_092710/models/CatBoost_BAG_L1/&#39;,
  &#39;ExtraTreesMSE_BAG_L1&#39;: &#39;AutogluonModels/ag-20230528_092710/models/ExtraTreesMSE_BAG_L1/&#39;,
  &#39;WeightedEnsemble_L2&#39;: &#39;AutogluonModels/ag-20230528_092710/models/WeightedEnsemble_L2/&#39;,
  &#39;LightGBMXT_BAG_L2&#39;: &#39;AutogluonModels/ag-20230528_092710/models/LightGBMXT_BAG_L2/&#39;,
  &#39;LightGBM_BAG_L2&#39;: &#39;AutogluonModels/ag-20230528_092710/models/LightGBM_BAG_L2/&#39;,
  &#39;RandomForestMSE_BAG_L2&#39;: &#39;AutogluonModels/ag-20230528_092710/models/RandomForestMSE_BAG_L2/&#39;,
  &#39;WeightedEnsemble_L3&#39;: &#39;AutogluonModels/ag-20230528_092710/models/WeightedEnsemble_L3/&#39;},
 &#39;model_fit_times&#39;: {&#39;KNeighborsUnif_BAG_L1&#39;: 0.06126523017883301,
  &#39;KNeighborsDist_BAG_L1&#39;: 0.06285786628723145,
  &#39;LightGBMXT_BAG_L1&#39;: 101.87129139900208,
  &#39;LightGBM_BAG_L1&#39;: 44.02646279335022,
  &#39;RandomForestMSE_BAG_L1&#39;: 19.553150177001953,
  &#39;CatBoost_BAG_L1&#39;: 168.45466804504395,
  &#39;ExtraTreesMSE_BAG_L1&#39;: 8.545217752456665,
  &#39;WeightedEnsemble_L2&#39;: 1.334007740020752,
  &#39;LightGBMXT_BAG_L2&#39;: 77.2527768611908,
  &#39;LightGBM_BAG_L2&#39;: 38.17702674865723,
  &#39;RandomForestMSE_BAG_L2&#39;: 47.76621866226196,
  &#39;WeightedEnsemble_L3&#39;: 0.2163984775543213},
 &#39;model_pred_times&#39;: {&#39;KNeighborsUnif_BAG_L1&#39;: 0.08291935920715332,
  &#39;KNeighborsDist_BAG_L1&#39;: 0.10893964767456055,
  &#39;LightGBMXT_BAG_L1&#39;: 17.103171586990356,
  &#39;LightGBM_BAG_L1&#39;: 3.910694122314453,
  &#39;RandomForestMSE_BAG_L1&#39;: 0.5834407806396484,
  &#39;CatBoost_BAG_L1&#39;: 0.09556698799133301,
  &#39;ExtraTreesMSE_BAG_L1&#39;: 0.7986438274383545,
  &#39;WeightedEnsemble_L2&#39;: 0.0029592514038085938,
  &#39;LightGBMXT_BAG_L2&#39;: 7.271186351776123,
  &#39;LightGBM_BAG_L2&#39;: 0.42990899085998535,
  &#39;RandomForestMSE_BAG_L2&#39;: 0.6746747493743896,
  &#39;WeightedEnsemble_L3&#39;: 0.0007915496826171875},
 &#39;num_bag_folds&#39;: 8,
 &#39;max_stack_level&#39;: 3,
 &#39;model_hyperparams&#39;: {&#39;KNeighborsUnif_BAG_L1&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True,
   &#39;use_child_oof&#39;: True},
  &#39;KNeighborsDist_BAG_L1&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True,
   &#39;use_child_oof&#39;: True},
  &#39;LightGBMXT_BAG_L1&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True},
  &#39;LightGBM_BAG_L1&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True},
  &#39;RandomForestMSE_BAG_L1&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True,
   &#39;use_child_oof&#39;: True},
  &#39;CatBoost_BAG_L1&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True},
  &#39;ExtraTreesMSE_BAG_L1&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True,
   &#39;use_child_oof&#39;: True},
  &#39;WeightedEnsemble_L2&#39;: {&#39;use_orig_features&#39;: False,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True},
  &#39;LightGBMXT_BAG_L2&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True},
  &#39;LightGBM_BAG_L2&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True},
  &#39;RandomForestMSE_BAG_L2&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True,
   &#39;use_child_oof&#39;: True},
  &#39;WeightedEnsemble_L3&#39;: {&#39;use_orig_features&#39;: False,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True}},
 &#39;leaderboard&#39;:                      model   score_val  pred_time_val    fit_time  \
 0      WeightedEnsemble_L3  -53.091802      31.059938  505.987334   
 1   RandomForestMSE_BAG_L2  -53.397135      23.358051  390.341132   
 2          LightGBM_BAG_L2  -55.114028      23.113285  380.751940   
 3        LightGBMXT_BAG_L2  -60.086248      29.954563  419.827690   
 4    KNeighborsDist_BAG_L1  -84.125061       0.108940    0.062858   
 5      WeightedEnsemble_L2  -84.125061       0.111899    1.396866   
 6    KNeighborsUnif_BAG_L1 -101.546199       0.082919    0.061265   
 7   RandomForestMSE_BAG_L1 -116.548359       0.583441   19.553150   
 8     ExtraTreesMSE_BAG_L1 -124.600676       0.798644    8.545218   
 9          CatBoost_BAG_L1 -130.788541       0.095567  168.454668   
 10         LightGBM_BAG_L1 -131.054162       3.910694   44.026463   
 11       LightGBMXT_BAG_L1 -131.460909      17.103172  101.871291   
 
     pred_time_val_marginal  fit_time_marginal  stack_level  can_infer  \
 0                 0.000792           0.216398            3       True   
 1                 0.674675          47.766219            2       True   
 2                 0.429909          38.177027            2       True   
 3                 7.271186          77.252777            2       True   
 4                 0.108940           0.062858            1       True   
 5                 0.002959           1.334008            2       True   
 6                 0.082919           0.061265            1       True   
 7                 0.583441          19.553150            1       True   
 8                 0.798644           8.545218            1       True   
 9                 0.095567         168.454668            1       True   
 10                3.910694          44.026463            1       True   
 11               17.103172         101.871291            1       True   
 
     fit_order  
 0          12  
 1          11  
 2          10  
 3           9  
 4           2  
 5           8  
 6           1  
 7           5  
 8           7  
 9           6  
 10          4  
 11          3  }</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="12"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:715}"
id="6MdQqMoUNM2n" data-outputId="4e800e31-de50-4a30-abf2-220d2c064315">
<div class="sourceCode" id="cb18"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>predictor.leaderboard()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>                     model   score_val  pred_time_val    fit_time  pred_time_val_marginal  fit_time_marginal  stack_level  can_infer  fit_order
0      WeightedEnsemble_L3  -53.091802      31.059938  505.987334                0.000792           0.216398            3       True         12
1   RandomForestMSE_BAG_L2  -53.397135      23.358051  390.341132                0.674675          47.766219            2       True         11
2          LightGBM_BAG_L2  -55.114028      23.113285  380.751940                0.429909          38.177027            2       True         10
3        LightGBMXT_BAG_L2  -60.086248      29.954563  419.827690                7.271186          77.252777            2       True          9
4    KNeighborsDist_BAG_L1  -84.125061       0.108940    0.062858                0.108940           0.062858            1       True          2
5      WeightedEnsemble_L2  -84.125061       0.111899    1.396866                0.002959           1.334008            2       True          8
6    KNeighborsUnif_BAG_L1 -101.546199       0.082919    0.061265                0.082919           0.061265            1       True          1
7   RandomForestMSE_BAG_L1 -116.548359       0.583441   19.553150                0.583441          19.553150            1       True          5
8     ExtraTreesMSE_BAG_L1 -124.600676       0.798644    8.545218                0.798644           8.545218            1       True          7
9          CatBoost_BAG_L1 -130.788541       0.095567  168.454668                0.095567         168.454668            1       True          6
10         LightGBM_BAG_L1 -131.054162       3.910694   44.026463                3.910694          44.026463            1       True          4
11       LightGBMXT_BAG_L1 -131.460909      17.103172  101.871291               17.103172         101.871291            1       True          3
</code></pre>
</div>
<div class="output execute_result" data-execution_count="12">

  <div id="df-520111ee-7f31-4736-996f-665c7b3bf80a">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>model</th>
      <th>score_val</th>
      <th>pred_time_val</th>
      <th>fit_time</th>
      <th>pred_time_val_marginal</th>
      <th>fit_time_marginal</th>
      <th>stack_level</th>
      <th>can_infer</th>
      <th>fit_order</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>WeightedEnsemble_L3</td>
      <td>-53.091802</td>
      <td>31.059938</td>
      <td>505.987334</td>
      <td>0.000792</td>
      <td>0.216398</td>
      <td>3</td>
      <td>True</td>
      <td>12</td>
    </tr>
    <tr>
      <th>1</th>
      <td>RandomForestMSE_BAG_L2</td>
      <td>-53.397135</td>
      <td>23.358051</td>
      <td>390.341132</td>
      <td>0.674675</td>
      <td>47.766219</td>
      <td>2</td>
      <td>True</td>
      <td>11</td>
    </tr>
    <tr>
      <th>2</th>
      <td>LightGBM_BAG_L2</td>
      <td>-55.114028</td>
      <td>23.113285</td>
      <td>380.751940</td>
      <td>0.429909</td>
      <td>38.177027</td>
      <td>2</td>
      <td>True</td>
      <td>10</td>
    </tr>
    <tr>
      <th>3</th>
      <td>LightGBMXT_BAG_L2</td>
      <td>-60.086248</td>
      <td>29.954563</td>
      <td>419.827690</td>
      <td>7.271186</td>
      <td>77.252777</td>
      <td>2</td>
      <td>True</td>
      <td>9</td>
    </tr>
    <tr>
      <th>4</th>
      <td>KNeighborsDist_BAG_L1</td>
      <td>-84.125061</td>
      <td>0.108940</td>
      <td>0.062858</td>
      <td>0.108940</td>
      <td>0.062858</td>
      <td>1</td>
      <td>True</td>
      <td>2</td>
    </tr>
    <tr>
      <th>5</th>
      <td>WeightedEnsemble_L2</td>
      <td>-84.125061</td>
      <td>0.111899</td>
      <td>1.396866</td>
      <td>0.002959</td>
      <td>1.334008</td>
      <td>2</td>
      <td>True</td>
      <td>8</td>
    </tr>
    <tr>
      <th>6</th>
      <td>KNeighborsUnif_BAG_L1</td>
      <td>-101.546199</td>
      <td>0.082919</td>
      <td>0.061265</td>
      <td>0.082919</td>
      <td>0.061265</td>
      <td>1</td>
      <td>True</td>
      <td>1</td>
    </tr>
    <tr>
      <th>7</th>
      <td>RandomForestMSE_BAG_L1</td>
      <td>-116.548359</td>
      <td>0.583441</td>
      <td>19.553150</td>
      <td>0.583441</td>
      <td>19.553150</td>
      <td>1</td>
      <td>True</td>
      <td>5</td>
    </tr>
    <tr>
      <th>8</th>
      <td>ExtraTreesMSE_BAG_L1</td>
      <td>-124.600676</td>
      <td>0.798644</td>
      <td>8.545218</td>
      <td>0.798644</td>
      <td>8.545218</td>
      <td>1</td>
      <td>True</td>
      <td>7</td>
    </tr>
    <tr>
      <th>9</th>
      <td>CatBoost_BAG_L1</td>
      <td>-130.788541</td>
      <td>0.095567</td>
      <td>168.454668</td>
      <td>0.095567</td>
      <td>168.454668</td>
      <td>1</td>
      <td>True</td>
      <td>6</td>
    </tr>
    <tr>
      <th>10</th>
      <td>LightGBM_BAG_L1</td>
      <td>-131.054162</td>
      <td>3.910694</td>
      <td>44.026463</td>
      <td>3.910694</td>
      <td>44.026463</td>
      <td>1</td>
      <td>True</td>
      <td>4</td>
    </tr>
    <tr>
      <th>11</th>
      <td>LightGBMXT_BAG_L1</td>
      <td>-131.460909</td>
      <td>17.103172</td>
      <td>101.871291</td>
      <td>17.103172</td>
      <td>101.871291</td>
      <td>1</td>
      <td>True</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-520111ee-7f31-4736-996f-665c7b3bf80a')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-520111ee-7f31-4736-996f-665c7b3bf80a button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-520111ee-7f31-4736-996f-665c7b3bf80a');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell code" data-execution_count="13"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:856}"
id="HOgNSI3UhDFH" data-outputId="a86427a1-56ad-49a0-973a-c2a1b29b626b">
<div class="sourceCode" id="cb20"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Output the model&#39;s `score_val` in a bar chart to compare performance</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>predictor.leaderboard().plot(kind<span class="op">=</span><span class="st">&quot;bar&quot;</span>, x<span class="op">=</span><span class="st">&quot;model&quot;</span>, y<span class="op">=</span><span class="st">&quot;score_val&quot;</span>, figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">7</span>))</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&quot;RMSE Scores&quot;</span>)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>                     model   score_val  pred_time_val    fit_time  pred_time_val_marginal  fit_time_marginal  stack_level  can_infer  fit_order
0      WeightedEnsemble_L3  -53.091802      31.059938  505.987334                0.000792           0.216398            3       True         12
1   RandomForestMSE_BAG_L2  -53.397135      23.358051  390.341132                0.674675          47.766219            2       True         11
2          LightGBM_BAG_L2  -55.114028      23.113285  380.751940                0.429909          38.177027            2       True         10
3        LightGBMXT_BAG_L2  -60.086248      29.954563  419.827690                7.271186          77.252777            2       True          9
4    KNeighborsDist_BAG_L1  -84.125061       0.108940    0.062858                0.108940           0.062858            1       True          2
5      WeightedEnsemble_L2  -84.125061       0.111899    1.396866                0.002959           1.334008            2       True          8
6    KNeighborsUnif_BAG_L1 -101.546199       0.082919    0.061265                0.082919           0.061265            1       True          1
7   RandomForestMSE_BAG_L1 -116.548359       0.583441   19.553150                0.583441          19.553150            1       True          5
8     ExtraTreesMSE_BAG_L1 -124.600676       0.798644    8.545218                0.798644           8.545218            1       True          7
9          CatBoost_BAG_L1 -130.788541       0.095567  168.454668                0.095567         168.454668            1       True          6
10         LightGBM_BAG_L1 -131.054162       3.910694   44.026463                3.910694          44.026463            1       True          4
11       LightGBMXT_BAG_L1 -131.460909      17.103172  101.871291               17.103172         101.871291            1       True          3
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_37271c91d75944799fe9745642b73185/74d5384fd1f2a2c7363f1d9634f6cc0aecc1f089.png" /></p>
</div>
</div>
<section id="create-predictions-from-test-dataset" class="cell markdown"
id="QUhqUFGmE87J">
<h3>Create predictions from test dataset</h3>
</section>
<div class="cell code" data-execution_count="14"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="cPVK59nJE87J" data-outputId="db135eae-78e1-4390-e4dc-2d7353fbbdd8">
<div class="sourceCode" id="cb22"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>predictions1 <span class="op">=</span> predictor.predict(test)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>predictions1</span></code></pre></div>
<div class="output execute_result" data-execution_count="14">
<pre><code>0        23.278118
1        41.788616
2        45.570278
3        48.738007
4        51.619278
           ...    
6488    161.675034
6489    161.727951
6490    155.707520
6491    150.931625
6492    148.845459
Name: count, Length: 6493, dtype: float32</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="15"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:206}"
id="s9tg4V6gc4oY" data-outputId="d93c69cc-1adf-4aa9-be85-7533d6e53e50">
<div class="sourceCode" id="cb24"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>predictions <span class="op">=</span> {<span class="st">&#39;datetime&#39;</span>: test[<span class="st">&#39;datetime&#39;</span>], <span class="st">&#39;Pred_count&#39;</span>: predictions1}</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>predictions <span class="op">=</span> pd.DataFrame(data<span class="op">=</span>predictions)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>predictions.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="15">

  <div id="df-8eb951df-64cc-481b-a307-2ed6f10359a4">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>datetime</th>
      <th>Pred_count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2011-01-20 00:00:00</td>
      <td>23.278118</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2011-01-20 01:00:00</td>
      <td>41.788616</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2011-01-20 02:00:00</td>
      <td>45.570278</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2011-01-20 03:00:00</td>
      <td>48.738007</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2011-01-20 04:00:00</td>
      <td>51.619278</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-8eb951df-64cc-481b-a307-2ed6f10359a4')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-8eb951df-64cc-481b-a307-2ed6f10359a4 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-8eb951df-64cc-481b-a307-2ed6f10359a4');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<section
id="note-kaggle-will-reject-the-submission-if-we-dont-set-everything-to-be--0"
class="cell markdown" id="T-b-SkKME87J">
<h4>NOTE: Kaggle will reject the submission if we don't set everything
to be &gt; 0.</h4>
</section>
<div class="cell code" data-execution_count="16"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:300}"
id="Xr_sa2BsE87J" data-outputId="aa2758ae-f71c-4058-eb18-3f990871b656">
<div class="sourceCode" id="cb25"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Describe the `predictions` series to see if there are any negative values</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>predictions.describe()</span></code></pre></div>
<div class="output execute_result" data-execution_count="16">

  <div id="df-5cb8f0a3-1fec-45e4-9d2b-293efaeb2c3a">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Pred_count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>6493.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>100.679924</td>
    </tr>
    <tr>
      <th>std</th>
      <td>90.183510</td>
    </tr>
    <tr>
      <th>min</th>
      <td>2.868417</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>19.941090</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>64.186752</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>167.916656</td>
    </tr>
    <tr>
      <th>max</th>
      <td>368.843262</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-5cb8f0a3-1fec-45e4-9d2b-293efaeb2c3a')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-5cb8f0a3-1fec-45e4-9d2b-293efaeb2c3a button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-5cb8f0a3-1fec-45e4-9d2b-293efaeb2c3a');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell code" data-execution_count="17"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="-yeO6Uj1E87K" data-outputId="9aa712a9-0f3c-4614-9bd6-ac3c2f29f0dd">
<div class="sourceCode" id="cb26"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># How many negative values do we have?</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Rechecking the predictions</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>negative_pred_count <span class="op">=</span> predictions1.<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="dv">1</span> <span class="cf">if</span> x<span class="op">&lt;</span><span class="dv">0</span> <span class="cf">else</span> <span class="dv">0</span>)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>pred_pos_count <span class="op">=</span> (negative_pred_count<span class="op">==</span><span class="dv">0</span>).<span class="bu">sum</span>()</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>pred_neg_count <span class="op">=</span> (negative_pred_count<span class="op">==</span><span class="dv">1</span>).<span class="bu">sum</span>()</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Total predictions                :&quot;</span>, <span class="bu">len</span>(predictions.index))</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Total positive prediction  :&quot;</span>, pred_pos_count)</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Total negative prediction  :&quot;</span>, pred_neg_count)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Total predictions                : 6493
Total positive prediction  : 6493
Total negative prediction  : 0
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="18"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="AHmGQGs6E87K" data-outputId="07cbd819-7f0f-4c8f-985d-0ec2c03ad404">
<div class="sourceCode" id="cb28"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set them to zero</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>predictions1[predictions1<span class="op">&lt;</span><span class="dv">0</span>]<span class="op">=</span><span class="dv">0</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Rechecking, if any predictions are less than 0</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>negative_pred_count <span class="op">=</span> predictions1.<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="dv">1</span> <span class="cf">if</span> x<span class="op">&lt;</span><span class="dv">0</span> <span class="cf">else</span> <span class="dv">0</span>)</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>pred_neg_count <span class="op">=</span> (negative_pred_count<span class="op">==</span><span class="dv">1</span>).<span class="bu">sum</span>()</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;No. of negative predictions: </span><span class="sc">{</span>pred_neg_count<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;All negative values in the predictions (if any) are set to zero successfully.&quot;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>No. of negative predictions: 0
All negative values in the predictions (if any) are set to zero successfully.
</code></pre>
</div>
</div>
<section id="set-predictions-to-submission-dataframe-save-and-submit"
class="cell markdown" id="II_IZJumE87K">
<h3>Set predictions to submission dataframe, save, and submit</h3>
</section>
<div class="cell code" data-execution_count="19" id="uWFjLs4sE87K">
<div class="sourceCode" id="cb30"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>submission[<span class="st">&quot;count&quot;</span>] <span class="op">=</span> predictions1</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>submission.to_csv(<span class="st">&quot;submission.csv&quot;</span>, index<span class="op">=</span><span class="va">False</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="20"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="cFlT99mLE87L" data-outputId="c72192f5-2600-4d15-dafc-7e0425ba6553">
<div class="sourceCode" id="cb31"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>kaggle competitions submit <span class="op">-</span>c bike<span class="op">-</span>sharing<span class="op">-</span>demand <span class="op">-</span>f submission.csv <span class="op">-</span>m <span class="st">&quot;first raw submission&quot;</span></span></code></pre></div>
<div class="output stream stdout">
<pre><code>100% 188k/188k [00:00&lt;00:00, 898kB/s]
Successfully submitted to Bike Sharing Demand</code></pre>
</div>
</div>
<section
id="view-submission-via-the-command-line-or-in-the-web-browser-under-the-competitions-page---my-submissions"
class="cell markdown" id="jVTULcsuE87L">
<h4>View submission via the command line or in the web browser under the
competition's page - <code>My Submissions</code></h4>
</section>
<div class="cell code" data-execution_count="21"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="F7up4MOIE87L" data-outputId="a341b7f0-6078-4332-85f9-f34371095fc4">
<div class="sourceCode" id="cb33"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>kaggle competitions submissions <span class="op">-</span>c bike<span class="op">-</span>sharing<span class="op">-</span>demand <span class="op">|</span> tail <span class="op">-</span>n <span class="op">+</span><span class="dv">1</span> <span class="op">|</span> head <span class="op">-</span>n <span class="dv">6</span></span></code></pre></div>
<div class="output stream stdout">
<pre><code>fileName        date                 description           status    publicScore  privateScore  
--------------  -------------------  --------------------  --------  -----------  ------------  
submission.csv  2023-05-28 09:38:25  first raw submission  pending                              
submission.csv  2023-05-28 08:50:43  first raw submission  complete  1.80552      1.80552       
</code></pre>
</div>
</div>
<section id="initial-score-of-180552" class="cell markdown"
id="rjvZUAODE87L">
<h4>Initial score of <code>1.80552</code></h4>
</section>
<section
id="step-4-exploratory-data-analysis-and-creating-an-additional-feature"
class="cell markdown" id="9MG3mjSdE87L">
<h2>Step 4: Exploratory Data Analysis and Creating an additional
feature</h2>
<ul>
<li>Any additional feature will do, but a great suggestion would be to
separate out the datetime into hour, day, or month parts.</li>
</ul>
</section>
<div class="cell code" data-execution_count="22"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:1000}"
id="5Ylp7OhjE87l" data-outputId="5dff9ad1-eb5b-4229-e8d5-9eaa0ffc34b6">
<div class="sourceCode" id="cb35"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a histogram of all features to show the distribution of each one relative to the data. This is part of the exploritory data analysis</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>train.hist(figsize<span class="op">=</span>(<span class="dv">15</span>,<span class="dv">22</span>))</span></code></pre></div>
<div class="output execute_result" data-execution_count="22">
<pre><code>array([[&lt;Axes: title={&#39;center&#39;: &#39;datetime&#39;}&gt;,
        &lt;Axes: title={&#39;center&#39;: &#39;season&#39;}&gt;,
        &lt;Axes: title={&#39;center&#39;: &#39;holiday&#39;}&gt;],
       [&lt;Axes: title={&#39;center&#39;: &#39;workingday&#39;}&gt;,
        &lt;Axes: title={&#39;center&#39;: &#39;weather&#39;}&gt;,
        &lt;Axes: title={&#39;center&#39;: &#39;temp&#39;}&gt;],
       [&lt;Axes: title={&#39;center&#39;: &#39;atemp&#39;}&gt;,
        &lt;Axes: title={&#39;center&#39;: &#39;humidity&#39;}&gt;,
        &lt;Axes: title={&#39;center&#39;: &#39;windspeed&#39;}&gt;],
       [&lt;Axes: title={&#39;center&#39;: &#39;casual&#39;}&gt;,
        &lt;Axes: title={&#39;center&#39;: &#39;registered&#39;}&gt;,
        &lt;Axes: title={&#39;center&#39;: &#39;count&#39;}&gt;]], dtype=object)</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_37271c91d75944799fe9745642b73185/243f33b3e9b3f3e46136ea02588f1f9f65f974d8.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="23"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:493}"
id="W4q49j0om77I" data-outputId="c50d1239-fa7e-459b-ee35-2ba8bc225546">
<div class="sourceCode" id="cb37"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>corr_matrix <span class="op">=</span> train.corr()</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>corr_matrix</span></code></pre></div>
<div class="output stream stderr">
<pre><code>&lt;ipython-input-23-310b2495afb6&gt;:1: FutureWarning: The default value of numeric_only in DataFrame.corr is deprecated. In a future version, it will default to False. Select only valid columns or specify the value of numeric_only to silence this warning.
  corr_matrix = train.corr()
</code></pre>
</div>
<div class="output execute_result" data-execution_count="23">

  <div id="df-8b099d58-d6aa-4af4-b066-fd613cf87064">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>season</th>
      <th>holiday</th>
      <th>workingday</th>
      <th>weather</th>
      <th>temp</th>
      <th>atemp</th>
      <th>humidity</th>
      <th>windspeed</th>
      <th>casual</th>
      <th>registered</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>season</th>
      <td>1.000000</td>
      <td>0.029368</td>
      <td>-0.008126</td>
      <td>0.008879</td>
      <td>0.258689</td>
      <td>0.264744</td>
      <td>0.190610</td>
      <td>-0.147121</td>
      <td>0.096758</td>
      <td>0.164011</td>
      <td>0.163439</td>
    </tr>
    <tr>
      <th>holiday</th>
      <td>0.029368</td>
      <td>1.000000</td>
      <td>-0.250491</td>
      <td>-0.007074</td>
      <td>0.000295</td>
      <td>-0.005215</td>
      <td>0.001929</td>
      <td>0.008409</td>
      <td>0.043799</td>
      <td>-0.020956</td>
      <td>-0.005393</td>
    </tr>
    <tr>
      <th>workingday</th>
      <td>-0.008126</td>
      <td>-0.250491</td>
      <td>1.000000</td>
      <td>0.033772</td>
      <td>0.029966</td>
      <td>0.024660</td>
      <td>-0.010880</td>
      <td>0.013373</td>
      <td>-0.319111</td>
      <td>0.119460</td>
      <td>0.011594</td>
    </tr>
    <tr>
      <th>weather</th>
      <td>0.008879</td>
      <td>-0.007074</td>
      <td>0.033772</td>
      <td>1.000000</td>
      <td>-0.055035</td>
      <td>-0.055376</td>
      <td>0.406244</td>
      <td>0.007261</td>
      <td>-0.135918</td>
      <td>-0.109340</td>
      <td>-0.128655</td>
    </tr>
    <tr>
      <th>temp</th>
      <td>0.258689</td>
      <td>0.000295</td>
      <td>0.029966</td>
      <td>-0.055035</td>
      <td>1.000000</td>
      <td>0.984948</td>
      <td>-0.064949</td>
      <td>-0.017852</td>
      <td>0.467097</td>
      <td>0.318571</td>
      <td>0.394454</td>
    </tr>
    <tr>
      <th>atemp</th>
      <td>0.264744</td>
      <td>-0.005215</td>
      <td>0.024660</td>
      <td>-0.055376</td>
      <td>0.984948</td>
      <td>1.000000</td>
      <td>-0.043536</td>
      <td>-0.057473</td>
      <td>0.462067</td>
      <td>0.314635</td>
      <td>0.389784</td>
    </tr>
    <tr>
      <th>humidity</th>
      <td>0.190610</td>
      <td>0.001929</td>
      <td>-0.010880</td>
      <td>0.406244</td>
      <td>-0.064949</td>
      <td>-0.043536</td>
      <td>1.000000</td>
      <td>-0.318607</td>
      <td>-0.348187</td>
      <td>-0.265458</td>
      <td>-0.317371</td>
    </tr>
    <tr>
      <th>windspeed</th>
      <td>-0.147121</td>
      <td>0.008409</td>
      <td>0.013373</td>
      <td>0.007261</td>
      <td>-0.017852</td>
      <td>-0.057473</td>
      <td>-0.318607</td>
      <td>1.000000</td>
      <td>0.092276</td>
      <td>0.091052</td>
      <td>0.101369</td>
    </tr>
    <tr>
      <th>casual</th>
      <td>0.096758</td>
      <td>0.043799</td>
      <td>-0.319111</td>
      <td>-0.135918</td>
      <td>0.467097</td>
      <td>0.462067</td>
      <td>-0.348187</td>
      <td>0.092276</td>
      <td>1.000000</td>
      <td>0.497250</td>
      <td>0.690414</td>
    </tr>
    <tr>
      <th>registered</th>
      <td>0.164011</td>
      <td>-0.020956</td>
      <td>0.119460</td>
      <td>-0.109340</td>
      <td>0.318571</td>
      <td>0.314635</td>
      <td>-0.265458</td>
      <td>0.091052</td>
      <td>0.497250</td>
      <td>1.000000</td>
      <td>0.970948</td>
    </tr>
    <tr>
      <th>count</th>
      <td>0.163439</td>
      <td>-0.005393</td>
      <td>0.011594</td>
      <td>-0.128655</td>
      <td>0.394454</td>
      <td>0.389784</td>
      <td>-0.317371</td>
      <td>0.101369</td>
      <td>0.690414</td>
      <td>0.970948</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-8b099d58-d6aa-4af4-b066-fd613cf87064')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-8b099d58-d6aa-4af4-b066-fd613cf87064 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-8b099d58-d6aa-4af4-b066-fd613cf87064');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell code" data-execution_count="24"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:835}"
id="kG8U45jxnehn" data-outputId="e28f8c5f-5f5f-48b6-b536-530020f73769">
<div class="sourceCode" id="cb39"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt </span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np </span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sb</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize <span class="op">=</span> (<span class="dv">15</span>,<span class="dv">15</span>), dpi<span class="op">=</span><span class="dv">120</span>)</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a mask to eliminate redundant repetitive correlations</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>corr_mask <span class="op">=</span> np.array(corr_matrix)</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>corr_mask[np.tril_indices_from(corr_mask)] <span class="op">=</span> <span class="va">False</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>sb.heatmap(corr_matrix, cmap<span class="op">=</span> <span class="st">&#39;RdPu&#39;</span>, cbar_kws<span class="op">=</span>{<span class="st">&quot;shrink&quot;</span>: <span class="fl">.5</span>}, vmin<span class="op">=</span> <span class="op">-</span><span class="dv">1</span>, vmax<span class="op">=</span><span class="dv">1</span>, center<span class="op">=</span><span class="dv">0</span>,</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>            square<span class="op">=</span><span class="va">True</span>, mask<span class="op">=</span>corr_mask, annot<span class="op">=</span><span class="va">True</span>, linewidths<span class="op">=</span><span class="fl">0.01</span>, annot_kws<span class="op">=</span>{<span class="st">&quot;size&quot;</span>:<span class="dv">13</span>})</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&quot;HeatMap: Correlation Matrix&quot;</span>, fontsize<span class="op">=</span><span class="dv">20</span>, fontweight<span class="op">=</span><span class="st">&#39;bold&#39;</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="24">
<pre><code>Text(0.5, 1.0, &#39;HeatMap: Correlation Matrix&#39;)</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_37271c91d75944799fe9745642b73185/6105c2dfd9011ab975d2605317ac66390b6a5c41.png" /></p>
</div>
</div>
<div class="cell markdown" id="y8afeZ-2o1zX">
<p><strong>CREATING NEW FEATURES</strong></p>
</div>
<div class="cell code" data-execution_count="25"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="735AtiN7pFoL" data-outputId="d826eed4-cce8-437f-9096-0fcea11b702f">
<div class="sourceCode" id="cb41"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>train[<span class="st">&#39;datetime&#39;</span>].head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="25">
<pre><code>0   2011-01-01 00:00:00
1   2011-01-01 01:00:00
2   2011-01-01 02:00:00
3   2011-01-01 03:00:00
4   2011-01-01 04:00:00
Name: datetime, dtype: datetime64[ns]</code></pre>
</div>
</div>
<div class="cell markdown" id="vA2CwImNpL0O">
<p>Observation:</p>
<p>Variation is seen on hourly basis. So splitting the 'datetime'
feature into year, month, day (dayofweek) and hour respectively.</p>
</div>
<div class="cell code" data-execution_count="26"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:270}"
id="fmhTmodYE87l" data-outputId="863d3bf8-48c6-4fd6-a22f-861774cdd736">
<div class="sourceCode" id="cb43"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Splitting the &#39;datetime&#39; feature in train data</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>train[<span class="st">&quot;year&quot;</span>] <span class="op">=</span> train[<span class="st">&quot;datetime&quot;</span>].dt.year</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>train[<span class="st">&quot;month&quot;</span>] <span class="op">=</span> train[<span class="st">&quot;datetime&quot;</span>].dt.month</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>train[<span class="st">&quot;day&quot;</span>] <span class="op">=</span> train[<span class="st">&quot;datetime&quot;</span>].dt.dayofweek  <span class="co"># Note: day -&gt; dayofweek (0-&gt;Monday, 6-&gt;Sunday)</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>train[<span class="st">&quot;hour&quot;</span>] <span class="op">=</span> train[<span class="st">&quot;datetime&quot;</span>].dt.hour</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>train.drop([<span class="st">&quot;datetime&quot;</span>], axis<span class="op">=</span><span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)     <span class="co"># Drop &#39;datetime&#39; feature</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>train.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="26">

  <div id="df-b1fab516-0fb8-4d81-930a-08943b31a595">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>season</th>
      <th>holiday</th>
      <th>workingday</th>
      <th>weather</th>
      <th>temp</th>
      <th>atemp</th>
      <th>humidity</th>
      <th>windspeed</th>
      <th>casual</th>
      <th>registered</th>
      <th>count</th>
      <th>year</th>
      <th>month</th>
      <th>day</th>
      <th>hour</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>9.84</td>
      <td>14.395</td>
      <td>81</td>
      <td>0.0</td>
      <td>3</td>
      <td>13</td>
      <td>16</td>
      <td>2011</td>
      <td>1</td>
      <td>5</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>9.02</td>
      <td>13.635</td>
      <td>80</td>
      <td>0.0</td>
      <td>8</td>
      <td>32</td>
      <td>40</td>
      <td>2011</td>
      <td>1</td>
      <td>5</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>9.02</td>
      <td>13.635</td>
      <td>80</td>
      <td>0.0</td>
      <td>5</td>
      <td>27</td>
      <td>32</td>
      <td>2011</td>
      <td>1</td>
      <td>5</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>9.84</td>
      <td>14.395</td>
      <td>75</td>
      <td>0.0</td>
      <td>3</td>
      <td>10</td>
      <td>13</td>
      <td>2011</td>
      <td>1</td>
      <td>5</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>9.84</td>
      <td>14.395</td>
      <td>75</td>
      <td>0.0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>2011</td>
      <td>1</td>
      <td>5</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-b1fab516-0fb8-4d81-930a-08943b31a595')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-b1fab516-0fb8-4d81-930a-08943b31a595 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-b1fab516-0fb8-4d81-930a-08943b31a595');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell code" data-execution_count="29"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:206}"
id="TUEtwKZCpPtS" data-outputId="ee07c8f6-6d91-46d7-f3f8-5ebbb425a447">
<div class="sourceCode" id="cb44"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Splitting the &#39;datetime&#39; feature in test data</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>test<span class="op">=</span>pd.read_csv(<span class="st">&quot;/content/test.csv&quot;</span> , parse_dates<span class="op">=</span>[<span class="st">&quot;datetime&quot;</span>])</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>test[<span class="st">&quot;year&quot;</span>] <span class="op">=</span> test[<span class="st">&quot;datetime&quot;</span>].dt.year</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>test[<span class="st">&quot;month&quot;</span>] <span class="op">=</span> test[<span class="st">&quot;datetime&quot;</span>].dt.month</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>test[<span class="st">&quot;day&quot;</span>] <span class="op">=</span> test[<span class="st">&quot;datetime&quot;</span>].dt.dayofweek  <span class="co"># Note: day -&gt; dayofweek (0-&gt;Monday, 6-&gt;Sunday)</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>test[<span class="st">&quot;hour&quot;</span>] <span class="op">=</span> test[<span class="st">&quot;datetime&quot;</span>].dt.hour</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>test.drop([<span class="st">&quot;datetime&quot;</span>], axis<span class="op">=</span><span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)   <span class="co"># Drop &#39;datetime&#39; feature</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>test.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="29">

  <div id="df-9635375f-3777-456c-af7f-103fd83ea258">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>season</th>
      <th>holiday</th>
      <th>workingday</th>
      <th>weather</th>
      <th>temp</th>
      <th>atemp</th>
      <th>humidity</th>
      <th>windspeed</th>
      <th>year</th>
      <th>month</th>
      <th>day</th>
      <th>hour</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>10.66</td>
      <td>11.365</td>
      <td>56</td>
      <td>26.0027</td>
      <td>2011</td>
      <td>1</td>
      <td>3</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>10.66</td>
      <td>13.635</td>
      <td>56</td>
      <td>0.0000</td>
      <td>2011</td>
      <td>1</td>
      <td>3</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>10.66</td>
      <td>13.635</td>
      <td>56</td>
      <td>0.0000</td>
      <td>2011</td>
      <td>1</td>
      <td>3</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>10.66</td>
      <td>12.880</td>
      <td>56</td>
      <td>11.0014</td>
      <td>2011</td>
      <td>1</td>
      <td>3</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>10.66</td>
      <td>12.880</td>
      <td>56</td>
      <td>11.0014</td>
      <td>2011</td>
      <td>1</td>
      <td>3</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-9635375f-3777-456c-af7f-103fd83ea258')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-9635375f-3777-456c-af7f-103fd83ea258 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-9635375f-3777-456c-af7f-103fd83ea258');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<section
id="make-category-types-for-these-so-models-know-they-are-not-just-numbers"
class="cell markdown" id="cfOIK311E87m">
<h2>Make category types for these so models know they are not just
numbers</h2>
<ul>
<li>AutoGluon originally sees these as ints, but in reality they are int
representations of a category.</li>
<li>Setting the dtype to category will classify these as categories in
AutoGluon.</li>
</ul>
</section>
<div class="cell code" data-execution_count="30"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="YacY3CjixT4U" data-outputId="a12cb367-6c3e-43ff-f323-71937d251a7d">
<div class="sourceCode" id="cb45"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>train.info()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 10886 entries, 0 to 10885
Data columns (total 15 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   season      10886 non-null  int64  
 1   holiday     10886 non-null  int64  
 2   workingday  10886 non-null  int64  
 3   weather     10886 non-null  int64  
 4   temp        10886 non-null  float64
 5   atemp       10886 non-null  float64
 6   humidity    10886 non-null  int64  
 7   windspeed   10886 non-null  float64
 8   casual      10886 non-null  int64  
 9   registered  10886 non-null  int64  
 10  count       10886 non-null  int64  
 11  year        10886 non-null  int64  
 12  month       10886 non-null  int64  
 13  day         10886 non-null  int64  
 14  hour        10886 non-null  int64  
dtypes: float64(3), int64(12)
memory usage: 1.2 MB
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="31" id="pgBZJSrbE87m">
<div class="sourceCode" id="cb47"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert &#39;int&#39; feature columns that are categorical in nature to &#39;category&#39; type</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>train[<span class="st">&quot;season&quot;</span>] <span class="op">=</span> train[<span class="st">&quot;season&quot;</span>].astype(<span class="st">&quot;category&quot;</span>)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>train[<span class="st">&quot;weather&quot;</span>] <span class="op">=</span> train[<span class="st">&quot;weather&quot;</span>].astype(<span class="st">&quot;category&quot;</span>)</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>test[<span class="st">&quot;season&quot;</span>] <span class="op">=</span> test[<span class="st">&quot;season&quot;</span>].astype(<span class="st">&quot;category&quot;</span>)</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>test[<span class="st">&quot;weather&quot;</span>] <span class="op">=</span> test[<span class="st">&quot;weather&quot;</span>].astype(<span class="st">&quot;category&quot;</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="32"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:270}"
id="S0_kZBmrE87m" data-outputId="49bd6be2-7bca-4175-c814-fc3661cdf505">
<div class="sourceCode" id="cb48"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View are new feature</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>train.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="32">

  <div id="df-4028d027-5297-49cb-8d7a-d1697ba745f4">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>season</th>
      <th>holiday</th>
      <th>workingday</th>
      <th>weather</th>
      <th>temp</th>
      <th>atemp</th>
      <th>humidity</th>
      <th>windspeed</th>
      <th>casual</th>
      <th>registered</th>
      <th>count</th>
      <th>year</th>
      <th>month</th>
      <th>day</th>
      <th>hour</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>9.84</td>
      <td>14.395</td>
      <td>81</td>
      <td>0.0</td>
      <td>3</td>
      <td>13</td>
      <td>16</td>
      <td>2011</td>
      <td>1</td>
      <td>5</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>9.02</td>
      <td>13.635</td>
      <td>80</td>
      <td>0.0</td>
      <td>8</td>
      <td>32</td>
      <td>40</td>
      <td>2011</td>
      <td>1</td>
      <td>5</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>9.02</td>
      <td>13.635</td>
      <td>80</td>
      <td>0.0</td>
      <td>5</td>
      <td>27</td>
      <td>32</td>
      <td>2011</td>
      <td>1</td>
      <td>5</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>9.84</td>
      <td>14.395</td>
      <td>75</td>
      <td>0.0</td>
      <td>3</td>
      <td>10</td>
      <td>13</td>
      <td>2011</td>
      <td>1</td>
      <td>5</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>9.84</td>
      <td>14.395</td>
      <td>75</td>
      <td>0.0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>2011</td>
      <td>1</td>
      <td>5</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-4028d027-5297-49cb-8d7a-d1697ba745f4')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-4028d027-5297-49cb-8d7a-d1697ba745f4 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-4028d027-5297-49cb-8d7a-d1697ba745f4');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell code" data-execution_count="35"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="rJVFWqiGxzih" data-outputId="6a1d5b13-fbba-488b-f4fb-a16b372a839f">
<div class="sourceCode" id="cb49"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>train.info()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 10886 entries, 0 to 10885
Data columns (total 15 columns):
 #   Column      Non-Null Count  Dtype   
---  ------      --------------  -----   
 0   season      10886 non-null  category
 1   holiday     10886 non-null  int64   
 2   workingday  10886 non-null  int64   
 3   weather     10886 non-null  category
 4   temp        10886 non-null  float64 
 5   atemp       10886 non-null  float64 
 6   humidity    10886 non-null  int64   
 7   windspeed   10886 non-null  float64 
 8   casual      10886 non-null  int64   
 9   registered  10886 non-null  int64   
 10  count       10886 non-null  int64   
 11  year        10886 non-null  int64   
 12  month       10886 non-null  int64   
 13  day         10886 non-null  int64   
 14  hour        10886 non-null  int64   
dtypes: category(2), float64(3), int64(10)
memory usage: 1.1 MB
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="34"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:1000}"
id="IhS4qLi-E87m" data-outputId="5e361cbb-c44a-4134-c04e-d47284d053b7">
<div class="sourceCode" id="cb51"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View histogram of all features again now with the hour feature</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>train.hist(figsize<span class="op">=</span>(<span class="dv">15</span>,<span class="dv">20</span>))</span></code></pre></div>
<div class="output execute_result" data-execution_count="34">
<pre><code>array([[&lt;Axes: title={&#39;center&#39;: &#39;holiday&#39;}&gt;,
        &lt;Axes: title={&#39;center&#39;: &#39;workingday&#39;}&gt;,
        &lt;Axes: title={&#39;center&#39;: &#39;temp&#39;}&gt;,
        &lt;Axes: title={&#39;center&#39;: &#39;atemp&#39;}&gt;],
       [&lt;Axes: title={&#39;center&#39;: &#39;humidity&#39;}&gt;,
        &lt;Axes: title={&#39;center&#39;: &#39;windspeed&#39;}&gt;,
        &lt;Axes: title={&#39;center&#39;: &#39;casual&#39;}&gt;,
        &lt;Axes: title={&#39;center&#39;: &#39;registered&#39;}&gt;],
       [&lt;Axes: title={&#39;center&#39;: &#39;count&#39;}&gt;,
        &lt;Axes: title={&#39;center&#39;: &#39;year&#39;}&gt;,
        &lt;Axes: title={&#39;center&#39;: &#39;month&#39;}&gt;,
        &lt;Axes: title={&#39;center&#39;: &#39;day&#39;}&gt;],
       [&lt;Axes: title={&#39;center&#39;: &#39;hour&#39;}&gt;, &lt;Axes: &gt;, &lt;Axes: &gt;, &lt;Axes: &gt;]],
      dtype=object)</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_37271c91d75944799fe9745642b73185/7180ca3f7d607a1def916e1aa7df6f653a723755.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="37"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:507}"
id="GN8KFi3nygu_" data-outputId="1f4789b2-1fda-40f1-edc9-29b4778272c3">
<div class="sourceCode" id="cb53"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Variation in`count` w.r.t `hour`</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Using catplot: &#39;kind&#39;:bar makes sure to take value of &#39;count&#39; for every record into account</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>sb.catplot(x<span class="op">=</span><span class="st">&quot;hour&quot;</span>,y<span class="op">=</span><span class="st">&quot;count&quot;</span>,data<span class="op">=</span>train,kind<span class="op">=</span><span class="st">&#39;bar&#39;</span>,height<span class="op">=</span><span class="dv">5</span>,aspect<span class="op">=</span><span class="fl">1.5</span>) </span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_37271c91d75944799fe9745642b73185/7424a2adb0625ba0aab1d6ef846d85e607dffc0d.png" /></p>
</div>
</div>
<div class="cell markdown" id="avjCzIY3yqzy">
<p>Observations:</p>
<p>Frequency of Bike Rides (Hourly-basis):</p>
<ul>
<li>High: From 7-9 (7am - 9am) and 16-19 (4pm - 7pm)</li>
<li>Moderate: 10-15 (10am - 3pm)</li>
<li>Low: 0-6 (12am - 6am) and 20-24 (8pm - 12am)</li>
</ul>
<p>This makes sense as most people who rent these bikes could
potentially be young college students or working professionals, who
actively commute via some means of transport during peak hours of the
day mentioned under the High category.</p>
<p>Since bike rental is one of the cheapest option, this could be the
reason for the indicated surge in rental counts during peak hours of the
day.</p>
</div>
<div class="cell code" data-execution_count="39"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:507}"
id="5IrncwUmzp7W" data-outputId="4242a4a7-0ba9-4dc0-beee-c2893d2be936">
<div class="sourceCode" id="cb54"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Variation in`count` w.r.t `day` (dayofweek) [0: Monday -&gt; 6: Sunday]</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Using catplot: &#39;kind&#39;:bar makes sure to take value of &#39;count&#39; for every record into account</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>sb.catplot(x<span class="op">=</span><span class="st">&quot;day&quot;</span>,y<span class="op">=</span><span class="st">&quot;count&quot;</span>,data<span class="op">=</span>train,kind<span class="op">=</span><span class="st">&#39;bar&#39;</span>,height<span class="op">=</span><span class="dv">5</span>,aspect<span class="op">=</span><span class="fl">1.5</span>) </span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>plt.xticks(ticks<span class="op">=</span><span class="bu">range</span>(<span class="dv">0</span>,<span class="dv">7</span>), labels<span class="op">=</span>[<span class="st">&quot;Monday&quot;</span>, <span class="st">&quot;Tuesday&quot;</span>, <span class="st">&quot;Wednesday&quot;</span>, </span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">&quot;Thursday&quot;</span>, <span class="st">&quot;Friday&quot;</span>, <span class="st">&quot;Saturday&quot;</span>, <span class="st">&quot;Sunday&quot;</span>])</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_37271c91d75944799fe9745642b73185/cc19237590ab4bebf81b5e5d691db27a82aeafcc.png" /></p>
</div>
</div>
<div class="cell markdown" id="FgmOK-60z0T-">
<p>Observation:</p>
<p>Not much variation or pattern is seen in the bike rental counts with
respect to featureday.</p>
<p>However, the demand for bike rentals seem to be slightly more on
Thursdays, Fridays and Saturdays</p>
</div>
<div class="cell code" data-execution_count="40"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:996}"
id="qP_DbvV9zt2R" data-outputId="b99247f5-c550-4643-8dbf-9e34bc4ef14c">
<div class="sourceCode" id="cb55"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Variation in`count` w.r.t `month` and &#39;season&#39;</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Using catplot: &#39;kind&#39;:bar makes sure to take value of &#39;count&#39; for every record into account</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>sb.catplot(x<span class="op">=</span><span class="st">&quot;month&quot;</span>,y<span class="op">=</span><span class="st">&quot;count&quot;</span>,data<span class="op">=</span>train,kind<span class="op">=</span><span class="st">&#39;bar&#39;</span>,height<span class="op">=</span><span class="dv">5</span>,aspect<span class="op">=</span><span class="fl">1.5</span>) </span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>sb.catplot(x<span class="op">=</span><span class="st">&quot;season&quot;</span>,y<span class="op">=</span><span class="st">&quot;count&quot;</span>,data<span class="op">=</span>train,kind<span class="op">=</span><span class="st">&#39;bar&#39;</span>,height<span class="op">=</span><span class="dv">5</span>,aspect<span class="op">=</span><span class="fl">1.5</span>)</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_37271c91d75944799fe9745642b73185/20215a7dfa0dea6a795330d47f54444390048d5e.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_37271c91d75944799fe9745642b73185/d5c6c14045d7aba233b83e4a5e4739c910fd2bd4.png" /></p>
</div>
</div>
<div class="cell markdown" id="3LPon5JS0DIG">
<p>Observation:</p>
<p>Since seasons show variation in the number of bike rentals count, it
is obvious to notice the same from the month feature, but at a slightly
more granular level.</p>
</div>
<div class="cell code" data-execution_count="42"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:507}"
id="4eStXwIq0FR7" data-outputId="260e19ab-759c-4419-a693-790f7fd33e1f">
<div class="sourceCode" id="cb56"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Variation in`count` w.r.t `year`</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Using catplot: &#39;kind&#39;:bar makes sure to take value of &#39;count&#39; for every record into account</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>sb.catplot(x<span class="op">=</span><span class="st">&quot;year&quot;</span>,y<span class="op">=</span><span class="st">&quot;count&quot;</span>,data<span class="op">=</span>train,kind<span class="op">=</span><span class="st">&#39;bar&#39;</span>,height<span class="op">=</span><span class="dv">5</span>,aspect<span class="op">=</span><span class="fl">1.5</span>)</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_37271c91d75944799fe9745642b73185/22a21a9d49804fcbea7cfa77d09432a12770a64a.png" /></p>
</div>
</div>
<div class="cell markdown" id="W6X-aq540QjK">
<p>Year 2012 has higher bike demand as compared to 2011.</p>
</div>
<div class="cell code" data-execution_count="43"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:507}"
id="mNAEk16k0VmI" data-outputId="a5289f82-7dae-41a6-aa1c-71b6f99fc8f4">
<div class="sourceCode" id="cb57"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Variation in`count` w.r.t `weather&#39;</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Using catplot: &#39;kind&#39;:bar makes sure to take value of &#39;count&#39; for every record into account</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>sb.catplot(x<span class="op">=</span><span class="st">&quot;weather&quot;</span>,y<span class="op">=</span><span class="st">&quot;count&quot;</span>,data<span class="op">=</span>train,kind<span class="op">=</span><span class="st">&#39;bar&#39;</span>,height<span class="op">=</span><span class="dv">5</span>,aspect<span class="op">=</span><span class="fl">1.5</span>) </span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>plt.xticks(ticks<span class="op">=</span><span class="bu">range</span>(<span class="dv">0</span>,<span class="dv">4</span>), labels<span class="op">=</span>[<span class="st">&quot;Clear&quot;</span>,<span class="st">&quot;Misty&quot;</span>, </span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">&quot;Light_</span><span class="ch">\n</span><span class="st">Rain/Snow</span><span class="ch">\n</span><span class="st">/Thunderstorm&quot;</span>, </span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">&quot;Heavy_</span><span class="ch">\n</span><span class="st">Rain/Snow</span><span class="ch">\n</span><span class="st">/Thunderstorm&quot;</span>])</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_37271c91d75944799fe9745642b73185/96880bcd10949887c130b33f0dfd6790b8aa1e39.png" /></p>
</div>
</div>
<div class="cell markdown" id="S2Q4cAOC0dII">
<p>Bike rental counts are highest in Clear weather, followed by Misty
weather.</p>
</div>
<section id="creating-a-new-feature-day_type" class="cell markdown"
id="HSxdHILN0pne">
<h1><strong>Creating a new feature 'day_type'</strong></h1>
<p>We know that in the given data,</p>
<p>holiday - whether the day is considered a holiday (0: Non-holiday, 1:
Holiday)</p>
<p>workingday - whether the day is neither a weekend nor holiday (0:
Can-be-a-weekend-or-holiday, 1: No-weekend-No-holiday)</p>
</section>
<div class="cell code" data-execution_count="44"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:270}"
id="26F-tzVs0hR6" data-outputId="d869dc3d-baf6-4d4c-da5a-a42522db54a8">
<div class="sourceCode" id="cb58"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># New feature &#39;day_type&#39; contains categories &#39;weekend&#39;, &#39;weekday&#39;, or &#39;holiday&#39; (In Train and Test set)</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding features - &#39;day_type&#39; in train data</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>train[<span class="st">&quot;day_type&quot;</span>]<span class="op">=</span><span class="st">&quot;&quot;</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>train.loc[(train.holiday<span class="op">==</span><span class="dv">1</span>),<span class="st">&quot;day_type&quot;</span>] <span class="op">=</span> <span class="st">&quot;holiday&quot;</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>train.loc[((train.holiday<span class="op">==</span><span class="dv">0</span>) <span class="op">&amp;</span> (train.workingday<span class="op">==</span><span class="dv">1</span>)), <span class="st">&quot;day_type&quot;</span>] <span class="op">=</span> <span class="st">&quot;weekday&quot;</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>train.loc[((train.holiday<span class="op">==</span><span class="dv">0</span>) <span class="op">&amp;</span> (train.workingday<span class="op">==</span><span class="dv">0</span>)), <span class="st">&quot;day_type&quot;</span>] <span class="op">=</span> <span class="st">&quot;weekend&quot;</span></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding features - &#39;day_type&#39; in test data</span></span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>test[<span class="st">&quot;day_type&quot;</span>]<span class="op">=</span><span class="st">&quot;&quot;</span></span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>test.loc[(test.holiday<span class="op">==</span><span class="dv">1</span>),<span class="st">&quot;day_type&quot;</span>] <span class="op">=</span> <span class="st">&quot;holiday&quot;</span></span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>test.loc[((test.holiday<span class="op">==</span><span class="dv">0</span>) <span class="op">&amp;</span> (test.workingday<span class="op">==</span><span class="dv">1</span>)), <span class="st">&quot;day_type&quot;</span>] <span class="op">=</span> <span class="st">&quot;weekday&quot;</span></span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>test.loc[((test.holiday<span class="op">==</span><span class="dv">0</span>) <span class="op">&amp;</span> (test.workingday<span class="op">==</span><span class="dv">0</span>)), <span class="st">&quot;day_type&quot;</span>] <span class="op">=</span> <span class="st">&quot;weekend&quot;</span></span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Change the datatype to category</span></span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a>train[<span class="st">&quot;day_type&quot;</span>] <span class="op">=</span> train[<span class="st">&quot;day_type&quot;</span>].astype(<span class="st">&quot;category&quot;</span>)</span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a>test[<span class="st">&quot;day_type&quot;</span>] <span class="op">=</span> test[<span class="st">&quot;day_type&quot;</span>].astype(<span class="st">&quot;category&quot;</span>)</span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-19"><a href="#cb58-19" aria-hidden="true" tabindex="-1"></a>train.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="44">

  <div id="df-23418ef7-0c66-4f31-a64b-f7f0fa27e04e">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>season</th>
      <th>holiday</th>
      <th>workingday</th>
      <th>weather</th>
      <th>temp</th>
      <th>atemp</th>
      <th>humidity</th>
      <th>windspeed</th>
      <th>casual</th>
      <th>registered</th>
      <th>count</th>
      <th>year</th>
      <th>month</th>
      <th>day</th>
      <th>hour</th>
      <th>day_type</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>9.84</td>
      <td>14.395</td>
      <td>81</td>
      <td>0.0</td>
      <td>3</td>
      <td>13</td>
      <td>16</td>
      <td>2011</td>
      <td>1</td>
      <td>5</td>
      <td>0</td>
      <td>weekend</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>9.02</td>
      <td>13.635</td>
      <td>80</td>
      <td>0.0</td>
      <td>8</td>
      <td>32</td>
      <td>40</td>
      <td>2011</td>
      <td>1</td>
      <td>5</td>
      <td>1</td>
      <td>weekend</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>9.02</td>
      <td>13.635</td>
      <td>80</td>
      <td>0.0</td>
      <td>5</td>
      <td>27</td>
      <td>32</td>
      <td>2011</td>
      <td>1</td>
      <td>5</td>
      <td>2</td>
      <td>weekend</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>9.84</td>
      <td>14.395</td>
      <td>75</td>
      <td>0.0</td>
      <td>3</td>
      <td>10</td>
      <td>13</td>
      <td>2011</td>
      <td>1</td>
      <td>5</td>
      <td>3</td>
      <td>weekend</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>9.84</td>
      <td>14.395</td>
      <td>75</td>
      <td>0.0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>2011</td>
      <td>1</td>
      <td>5</td>
      <td>4</td>
      <td>weekend</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-23418ef7-0c66-4f31-a64b-f7f0fa27e04e')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-23418ef7-0c66-4f31-a64b-f7f0fa27e04e button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-23418ef7-0c66-4f31-a64b-f7f0fa27e04e');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell markdown" id="usWHru9A1Gtv">
<p>Observation:</p>
<p>New categorical feature day_type added with the following
categories.</p>
<p>'holiday': when holiday is set to 1</p>
<p>'weekday': when holiday is set to 0 and workingday is set to 1</p>
<p>'weekend': when holiday is set to 0 and workingday is set to 0</p>
</div>
<div class="cell code" data-execution_count="45"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:364}"
id="81bzO4xN0yeY" data-outputId="a85a2728-24fe-45e5-97ab-502e92d889ef">
<div class="sourceCode" id="cb59"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>train.describe()</span></code></pre></div>
<div class="output execute_result" data-execution_count="45">

  <div id="df-f585eda8-1be2-4374-94aa-8a6320014fa6">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>holiday</th>
      <th>workingday</th>
      <th>temp</th>
      <th>atemp</th>
      <th>humidity</th>
      <th>windspeed</th>
      <th>casual</th>
      <th>registered</th>
      <th>count</th>
      <th>year</th>
      <th>month</th>
      <th>day</th>
      <th>hour</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>10886.000000</td>
      <td>10886.000000</td>
      <td>10886.00000</td>
      <td>10886.000000</td>
      <td>10886.000000</td>
      <td>10886.000000</td>
      <td>10886.000000</td>
      <td>10886.000000</td>
      <td>10886.000000</td>
      <td>10886.000000</td>
      <td>10886.000000</td>
      <td>10886.000000</td>
      <td>10886.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>0.028569</td>
      <td>0.680875</td>
      <td>20.23086</td>
      <td>23.655084</td>
      <td>61.886460</td>
      <td>12.799395</td>
      <td>36.021955</td>
      <td>155.552177</td>
      <td>191.574132</td>
      <td>2011.501929</td>
      <td>6.521495</td>
      <td>3.013963</td>
      <td>11.541613</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.166599</td>
      <td>0.466159</td>
      <td>7.79159</td>
      <td>8.474601</td>
      <td>19.245033</td>
      <td>8.164537</td>
      <td>49.960477</td>
      <td>151.039033</td>
      <td>181.144454</td>
      <td>0.500019</td>
      <td>3.444373</td>
      <td>2.004585</td>
      <td>6.915838</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.82000</td>
      <td>0.760000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>2011.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>13.94000</td>
      <td>16.665000</td>
      <td>47.000000</td>
      <td>7.001500</td>
      <td>4.000000</td>
      <td>36.000000</td>
      <td>42.000000</td>
      <td>2011.000000</td>
      <td>4.000000</td>
      <td>1.000000</td>
      <td>6.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>20.50000</td>
      <td>24.240000</td>
      <td>62.000000</td>
      <td>12.998000</td>
      <td>17.000000</td>
      <td>118.000000</td>
      <td>145.000000</td>
      <td>2012.000000</td>
      <td>7.000000</td>
      <td>3.000000</td>
      <td>12.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>26.24000</td>
      <td>31.060000</td>
      <td>77.000000</td>
      <td>16.997900</td>
      <td>49.000000</td>
      <td>222.000000</td>
      <td>284.000000</td>
      <td>2012.000000</td>
      <td>10.000000</td>
      <td>5.000000</td>
      <td>18.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>41.00000</td>
      <td>45.455000</td>
      <td>100.000000</td>
      <td>56.996900</td>
      <td>367.000000</td>
      <td>886.000000</td>
      <td>977.000000</td>
      <td>2012.000000</td>
      <td>12.000000</td>
      <td>6.000000</td>
      <td>23.000000</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-f585eda8-1be2-4374-94aa-8a6320014fa6')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-f585eda8-1be2-4374-94aa-8a6320014fa6 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-f585eda8-1be2-4374-94aa-8a6320014fa6');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell markdown" id="Upe5KDwg10oV">
<p>Observations:</p>
<p>All the other aforementioned features have similar nature in the
plots</p>
<p>New feature year shows that the historical data is for years 2011 and
2012 respectively.</p>
<p>Historical data of all 12 months within a year is considered in this
train dataset.</p>
<p>Days from (at the earliest - 1st) to (at the maximum - 19th) of every
month are taken into account in the train dataset</p>
<p>Hourly information of all busy hours within 24 hours of a day is
mentioned in this dataset</p>
</div>
<div class="cell code" data-execution_count="46" id="sLtntAoF14np">
<div class="sourceCode" id="cb60"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dropping highly correlated independent feature &#39;atemp&#39; from train and test datasets</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>train.drop([<span class="st">&quot;atemp&quot;</span>], axis<span class="op">=</span><span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>test.drop([<span class="st">&quot;atemp&quot;</span>], axis<span class="op">=</span><span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="47"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="bhgZgiJX171e" data-outputId="13ccd893-8bc2-4f4c-9417-57973e123c79">
<div class="sourceCode" id="cb61"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Checking datatypes of variables</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>train.info()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 10886 entries, 0 to 10885
Data columns (total 15 columns):
 #   Column      Non-Null Count  Dtype   
---  ------      --------------  -----   
 0   season      10886 non-null  category
 1   holiday     10886 non-null  int64   
 2   workingday  10886 non-null  int64   
 3   weather     10886 non-null  category
 4   temp        10886 non-null  float64 
 5   humidity    10886 non-null  int64   
 6   windspeed   10886 non-null  float64 
 7   casual      10886 non-null  int64   
 8   registered  10886 non-null  int64   
 9   count       10886 non-null  int64   
 10  year        10886 non-null  int64   
 11  month       10886 non-null  int64   
 12  day         10886 non-null  int64   
 13  hour        10886 non-null  int64   
 14  day_type    10886 non-null  category
dtypes: category(3), float64(2), int64(10)
memory usage: 1.0 MB
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="48"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="x5jMOuDm1_KZ" data-outputId="a8626ba6-d615-4a04-8b2f-13a0a437dc0b">
<div class="sourceCode" id="cb63"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;(After EDA + Feature Engineering) Train Data Shape : &quot;</span>, train.shape)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;(After EDA + Feature Engineering) Test Data Shape  : &quot;</span>, test.shape)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>(After EDA + Feature Engineering) Train Data Shape :  (10886, 15)
(After EDA + Feature Engineering) Test Data Shape  :  (6493, 12)
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="50"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:896}"
id="nNgaPAJY2q7m" data-outputId="89ad2e21-2f7c-4654-f67e-46222eb80439">
<div class="sourceCode" id="cb65"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Let&#39;s check the correlation between these variables to see if there is pattern between variables</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Recheck: Plotting a heatmap to understand the correlation between the independent variables</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Ignoring &#39;casual&#39; and &#39;registered&#39; features</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>feature_numeric <span class="op">=</span> [i <span class="cf">for</span> i <span class="kw">in</span> train.columns <span class="cf">if</span> i <span class="kw">not</span> <span class="kw">in</span> [<span class="st">&#39;casual&#39;</span>, <span class="st">&#39;registered&#39;</span>]]</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize <span class="op">=</span> (<span class="dv">15</span>,<span class="dv">15</span>), dpi<span class="op">=</span><span class="dv">120</span>)</span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>corr_data <span class="op">=</span> train.copy()</span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>corr_matrix1 <span class="op">=</span> corr_data[feature_numeric].corr()</span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>f, ax_corr1 <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">15</span>), dpi<span class="op">=</span><span class="dv">120</span>)</span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a mask to eliminate redundant repetitive correlations</span></span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a>corr_mask <span class="op">=</span> np.array(corr_matrix1)</span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a>corr_mask[np.tril_indices_from(corr_mask)] <span class="op">=</span> <span class="va">False</span></span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-16"><a href="#cb65-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot heatmap using correlation matrix and mask</span></span>
<span id="cb65-17"><a href="#cb65-17" aria-hidden="true" tabindex="-1"></a>ax_corr1 <span class="op">=</span> sns.heatmap(corr_matrix1, cmap<span class="op">=</span> <span class="st">&#39;RdPu&#39;</span>, cbar_kws<span class="op">=</span>{<span class="st">&quot;shrink&quot;</span>: <span class="fl">.5</span>}, vmin<span class="op">=</span> <span class="op">-</span><span class="dv">1</span>, vmax<span class="op">=</span><span class="dv">1</span>, center<span class="op">=</span><span class="dv">0</span>,</span>
<span id="cb65-18"><a href="#cb65-18" aria-hidden="true" tabindex="-1"></a>            square<span class="op">=</span><span class="va">True</span>, mask<span class="op">=</span>corr_mask, annot<span class="op">=</span><span class="va">True</span>, linewidths<span class="op">=</span><span class="fl">0.01</span>, annot_kws<span class="op">=</span>{<span class="st">&quot;size&quot;</span>:<span class="dv">13</span>})</span>
<span id="cb65-19"><a href="#cb65-19" aria-hidden="true" tabindex="-1"></a>plt.xticks(fontsize<span class="op">=</span><span class="dv">14</span>, rotation<span class="op">=</span><span class="dv">90</span>)</span>
<span id="cb65-20"><a href="#cb65-20" aria-hidden="true" tabindex="-1"></a>plt.yticks(fontsize<span class="op">=</span><span class="dv">14</span>, rotation<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb65-21"><a href="#cb65-21" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&quot;HeatMap: Correlation Matrix&quot;</span>, fontsize<span class="op">=</span><span class="dv">20</span>, fontweight<span class="op">=</span><span class="st">&#39;bold&#39;</span>)</span>
<span id="cb65-22"><a href="#cb65-22" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb65-23"><a href="#cb65-23" aria-hidden="true" tabindex="-1"></a>plt.autoscale()</span>
<span id="cb65-24"><a href="#cb65-24" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output stream stderr">
<pre><code>&lt;ipython-input-50-e40151afd703&gt;:9: FutureWarning: The default value of numeric_only in DataFrame.corr is deprecated. In a future version, it will default to False. Select only valid columns or specify the value of numeric_only to silence this warning.
  corr_matrix1 = corr_data[feature_numeric].corr()
</code></pre>
</div>
<div class="output display_data">
<pre><code>&lt;Figure size 1800x1800 with 0 Axes&gt;</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_37271c91d75944799fe9745642b73185/c98fb4340af15c518f6486f8caa22994eb00a46f.png" /></p>
</div>
</div>
<section
id="step-5-rerun-the-model-with-the-same-settings-as-before-just-with-more-features"
class="cell markdown" id="H9cjl3peE87n">
<h2>Step 5: Rerun the model with the same settings as before, just with
more features</h2>
</section>
<div class="cell code" data-execution_count="51" id="TrwZpvH_29ow">
<div class="sourceCode" id="cb68"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Requirements: (Same settings as that of initial run) For AutoGluon&#39;s Tabular Predictions</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>eval_metric <span class="op">=</span> <span class="st">&#39;root_mean_squared_error&#39;</span> </span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>label <span class="op">=</span> <span class="st">&#39;count&#39;</span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>ignored_columns <span class="op">=</span> [<span class="st">&quot;casual&quot;</span>, <span class="st">&quot;registered&quot;</span>]   <span class="co"># Ignored columns while training</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>train_data <span class="op">=</span> train                           <span class="co"># &#39;casual&#39; and &#39;registered&#39; columns are already dropped/ignored</span></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>time_limit <span class="op">=</span> <span class="dv">600</span>                             <span class="co"># 10 minutes -&gt; 60*10 = 600 seconds</span></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>presets <span class="op">=</span> <span class="st">&quot;best_quality&quot;</span>                     <span class="co"># auto_stack=True</span></span></code></pre></div>
</div>
<div class="cell code" data-execution_count="52"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="yk0xpM2UE87n" data-outputId="cf2990d0-958f-4e81-92ec-74a5c566cbcc">
<div class="sourceCode" id="cb69"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>predictor_new_features <span class="op">=</span> TabularPredictor(label<span class="op">=</span><span class="st">&#39;count&#39;</span> , eval_metric<span class="op">=</span><span class="st">&#39;rmse&#39;</span>, problem_type<span class="op">=</span><span class="st">&#39;regression&#39;</span>).fit(train_data<span class="op">=</span>train.drop([<span class="st">&#39;casual&#39;</span> , <span class="st">&#39;registered&#39;</span>], axis<span class="op">=</span><span class="dv">1</span>), time_limit<span class="op">=</span><span class="dv">600</span>, presets<span class="op">=</span><span class="st">&quot;best_quality&quot;</span>)</span></code></pre></div>
<div class="output stream stderr">
<pre><code>No path specified. Models will be saved in: &quot;AutogluonModels/ag-20230528_101925/&quot;
Presets specified: [&#39;best_quality&#39;]
Stack configuration (auto_stack=True): num_stack_levels=1, num_bag_folds=8, num_bag_sets=20
Beginning AutoGluon training ... Time limit = 600s
AutoGluon will save models to &quot;AutogluonModels/ag-20230528_101925/&quot;
AutoGluon Version:  0.7.0
Python Version:     3.10.11
Operating System:   Linux
Platform Machine:   x86_64
Platform Version:   #1 SMP Sat Apr 29 09:15:28 UTC 2023
Train Data Rows:    10886
Train Data Columns: 12
Label Column: count
Preprocessing data ...
Using Feature Generators to preprocess the data ...
Fitting AutoMLPipelineFeatureGenerator...
	Available Memory:                    10648.59 MB
	Train Data (Original)  Memory Usage: 0.82 MB (0.0% of available memory)
	Inferring data type of each feature based on column values. Set feature_metadata_in to manually specify special dtypes of the features.
	Stage 1 Generators:
		Fitting AsTypeFeatureGenerator...
			Note: Converting 3 features to boolean dtype as they only contain 2 unique values.
	Stage 2 Generators:
		Fitting FillNaFeatureGenerator...
	Stage 3 Generators:
		Fitting IdentityFeatureGenerator...
		Fitting CategoryFeatureGenerator...
			Fitting CategoryMemoryMinimizeFeatureGenerator...
	Stage 4 Generators:
		Fitting DropUniqueFeatureGenerator...
	Types of features in original data (raw dtype, special dtypes):
		(&#39;category&#39;, []) : 3 | [&#39;season&#39;, &#39;weather&#39;, &#39;day_type&#39;]
		(&#39;float&#39;, [])    : 2 | [&#39;temp&#39;, &#39;windspeed&#39;]
		(&#39;int&#39;, [])      : 7 | [&#39;holiday&#39;, &#39;workingday&#39;, &#39;humidity&#39;, &#39;year&#39;, &#39;month&#39;, ...]
	Types of features in processed data (raw dtype, special dtypes):
		(&#39;category&#39;, [])  : 3 | [&#39;season&#39;, &#39;weather&#39;, &#39;day_type&#39;]
		(&#39;float&#39;, [])     : 2 | [&#39;temp&#39;, &#39;windspeed&#39;]
		(&#39;int&#39;, [])       : 4 | [&#39;humidity&#39;, &#39;month&#39;, &#39;day&#39;, &#39;hour&#39;]
		(&#39;int&#39;, [&#39;bool&#39;]) : 3 | [&#39;holiday&#39;, &#39;workingday&#39;, &#39;year&#39;]
	0.1s = Fit runtime
	12 features in original data used to generate 12 features in processed data.
	Train Data (Processed) Memory Usage: 0.59 MB (0.0% of available memory)
Data preprocessing and feature engineering runtime = 0.17s ...
AutoGluon will gauge predictive performance using evaluation metric: &#39;root_mean_squared_error&#39;
	This metric&#39;s sign has been flipped to adhere to being higher_is_better. The metric score can be multiplied by -1 to get the metric value.
	To change this, specify the eval_metric parameter of Predictor()
AutoGluon will fit 2 stack levels (L1 to L2) ...
Fitting 11 L1 models ...
Fitting model: KNeighborsUnif_BAG_L1 ... Training model for up to 399.78s of the 599.81s of remaining time.
	-113.2616	 = Validation score   (-root_mean_squared_error)
	0.05s	 = Training   runtime
	0.2s	 = Validation runtime
Fitting model: KNeighborsDist_BAG_L1 ... Training model for up to 399.36s of the 599.4s of remaining time.
	-109.8452	 = Validation score   (-root_mean_squared_error)
	0.04s	 = Training   runtime
	0.19s	 = Validation runtime
Fitting model: LightGBMXT_BAG_L1 ... Training model for up to 399.07s of the 599.11s of remaining time.
	Fitting 8 child models (S1F1 - S1F8) | Fitting with ParallelLocalFoldFittingStrategy
	-36.708	 = Validation score   (-root_mean_squared_error)
	118.71s	 = Training   runtime
	30.44s	 = Validation runtime
Fitting model: LightGBM_BAG_L1 ... Training model for up to 267.87s of the 467.9s of remaining time.
	Fitting 8 child models (S1F1 - S1F8) | Fitting with ParallelLocalFoldFittingStrategy
	-35.7804	 = Validation score   (-root_mean_squared_error)
	62.42s	 = Training   runtime
	4.86s	 = Validation runtime
Fitting model: RandomForestMSE_BAG_L1 ... Training model for up to 198.73s of the 398.76s of remaining time.
	-39.7172	 = Validation score   (-root_mean_squared_error)
	12.94s	 = Training   runtime
	0.62s	 = Validation runtime
Fitting model: CatBoost_BAG_L1 ... Training model for up to 184.04s of the 384.08s of remaining time.
	Fitting 8 child models (S1F1 - S1F8) | Fitting with ParallelLocalFoldFittingStrategy
	-37.0758	 = Validation score   (-root_mean_squared_error)
	167.52s	 = Training   runtime
	0.48s	 = Validation runtime
Fitting model: ExtraTreesMSE_BAG_L1 ... Training model for up to 11.34s of the 211.38s of remaining time.
	-38.5802	 = Validation score   (-root_mean_squared_error)
	10.38s	 = Training   runtime
	0.94s	 = Validation runtime
Completed 1/20 k-fold bagging repeats ...
Fitting model: WeightedEnsemble_L2 ... Training model for up to 360.0s of the 198.71s of remaining time.
	-34.3033	 = Validation score   (-root_mean_squared_error)
	0.72s	 = Training   runtime
	0.0s	 = Validation runtime
Fitting 9 L2 models ...
Fitting model: LightGBMXT_BAG_L2 ... Training model for up to 197.95s of the 197.94s of remaining time.
	Fitting 8 child models (S1F1 - S1F8) | Fitting with ParallelLocalFoldFittingStrategy
	-35.1592	 = Validation score   (-root_mean_squared_error)
	34.53s	 = Training   runtime
	0.55s	 = Validation runtime
Fitting model: LightGBM_BAG_L2 ... Training model for up to 159.36s of the 159.33s of remaining time.
	Fitting 8 child models (S1F1 - S1F8) | Fitting with ParallelLocalFoldFittingStrategy
	-34.8964	 = Validation score   (-root_mean_squared_error)
	31.86s	 = Training   runtime
	0.25s	 = Validation runtime
Fitting model: RandomForestMSE_BAG_L2 ... Training model for up to 119.25s of the 119.23s of remaining time.
	-35.1658	 = Validation score   (-root_mean_squared_error)
	43.81s	 = Training   runtime
	0.72s	 = Validation runtime
Fitting model: CatBoost_BAG_L2 ... Training model for up to 73.8s of the 73.78s of remaining time.
	Fitting 8 child models (S1F1 - S1F8) | Fitting with ParallelLocalFoldFittingStrategy
	-34.3495	 = Validation score   (-root_mean_squared_error)
	79.98s	 = Training   runtime
	0.25s	 = Validation runtime
Completed 1/20 k-fold bagging repeats ...
Fitting model: WeightedEnsemble_L3 ... Training model for up to 360.0s of the -10.16s of remaining time.
	-34.2609	 = Validation score   (-root_mean_squared_error)
	0.48s	 = Training   runtime
	0.0s	 = Validation runtime
AutoGluon training complete, total runtime = 610.68s ... Best model: &quot;WeightedEnsemble_L3&quot;
TabularPredictor saved. To load, use: predictor = TabularPredictor.load(&quot;AutogluonModels/ag-20230528_101925/&quot;)
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="53"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="Q8Jei07aE87n" data-outputId="b2ca7c76-babe-43b2-92d0-bdd1b049d317">
<div class="sourceCode" id="cb71"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>predictor_new_features.fit_summary()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>*** Summary of fit() ***
Estimated performance of each model:
                     model   score_val  pred_time_val    fit_time  pred_time_val_marginal  fit_time_marginal  stack_level  can_infer  fit_order
0      WeightedEnsemble_L3  -34.260888      39.498491  562.700354                0.001378           0.475830            3       True         13
1      WeightedEnsemble_L2  -34.303309      37.334614  372.677026                0.001255           0.721184            2       True          8
2          CatBoost_BAG_L2  -34.349501      37.975485  452.023577                0.250371          79.975155            2       True         12
3          LightGBM_BAG_L2  -34.896381      37.978415  403.913141                0.253300          31.864718            2       True         10
4        LightGBMXT_BAG_L2  -35.159156      38.270269  406.579132                0.545155          34.530710            2       True          9
5   RandomForestMSE_BAG_L2  -35.165752      38.448287  415.853942                0.723173          43.805520            2       True         11
6          LightGBM_BAG_L1  -35.780355       4.856430   62.416599                4.856430          62.416599            1       True          4
7        LightGBMXT_BAG_L1  -36.708020      30.436774  118.705122               30.436774         118.705122            1       True          3
8          CatBoost_BAG_L1  -37.075804       0.480262  167.522547                0.480262         167.522547            1       True          6
9     ExtraTreesMSE_BAG_L1  -38.580226       0.941263   10.375779                0.941263          10.375779            1       True          7
10  RandomForestMSE_BAG_L1  -39.717239       0.618629   12.935794                0.618629          12.935794            1       True          5
11   KNeighborsDist_BAG_L1 -109.845172       0.194041    0.043512                0.194041           0.043512            1       True          2
12   KNeighborsUnif_BAG_L1 -113.261643       0.197715    0.049069                0.197715           0.049069            1       True          1
Number of models trained: 13
Types of models trained:
{&#39;StackerEnsembleModel_XT&#39;, &#39;StackerEnsembleModel_KNN&#39;, &#39;WeightedEnsembleModel&#39;, &#39;StackerEnsembleModel_RF&#39;, &#39;StackerEnsembleModel_CatBoost&#39;, &#39;StackerEnsembleModel_LGB&#39;}
Bagging used: True  (with 8 folds)
Multi-layer stack-ensembling used: True  (with 3 levels)
Feature Metadata (Processed):
(raw dtype, special dtypes):
(&#39;category&#39;, [])  : 3 | [&#39;season&#39;, &#39;weather&#39;, &#39;day_type&#39;]
(&#39;float&#39;, [])     : 2 | [&#39;temp&#39;, &#39;windspeed&#39;]
(&#39;int&#39;, [])       : 4 | [&#39;humidity&#39;, &#39;month&#39;, &#39;day&#39;, &#39;hour&#39;]
(&#39;int&#39;, [&#39;bool&#39;]) : 3 | [&#39;holiday&#39;, &#39;workingday&#39;, &#39;year&#39;]
*** End of fit() summary ***
</code></pre>
</div>
<div class="output stream stderr">
<pre><code>/usr/local/lib/python3.10/dist-packages/autogluon/core/utils/plots.py:138: UserWarning: AutoGluon summary plots cannot be created because bokeh is not installed. To see plots, please do: &quot;pip install bokeh==2.0.1&quot;
  warnings.warn(&#39;AutoGluon summary plots cannot be created because bokeh is not installed. To see plots, please do: &quot;pip install bokeh==2.0.1&quot;&#39;)
</code></pre>
</div>
<div class="output execute_result" data-execution_count="53">
<pre><code>{&#39;model_types&#39;: {&#39;KNeighborsUnif_BAG_L1&#39;: &#39;StackerEnsembleModel_KNN&#39;,
  &#39;KNeighborsDist_BAG_L1&#39;: &#39;StackerEnsembleModel_KNN&#39;,
  &#39;LightGBMXT_BAG_L1&#39;: &#39;StackerEnsembleModel_LGB&#39;,
  &#39;LightGBM_BAG_L1&#39;: &#39;StackerEnsembleModel_LGB&#39;,
  &#39;RandomForestMSE_BAG_L1&#39;: &#39;StackerEnsembleModel_RF&#39;,
  &#39;CatBoost_BAG_L1&#39;: &#39;StackerEnsembleModel_CatBoost&#39;,
  &#39;ExtraTreesMSE_BAG_L1&#39;: &#39;StackerEnsembleModel_XT&#39;,
  &#39;WeightedEnsemble_L2&#39;: &#39;WeightedEnsembleModel&#39;,
  &#39;LightGBMXT_BAG_L2&#39;: &#39;StackerEnsembleModel_LGB&#39;,
  &#39;LightGBM_BAG_L2&#39;: &#39;StackerEnsembleModel_LGB&#39;,
  &#39;RandomForestMSE_BAG_L2&#39;: &#39;StackerEnsembleModel_RF&#39;,
  &#39;CatBoost_BAG_L2&#39;: &#39;StackerEnsembleModel_CatBoost&#39;,
  &#39;WeightedEnsemble_L3&#39;: &#39;WeightedEnsembleModel&#39;},
 &#39;model_performance&#39;: {&#39;KNeighborsUnif_BAG_L1&#39;: -113.26164315463612,
  &#39;KNeighborsDist_BAG_L1&#39;: -109.84517207130654,
  &#39;LightGBMXT_BAG_L1&#39;: -36.7080198842608,
  &#39;LightGBM_BAG_L1&#39;: -35.78035548163389,
  &#39;RandomForestMSE_BAG_L1&#39;: -39.71723944004303,
  &#39;CatBoost_BAG_L1&#39;: -37.07580362754405,
  &#39;ExtraTreesMSE_BAG_L1&#39;: -38.58022605268176,
  &#39;WeightedEnsemble_L2&#39;: -34.30330910082122,
  &#39;LightGBMXT_BAG_L2&#39;: -35.159155821486934,
  &#39;LightGBM_BAG_L2&#39;: -34.89638103326082,
  &#39;RandomForestMSE_BAG_L2&#39;: -35.16575194477491,
  &#39;CatBoost_BAG_L2&#39;: -34.34950125570215,
  &#39;WeightedEnsemble_L3&#39;: -34.260887698941204},
 &#39;model_best&#39;: &#39;WeightedEnsemble_L3&#39;,
 &#39;model_paths&#39;: {&#39;KNeighborsUnif_BAG_L1&#39;: &#39;AutogluonModels/ag-20230528_101925/models/KNeighborsUnif_BAG_L1/&#39;,
  &#39;KNeighborsDist_BAG_L1&#39;: &#39;AutogluonModels/ag-20230528_101925/models/KNeighborsDist_BAG_L1/&#39;,
  &#39;LightGBMXT_BAG_L1&#39;: &#39;AutogluonModels/ag-20230528_101925/models/LightGBMXT_BAG_L1/&#39;,
  &#39;LightGBM_BAG_L1&#39;: &#39;AutogluonModels/ag-20230528_101925/models/LightGBM_BAG_L1/&#39;,
  &#39;RandomForestMSE_BAG_L1&#39;: &#39;AutogluonModels/ag-20230528_101925/models/RandomForestMSE_BAG_L1/&#39;,
  &#39;CatBoost_BAG_L1&#39;: &#39;AutogluonModels/ag-20230528_101925/models/CatBoost_BAG_L1/&#39;,
  &#39;ExtraTreesMSE_BAG_L1&#39;: &#39;AutogluonModels/ag-20230528_101925/models/ExtraTreesMSE_BAG_L1/&#39;,
  &#39;WeightedEnsemble_L2&#39;: &#39;AutogluonModels/ag-20230528_101925/models/WeightedEnsemble_L2/&#39;,
  &#39;LightGBMXT_BAG_L2&#39;: &#39;AutogluonModels/ag-20230528_101925/models/LightGBMXT_BAG_L2/&#39;,
  &#39;LightGBM_BAG_L2&#39;: &#39;AutogluonModels/ag-20230528_101925/models/LightGBM_BAG_L2/&#39;,
  &#39;RandomForestMSE_BAG_L2&#39;: &#39;AutogluonModels/ag-20230528_101925/models/RandomForestMSE_BAG_L2/&#39;,
  &#39;CatBoost_BAG_L2&#39;: &#39;AutogluonModels/ag-20230528_101925/models/CatBoost_BAG_L2/&#39;,
  &#39;WeightedEnsemble_L3&#39;: &#39;AutogluonModels/ag-20230528_101925/models/WeightedEnsemble_L3/&#39;},
 &#39;model_fit_times&#39;: {&#39;KNeighborsUnif_BAG_L1&#39;: 0.04906916618347168,
  &#39;KNeighborsDist_BAG_L1&#39;: 0.04351186752319336,
  &#39;LightGBMXT_BAG_L1&#39;: 118.70512223243713,
  &#39;LightGBM_BAG_L1&#39;: 62.41659927368164,
  &#39;RandomForestMSE_BAG_L1&#39;: 12.935794353485107,
  &#39;CatBoost_BAG_L1&#39;: 167.52254676818848,
  &#39;ExtraTreesMSE_BAG_L1&#39;: 10.375778913497925,
  &#39;WeightedEnsemble_L2&#39;: 0.721184492111206,
  &#39;LightGBMXT_BAG_L2&#39;: 34.53070950508118,
  &#39;LightGBM_BAG_L2&#39;: 31.864717960357666,
  &#39;RandomForestMSE_BAG_L2&#39;: 43.805519580841064,
  &#39;CatBoost_BAG_L2&#39;: 79.9751546382904,
  &#39;WeightedEnsemble_L3&#39;: 0.4758296012878418},
 &#39;model_pred_times&#39;: {&#39;KNeighborsUnif_BAG_L1&#39;: 0.19771456718444824,
  &#39;KNeighborsDist_BAG_L1&#39;: 0.19404125213623047,
  &#39;LightGBMXT_BAG_L1&#39;: 30.436774492263794,
  &#39;LightGBM_BAG_L1&#39;: 4.8564300537109375,
  &#39;RandomForestMSE_BAG_L1&#39;: 0.618628740310669,
  &#39;CatBoost_BAG_L1&#39;: 0.48026180267333984,
  &#39;ExtraTreesMSE_BAG_L1&#39;: 0.9412634372711182,
  &#39;WeightedEnsemble_L2&#39;: 0.0012552738189697266,
  &#39;LightGBMXT_BAG_L2&#39;: 0.5451548099517822,
  &#39;LightGBM_BAG_L2&#39;: 0.25330042839050293,
  &#39;RandomForestMSE_BAG_L2&#39;: 0.7231729030609131,
  &#39;CatBoost_BAG_L2&#39;: 0.25037050247192383,
  &#39;WeightedEnsemble_L3&#39;: 0.0013782978057861328},
 &#39;num_bag_folds&#39;: 8,
 &#39;max_stack_level&#39;: 3,
 &#39;model_hyperparams&#39;: {&#39;KNeighborsUnif_BAG_L1&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True,
   &#39;use_child_oof&#39;: True},
  &#39;KNeighborsDist_BAG_L1&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True,
   &#39;use_child_oof&#39;: True},
  &#39;LightGBMXT_BAG_L1&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True},
  &#39;LightGBM_BAG_L1&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True},
  &#39;RandomForestMSE_BAG_L1&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True,
   &#39;use_child_oof&#39;: True},
  &#39;CatBoost_BAG_L1&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True},
  &#39;ExtraTreesMSE_BAG_L1&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True,
   &#39;use_child_oof&#39;: True},
  &#39;WeightedEnsemble_L2&#39;: {&#39;use_orig_features&#39;: False,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True},
  &#39;LightGBMXT_BAG_L2&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True},
  &#39;LightGBM_BAG_L2&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True},
  &#39;RandomForestMSE_BAG_L2&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True,
   &#39;use_child_oof&#39;: True},
  &#39;CatBoost_BAG_L2&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True},
  &#39;WeightedEnsemble_L3&#39;: {&#39;use_orig_features&#39;: False,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True}},
 &#39;leaderboard&#39;:                      model   score_val  pred_time_val    fit_time  \
 0      WeightedEnsemble_L3  -34.260888      39.498491  562.700354   
 1      WeightedEnsemble_L2  -34.303309      37.334614  372.677026   
 2          CatBoost_BAG_L2  -34.349501      37.975485  452.023577   
 3          LightGBM_BAG_L2  -34.896381      37.978415  403.913141   
 4        LightGBMXT_BAG_L2  -35.159156      38.270269  406.579132   
 5   RandomForestMSE_BAG_L2  -35.165752      38.448287  415.853942   
 6          LightGBM_BAG_L1  -35.780355       4.856430   62.416599   
 7        LightGBMXT_BAG_L1  -36.708020      30.436774  118.705122   
 8          CatBoost_BAG_L1  -37.075804       0.480262  167.522547   
 9     ExtraTreesMSE_BAG_L1  -38.580226       0.941263   10.375779   
 10  RandomForestMSE_BAG_L1  -39.717239       0.618629   12.935794   
 11   KNeighborsDist_BAG_L1 -109.845172       0.194041    0.043512   
 12   KNeighborsUnif_BAG_L1 -113.261643       0.197715    0.049069   
 
     pred_time_val_marginal  fit_time_marginal  stack_level  can_infer  \
 0                 0.001378           0.475830            3       True   
 1                 0.001255           0.721184            2       True   
 2                 0.250371          79.975155            2       True   
 3                 0.253300          31.864718            2       True   
 4                 0.545155          34.530710            2       True   
 5                 0.723173          43.805520            2       True   
 6                 4.856430          62.416599            1       True   
 7                30.436774         118.705122            1       True   
 8                 0.480262         167.522547            1       True   
 9                 0.941263          10.375779            1       True   
 10                0.618629          12.935794            1       True   
 11                0.194041           0.043512            1       True   
 12                0.197715           0.049069            1       True   
 
     fit_order  
 0          13  
 1           8  
 2          12  
 3          10  
 4           9  
 5          11  
 6           4  
 7           3  
 8           6  
 9           7  
 10          5  
 11          2  
 12          1  }</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="54"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:764}"
id="dKGR3jzE69pR" data-outputId="ff6d562d-2fe2-45ae-c2d1-4e9ed173fe88">
<div class="sourceCode" id="cb75"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>predictor_new_features.leaderboard()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>                     model   score_val  pred_time_val    fit_time  pred_time_val_marginal  fit_time_marginal  stack_level  can_infer  fit_order
0      WeightedEnsemble_L3  -34.260888      39.498491  562.700354                0.001378           0.475830            3       True         13
1      WeightedEnsemble_L2  -34.303309      37.334614  372.677026                0.001255           0.721184            2       True          8
2          CatBoost_BAG_L2  -34.349501      37.975485  452.023577                0.250371          79.975155            2       True         12
3          LightGBM_BAG_L2  -34.896381      37.978415  403.913141                0.253300          31.864718            2       True         10
4        LightGBMXT_BAG_L2  -35.159156      38.270269  406.579132                0.545155          34.530710            2       True          9
5   RandomForestMSE_BAG_L2  -35.165752      38.448287  415.853942                0.723173          43.805520            2       True         11
6          LightGBM_BAG_L1  -35.780355       4.856430   62.416599                4.856430          62.416599            1       True          4
7        LightGBMXT_BAG_L1  -36.708020      30.436774  118.705122               30.436774         118.705122            1       True          3
8          CatBoost_BAG_L1  -37.075804       0.480262  167.522547                0.480262         167.522547            1       True          6
9     ExtraTreesMSE_BAG_L1  -38.580226       0.941263   10.375779                0.941263          10.375779            1       True          7
10  RandomForestMSE_BAG_L1  -39.717239       0.618629   12.935794                0.618629          12.935794            1       True          5
11   KNeighborsDist_BAG_L1 -109.845172       0.194041    0.043512                0.194041           0.043512            1       True          2
12   KNeighborsUnif_BAG_L1 -113.261643       0.197715    0.049069                0.197715           0.049069            1       True          1
</code></pre>
</div>
<div class="output execute_result" data-execution_count="54">

  <div id="df-00acb267-9055-43de-9260-1dff543c30fd">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>model</th>
      <th>score_val</th>
      <th>pred_time_val</th>
      <th>fit_time</th>
      <th>pred_time_val_marginal</th>
      <th>fit_time_marginal</th>
      <th>stack_level</th>
      <th>can_infer</th>
      <th>fit_order</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>WeightedEnsemble_L3</td>
      <td>-34.260888</td>
      <td>39.498491</td>
      <td>562.700354</td>
      <td>0.001378</td>
      <td>0.475830</td>
      <td>3</td>
      <td>True</td>
      <td>13</td>
    </tr>
    <tr>
      <th>1</th>
      <td>WeightedEnsemble_L2</td>
      <td>-34.303309</td>
      <td>37.334614</td>
      <td>372.677026</td>
      <td>0.001255</td>
      <td>0.721184</td>
      <td>2</td>
      <td>True</td>
      <td>8</td>
    </tr>
    <tr>
      <th>2</th>
      <td>CatBoost_BAG_L2</td>
      <td>-34.349501</td>
      <td>37.975485</td>
      <td>452.023577</td>
      <td>0.250371</td>
      <td>79.975155</td>
      <td>2</td>
      <td>True</td>
      <td>12</td>
    </tr>
    <tr>
      <th>3</th>
      <td>LightGBM_BAG_L2</td>
      <td>-34.896381</td>
      <td>37.978415</td>
      <td>403.913141</td>
      <td>0.253300</td>
      <td>31.864718</td>
      <td>2</td>
      <td>True</td>
      <td>10</td>
    </tr>
    <tr>
      <th>4</th>
      <td>LightGBMXT_BAG_L2</td>
      <td>-35.159156</td>
      <td>38.270269</td>
      <td>406.579132</td>
      <td>0.545155</td>
      <td>34.530710</td>
      <td>2</td>
      <td>True</td>
      <td>9</td>
    </tr>
    <tr>
      <th>5</th>
      <td>RandomForestMSE_BAG_L2</td>
      <td>-35.165752</td>
      <td>38.448287</td>
      <td>415.853942</td>
      <td>0.723173</td>
      <td>43.805520</td>
      <td>2</td>
      <td>True</td>
      <td>11</td>
    </tr>
    <tr>
      <th>6</th>
      <td>LightGBM_BAG_L1</td>
      <td>-35.780355</td>
      <td>4.856430</td>
      <td>62.416599</td>
      <td>4.856430</td>
      <td>62.416599</td>
      <td>1</td>
      <td>True</td>
      <td>4</td>
    </tr>
    <tr>
      <th>7</th>
      <td>LightGBMXT_BAG_L1</td>
      <td>-36.708020</td>
      <td>30.436774</td>
      <td>118.705122</td>
      <td>30.436774</td>
      <td>118.705122</td>
      <td>1</td>
      <td>True</td>
      <td>3</td>
    </tr>
    <tr>
      <th>8</th>
      <td>CatBoost_BAG_L1</td>
      <td>-37.075804</td>
      <td>0.480262</td>
      <td>167.522547</td>
      <td>0.480262</td>
      <td>167.522547</td>
      <td>1</td>
      <td>True</td>
      <td>6</td>
    </tr>
    <tr>
      <th>9</th>
      <td>ExtraTreesMSE_BAG_L1</td>
      <td>-38.580226</td>
      <td>0.941263</td>
      <td>10.375779</td>
      <td>0.941263</td>
      <td>10.375779</td>
      <td>1</td>
      <td>True</td>
      <td>7</td>
    </tr>
    <tr>
      <th>10</th>
      <td>RandomForestMSE_BAG_L1</td>
      <td>-39.717239</td>
      <td>0.618629</td>
      <td>12.935794</td>
      <td>0.618629</td>
      <td>12.935794</td>
      <td>1</td>
      <td>True</td>
      <td>5</td>
    </tr>
    <tr>
      <th>11</th>
      <td>KNeighborsDist_BAG_L1</td>
      <td>-109.845172</td>
      <td>0.194041</td>
      <td>0.043512</td>
      <td>0.194041</td>
      <td>0.043512</td>
      <td>1</td>
      <td>True</td>
      <td>2</td>
    </tr>
    <tr>
      <th>12</th>
      <td>KNeighborsUnif_BAG_L1</td>
      <td>-113.261643</td>
      <td>0.197715</td>
      <td>0.049069</td>
      <td>0.197715</td>
      <td>0.049069</td>
      <td>1</td>
      <td>True</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-00acb267-9055-43de-9260-1dff543c30fd')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-00acb267-9055-43de-9260-1dff543c30fd button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-00acb267-9055-43de-9260-1dff543c30fd');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell code" data-execution_count="55"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:901}"
id="atYyXRZj7Q7W" data-outputId="33974a82-aed3-4ef4-f412-b2c1142d2844">
<div class="sourceCode" id="cb77"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>predictor_new_features.leaderboard().plot(kind<span class="op">=</span><span class="st">&quot;bar&quot;</span>, x<span class="op">=</span><span class="st">&quot;model&quot;</span>, y<span class="op">=</span><span class="st">&quot;score_val&quot;</span>, figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">7</span>))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>                     model   score_val  pred_time_val    fit_time  pred_time_val_marginal  fit_time_marginal  stack_level  can_infer  fit_order
0      WeightedEnsemble_L3  -34.260888      39.498491  562.700354                0.001378           0.475830            3       True         13
1      WeightedEnsemble_L2  -34.303309      37.334614  372.677026                0.001255           0.721184            2       True          8
2          CatBoost_BAG_L2  -34.349501      37.975485  452.023577                0.250371          79.975155            2       True         12
3          LightGBM_BAG_L2  -34.896381      37.978415  403.913141                0.253300          31.864718            2       True         10
4        LightGBMXT_BAG_L2  -35.159156      38.270269  406.579132                0.545155          34.530710            2       True          9
5   RandomForestMSE_BAG_L2  -35.165752      38.448287  415.853942                0.723173          43.805520            2       True         11
6          LightGBM_BAG_L1  -35.780355       4.856430   62.416599                4.856430          62.416599            1       True          4
7        LightGBMXT_BAG_L1  -36.708020      30.436774  118.705122               30.436774         118.705122            1       True          3
8          CatBoost_BAG_L1  -37.075804       0.480262  167.522547                0.480262         167.522547            1       True          6
9     ExtraTreesMSE_BAG_L1  -38.580226       0.941263   10.375779                0.941263          10.375779            1       True          7
10  RandomForestMSE_BAG_L1  -39.717239       0.618629   12.935794                0.618629          12.935794            1       True          5
11   KNeighborsDist_BAG_L1 -109.845172       0.194041    0.043512                0.194041           0.043512            1       True          2
12   KNeighborsUnif_BAG_L1 -113.261643       0.197715    0.049069                0.197715           0.049069            1       True          1
</code></pre>
</div>
<div class="output execute_result" data-execution_count="55">
<pre><code>&lt;Axes: xlabel=&#39;model&#39;&gt;</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_37271c91d75944799fe9745642b73185/735b47a7f5477a5145e4d6adf8f670898973bda5.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="56"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="Kjh-gTdz7_gM" data-outputId="2e92cea9-9c44-4ac0-cc89-43e26cab42df">
<div class="sourceCode" id="cb80"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>predictions_new_features <span class="op">=</span> predictor_new_features.predict(test)</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>predictions_new_features.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="56">
<pre><code>0    11.827034
1     6.215607
2     5.197810
3     4.290312
4     4.348459
Name: count, dtype: float32</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="57"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="CtDuVQZl8Qs4" data-outputId="2fdd4349-4fe5-45b9-9202-4027c0a791e5">
<div class="sourceCode" id="cb82"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Describe the `predictions_new_features` series to see if there are any negative values</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>predictions_new_features.describe()</span></code></pre></div>
<div class="output execute_result" data-execution_count="57">
<pre><code>count    6493.000000
mean      189.992340
std       174.925934
min         2.173538
25%        44.058907
50%       148.303741
75%       282.466431
max       885.687012
Name: count, dtype: float64</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="58"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="WT2QFSk6886_" data-outputId="b1435cf8-b94f-4aa0-ee6d-17159a540840">
<div class="sourceCode" id="cb84"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># How many negative values do we have?</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Rechecking the predictions in predictions_new_features</span></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>negative_pred_count <span class="op">=</span> predictions_new_features.<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="dv">1</span> <span class="cf">if</span> x<span class="op">&lt;</span><span class="dv">0</span> <span class="cf">else</span> <span class="dv">0</span>)</span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>pred_pos_count <span class="op">=</span> (negative_pred_count<span class="op">==</span><span class="dv">0</span>).<span class="bu">sum</span>()</span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>pred_neg_count <span class="op">=</span> (negative_pred_count<span class="op">==</span><span class="dv">1</span>).<span class="bu">sum</span>()</span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Total predictions                :&quot;</span>, <span class="bu">len</span>(predictions_new_features.index))</span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Total positive prediction values :&quot;</span>, pred_pos_count)</span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Total negative prediction values :&quot;</span>, pred_neg_count)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Total predictions                : 6493
Total positive prediction values : 6493
Total negative prediction values : 0
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="59"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="xEuT0rwHE87n" data-outputId="c4747204-4ddd-443a-b905-d1f8fc853815">
<div class="sourceCode" id="cb86"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remember to set all negative values to zero </span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>predictions_new_features[predictions_new_features<span class="op">&lt;</span><span class="dv">0</span>] <span class="op">=</span> <span class="dv">0</span>    <span class="co"># (In case, if negative values exist in the predictions_new_features, set them to 0)</span></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Rechecking, if no predictions are less than 0</span></span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>negative_pred_count <span class="op">=</span> predictions_new_features.<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="dv">1</span> <span class="cf">if</span> x<span class="op">&lt;</span><span class="dv">0</span> <span class="cf">else</span> <span class="dv">0</span>)</span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>pred_neg_count <span class="op">=</span> (negative_pred_count<span class="op">==</span><span class="dv">1</span>).<span class="bu">sum</span>()</span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;No. of negative predictions: </span><span class="sc">{</span>pred_neg_count<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;All negative values in the predictions (if any) are set to zero successfully.&quot;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>No. of negative predictions: 0
All negative values in the predictions (if any) are set to zero successfully.
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="60"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:206}"
id="WDBSUhOlE87o" data-outputId="e1b6a417-7434-4f45-faeb-dce6db18b337">
<div class="sourceCode" id="cb88"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Same thing as train and test dataset</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>submission_new_features <span class="op">=</span> pd.read_csv(<span class="st">&#39;sampleSubmission.csv&#39;</span>, parse_dates <span class="op">=</span> [<span class="st">&#39;datetime&#39;</span>])</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>submission_new_features.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="60">

  <div id="df-e1eb0bf5-02f6-4e5c-9553-1acd7fc4bdcf">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>datetime</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2011-01-20 00:00:00</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2011-01-20 01:00:00</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2011-01-20 02:00:00</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2011-01-20 03:00:00</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2011-01-20 04:00:00</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-e1eb0bf5-02f6-4e5c-9553-1acd7fc4bdcf')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-e1eb0bf5-02f6-4e5c-9553-1acd7fc4bdcf button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-e1eb0bf5-02f6-4e5c-9553-1acd7fc4bdcf');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell code" data-execution_count="62"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:206}"
id="3UbV9eVh9UcQ" data-outputId="ffe25908-b525-4eb1-a8c3-575fea5ff9e1">
<div class="sourceCode" id="cb89"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Same submitting predictions</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>submission_new_features[<span class="st">&quot;count&quot;</span>] <span class="op">=</span> predictions_new_features</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>submission_new_features.to_csv(<span class="st">&quot;submission_new_features.csv&quot;</span>, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>submission_new_features.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="62">

  <div id="df-0a82fad4-d14e-4376-b3dd-82b154f88d3d">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>datetime</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2011-01-20 00:00:00</td>
      <td>11.827034</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2011-01-20 01:00:00</td>
      <td>6.215607</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2011-01-20 02:00:00</td>
      <td>5.197810</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2011-01-20 03:00:00</td>
      <td>4.290312</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2011-01-20 04:00:00</td>
      <td>4.348459</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-0a82fad4-d14e-4376-b3dd-82b154f88d3d')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-0a82fad4-d14e-4376-b3dd-82b154f88d3d button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-0a82fad4-d14e-4376-b3dd-82b154f88d3d');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell code" data-execution_count="63"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="_sNJf7zuE87o" data-outputId="ac604259-6a8d-459d-a321-f92f47cfdf79">
<div class="sourceCode" id="cb90"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>kaggle competitions submit <span class="op">-</span>c bike<span class="op">-</span>sharing<span class="op">-</span>demand <span class="op">-</span>f submission_new_features.csv <span class="op">-</span>m <span class="st">&quot;new features&quot;</span></span></code></pre></div>
<div class="output stream stdout">
<pre><code>  0% 0.00/188k [00:00&lt;?, ?B/s]100% 188k/188k [00:00&lt;00:00, 1.02MB/s]
Successfully submitted to Bike Sharing Demand</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="65"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="mhooijwkE87o" data-outputId="1ff7d45a-e1eb-4d43-a41c-edfe0dbe5a96">
<div class="sourceCode" id="cb92"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>kaggle competitions submissions <span class="op">-</span>c bike<span class="op">-</span>sharing<span class="op">-</span>demand <span class="op">|</span> tail <span class="op">-</span>n <span class="op">+</span><span class="dv">1</span> <span class="op">|</span> head <span class="op">-</span>n <span class="dv">6</span></span></code></pre></div>
<div class="output stream stdout">
<pre><code>fileName                     date                 description           status    publicScore  privateScore  
---------------------------  -------------------  --------------------  --------  -----------  ------------  
submission_new_features.csv  2023-05-28 10:44:54  new features          complete  0.44956      0.44956       
submission.csv               2023-05-28 09:38:25  first raw submission  complete  1.80520      1.80520       
submission.csv               2023-05-28 08:50:43  first raw submission  complete  1.80552      1.80552       
</code></pre>
</div>
</div>
<section id="new-score-of-044956" class="cell markdown"
id="pvwopnnbE87p">
<h4>New Score of <code>0.44956</code></h4>
</section>
<div class="cell code" id="mS4toC7u9_F3">
<div class="sourceCode" id="cb94"><pre
class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
<section id="step-6-hyper-parameter-optimization" class="cell markdown"
id="28mv2R6wE87p">
<h2>Step 6: Hyper parameter optimization</h2>
<ul>
<li>There are many options for hyper parameter optimization.</li>
<li>Options are to change the AutoGluon higher level parameters or the
individual model hyperparameters.</li>
<li>The hyperparameters of the models themselves that are in AutoGluon.
Those need the <code>hyperparameter</code> and
<code>hyperparameter_tune_kwargs</code> arguments.</li>
</ul>
</section>
<div class="cell code" data-execution_count="66" id="LTXYGvTN-DPc">
<div class="sourceCode" id="cb95"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Requirements: (Same settings as initial run) For AutoGluon&#39;s Tabular Predictions</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>eval_metric <span class="op">=</span> <span class="st">&#39;root_mean_squared_error&#39;</span> </span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>label <span class="op">=</span> <span class="st">&#39;count&#39;</span></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>ignored_columns <span class="op">=</span> [<span class="st">&quot;casual&quot;</span>, <span class="st">&quot;registered&quot;</span>]   <span class="co"># Ignored columns while training</span></span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>train_data <span class="op">=</span> train                           <span class="co"># &#39;casual&#39; and &#39;registered&#39; columns are already dropped/ignored</span></span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>time_limit <span class="op">=</span> <span class="dv">600</span>                             <span class="co"># 10 minutes -&gt; 60*10 = 600 seconds</span></span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>presets <span class="op">=</span> <span class="st">&quot;optimize_for_deployment&quot;</span>                             </span></code></pre></div>
</div>
<div class="cell code" data-execution_count="67"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:1000,&quot;referenced_widgets&quot;:[&quot;a1b4ba9e7b88457d9a56f4abf76605cd&quot;,&quot;9f6cf2d39a164b3294787a85e6e9c946&quot;,&quot;32089fc3b4494ec28ae93802f76bd8c4&quot;,&quot;6e742f48df24474c8df672fd3af98945&quot;,&quot;340a4034e34246a89d1a11fd2bcf03e6&quot;,&quot;c71cc25bf7ee47e483863629f13f3a93&quot;,&quot;19e8b30cee604b398076f137d0fe8af1&quot;,&quot;a0b8aa7b42a448118b46c2d09ffb90d3&quot;,&quot;23e7de95368a4d719fdae1920cdc88d8&quot;,&quot;c7e18e00db014bb2a0b4f1c55bc6a37e&quot;,&quot;281106b2b2dc4dbda12c7accb405ce5d&quot;,&quot;4f22730d14724d2889a7d8495b6a5602&quot;,&quot;9325d1c6d578460581be794400e29da3&quot;,&quot;5bb58db79a26433a8271a2ae019640ff&quot;,&quot;028cf1d8d2d2420497c86d887f1025fa&quot;,&quot;4475ff13c23a46d78ecf5eb7ea76e490&quot;,&quot;3032a2b9d36b4ccd8ae7f28e6b81260d&quot;,&quot;2a273ee00d92414f93163de547d2cfd5&quot;,&quot;a0c28963da63483894ad4484aff7d67a&quot;,&quot;0ad1c8c36b1c4dbaa5487a6ff792c7bd&quot;,&quot;fecd2b5e8b6e4d6ca76103368ecf6d10&quot;,&quot;a4a4c52719814e3fbf97efe8be3ad2d0&quot;]}"
id="jGqmKOVJ-KPL" data-outputId="08d7279a-a07b-4dfe-8f1d-4e166b845fbd">
<div class="sourceCode" id="cb96"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> autogluon.core <span class="im">as</span> ag</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="co">## From autogluon documentation</span></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>nn_options <span class="op">=</span> {<span class="st">&#39;num_epochs&#39;</span>: <span class="dv">5</span>, </span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>              <span class="st">&#39;learning_rate&#39;</span>: ag.space.Real(<span class="fl">1e-4</span>, <span class="fl">1e-2</span>, default<span class="op">=</span><span class="fl">5e-4</span>, log<span class="op">=</span><span class="va">True</span>),  </span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># learning rate used in training (real-valued hyperparameter searched on log-scale)</span></span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a>              <span class="st">&#39;activation&#39;</span>: ag.space.Categorical(<span class="st">&#39;relu&#39;</span>, <span class="st">&#39;softrelu&#39;</span>, <span class="st">&#39;tanh&#39;</span>),  </span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># activation function used in NN (categorical hyperparameter, default = first entry)</span></span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a>              <span class="st">&#39;dropout_prob&#39;</span>: ag.space.Real(<span class="fl">0.0</span>, <span class="fl">0.5</span>, default<span class="op">=</span><span class="fl">0.1</span>)}</span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a>gbm_options <span class="op">=</span> [{<span class="st">&#39;extra_trees&#39;</span>: <span class="va">True</span>, </span>
<span id="cb96-12"><a href="#cb96-12" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;num_boost_round&#39;</span>: ag.space.Int(lower<span class="op">=</span><span class="dv">100</span>, upper<span class="op">=</span><span class="dv">500</span>, default<span class="op">=</span><span class="dv">100</span>),</span>
<span id="cb96-13"><a href="#cb96-13" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;num_leaves&#39;</span>: ag.space.Int(lower<span class="op">=</span><span class="dv">25</span>, upper<span class="op">=</span><span class="dv">64</span>, default<span class="op">=</span><span class="dv">36</span>),</span>
<span id="cb96-14"><a href="#cb96-14" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;ag_args&#39;</span>: {<span class="st">&#39;name_suffix&#39;</span>: <span class="st">&#39;XT&#39;</span>}}, {}, <span class="st">&#39;GBMLarge&#39;</span>]</span>
<span id="cb96-15"><a href="#cb96-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-16"><a href="#cb96-16" aria-hidden="true" tabindex="-1"></a>hyperparameters <span class="op">=</span> {  <span class="co"># hyperparameters of each model type</span></span>
<span id="cb96-17"><a href="#cb96-17" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&#39;GBM&#39;</span>: gbm_options,</span>
<span id="cb96-18"><a href="#cb96-18" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&#39;NN_TORCH&#39;</span>: nn_options, </span>
<span id="cb96-19"><a href="#cb96-19" aria-hidden="true" tabindex="-1"></a>                  }  </span>
<span id="cb96-20"><a href="#cb96-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-21"><a href="#cb96-21" aria-hidden="true" tabindex="-1"></a>num_trials <span class="op">=</span> <span class="dv">20</span>            <span class="co"># Number of hyperparameter optimization trials you want to perform</span></span>
<span id="cb96-22"><a href="#cb96-22" aria-hidden="true" tabindex="-1"></a>search_strategy <span class="op">=</span> <span class="st">&#39;auto&#39;</span>  <span class="co"># tune hyperparameters using Bayesian optimization routine with a local scheduler</span></span>
<span id="cb96-23"><a href="#cb96-23" aria-hidden="true" tabindex="-1"></a>scheduler <span class="op">=</span> <span class="st">&#39;local&#39;</span>       <span class="co"># Local FIFO scheduler</span></span>
<span id="cb96-24"><a href="#cb96-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-25"><a href="#cb96-25" aria-hidden="true" tabindex="-1"></a>hyperparameter_tune_kwargs <span class="op">=</span> { </span>
<span id="cb96-26"><a href="#cb96-26" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;num_trials&#39;</span>: num_trials,</span>
<span id="cb96-27"><a href="#cb96-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;scheduler&#39;</span> : scheduler,</span>
<span id="cb96-28"><a href="#cb96-28" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;searcher&#39;</span>: search_strategy,</span>
<span id="cb96-29"><a href="#cb96-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb96-30"><a href="#cb96-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-31"><a href="#cb96-31" aria-hidden="true" tabindex="-1"></a>predictor_new_hpo <span class="op">=</span> TabularPredictor(label<span class="op">=</span><span class="st">&#39;count&#39;</span>, problem_type<span class="op">=</span><span class="st">&#39;regression&#39;</span>, eval_metric<span class="op">=</span><span class="st">&#39;root_mean_squared_error&#39;</span>,</span>
<span id="cb96-32"><a href="#cb96-32" aria-hidden="true" tabindex="-1"></a>                                    learner_kwargs<span class="op">=</span>{<span class="st">&#39;ignored_columns&#39;</span>: ignored_columns}).fit(</span>
<span id="cb96-33"><a href="#cb96-33" aria-hidden="true" tabindex="-1"></a>                                                                         train_data<span class="op">=</span>train, </span>
<span id="cb96-34"><a href="#cb96-34" aria-hidden="true" tabindex="-1"></a>                                                                         time_limit<span class="op">=</span>time_limit,</span>
<span id="cb96-35"><a href="#cb96-35" aria-hidden="true" tabindex="-1"></a>                                                                         presets<span class="op">=</span>presets, </span>
<span id="cb96-36"><a href="#cb96-36" aria-hidden="true" tabindex="-1"></a>                                                                         hyperparameters<span class="op">=</span>hyperparameters, </span>
<span id="cb96-37"><a href="#cb96-37" aria-hidden="true" tabindex="-1"></a>                                                                         hyperparameter_tune_kwargs<span class="op">=</span>hyperparameter_tune_kwargs,</span>
<span id="cb96-38"><a href="#cb96-38" aria-hidden="true" tabindex="-1"></a>                                                                         refit_full<span class="op">=</span><span class="st">&#39;best&#39;</span>)</span></code></pre></div>
<div class="output display_data">

</div>
<div class="output stream stderr">
<pre><code>Fitted model: NeuralNetTorch/f6367f2c ...
	-115.3105	 = Validation score   (-root_mean_squared_error)
	6.77s	 = Training   runtime
	0.03s	 = Validation runtime
Fitted model: NeuralNetTorch/68146a22 ...
	-141.5096	 = Validation score   (-root_mean_squared_error)
	8.74s	 = Training   runtime
	0.07s	 = Validation runtime
Fitted model: NeuralNetTorch/7158da8b ...
	-146.1483	 = Validation score   (-root_mean_squared_error)
	7.57s	 = Training   runtime
	0.07s	 = Validation runtime
Fitted model: NeuralNetTorch/e6298ce5 ...
	-150.789	 = Validation score   (-root_mean_squared_error)
	20.22s	 = Training   runtime
	0.14s	 = Validation runtime
Fitted model: NeuralNetTorch/cea582b0 ...
	-142.9665	 = Validation score   (-root_mean_squared_error)
	6.37s	 = Training   runtime
	0.06s	 = Validation runtime
Fitted model: NeuralNetTorch/d57dd54a ...
	-106.6744	 = Validation score   (-root_mean_squared_error)
	5.01s	 = Training   runtime
	0.04s	 = Validation runtime
Fitted model: NeuralNetTorch/cb0b0369 ...
	-63.8251	 = Validation score   (-root_mean_squared_error)
	7.52s	 = Training   runtime
	0.14s	 = Validation runtime
Fitted model: NeuralNetTorch/510a8f71 ...
	-89.7244	 = Validation score   (-root_mean_squared_error)
	8.94s	 = Training   runtime
	0.09s	 = Validation runtime
Fitted model: NeuralNetTorch/53894f56 ...
	-87.2415	 = Validation score   (-root_mean_squared_error)
	24.93s	 = Training   runtime
	0.32s	 = Validation runtime
Fitted model: NeuralNetTorch/b8fd56b2 ...
	-84.5977	 = Validation score   (-root_mean_squared_error)
	8.16s	 = Training   runtime
	0.05s	 = Validation runtime
Fitted model: NeuralNetTorch/f8bb9c37 ...
	-87.982	 = Validation score   (-root_mean_squared_error)
	16.43s	 = Training   runtime
	0.23s	 = Validation runtime
Fitted model: NeuralNetTorch/cd4e9819 ...
	-141.1039	 = Validation score   (-root_mean_squared_error)
	13.96s	 = Training   runtime
	0.07s	 = Validation runtime
Fitted model: NeuralNetTorch/4c75b6bd ...
	-142.7185	 = Validation score   (-root_mean_squared_error)
	5.1s	 = Training   runtime
	0.06s	 = Validation runtime
Fitted model: NeuralNetTorch/c743df40 ...
	-100.0327	 = Validation score   (-root_mean_squared_error)
	6.67s	 = Training   runtime
	0.06s	 = Validation runtime
Fitted model: NeuralNetTorch/c631557f ...
	-65.8492	 = Validation score   (-root_mean_squared_error)
	3.84s	 = Training   runtime
	0.04s	 = Validation runtime
Fitted model: NeuralNetTorch/dbc5ec80 ...
	-144.5202	 = Validation score   (-root_mean_squared_error)
	5.1s	 = Training   runtime
	0.04s	 = Validation runtime
Fitted model: NeuralNetTorch/bfb55fa1 ...
	-78.7963	 = Validation score   (-root_mean_squared_error)
	2.73s	 = Training   runtime
	0.03s	 = Validation runtime
Fitted model: NeuralNetTorch/b6238d52 ...
	-87.7456	 = Validation score   (-root_mean_squared_error)
	13.5s	 = Training   runtime
	0.14s	 = Validation runtime
Fitted model: NeuralNetTorch/f463f2a1 ...
	-136.2779	 = Validation score   (-root_mean_squared_error)
	15.47s	 = Training   runtime
	0.07s	 = Validation runtime
Fitted model: NeuralNetTorch/091cb07e ...
	-292.9212	 = Validation score   (-root_mean_squared_error)
	8.22s	 = Training   runtime
	0.05s	 = Validation runtime
Fitting model: LightGBMLarge ... Training model for up to 134.91s of the 316.31s of remaining time.
	-38.5164	 = Validation score   (-root_mean_squared_error)
	7.02s	 = Training   runtime
	0.69s	 = Validation runtime
Fitting model: WeightedEnsemble_L2 ... Training model for up to 360.0s of the 278.84s of remaining time.
	-37.6222	 = Validation score   (-root_mean_squared_error)
	0.76s	 = Training   runtime
	0.0s	 = Validation runtime
AutoGluon training complete, total runtime = 322.0s ... Best model: &quot;WeightedEnsemble_L2&quot;
Automatically performing refit_full as a post-fit operation (due to `.fit(..., refit_full=True)`
Refitting models via `predictor.refit_full` using all of the data (combined train and validation)...
	Models trained in this way will have the suffix &quot;_FULL&quot; and have NaN validation score.
	This process is not bound by time_limit, but should take less time than the original `predictor.fit` call.
	To learn more, refer to the `.refit_full` method docstring which explains how &quot;_FULL&quot; models differ from normal models.
Fitting 1 L1 models ...
Fitting model: LightGBM/T4_FULL ...
	10.42s	 = Training   runtime
Fitting 1 L1 models ...
Fitting model: LightGBM/T12_FULL ...
	13.47s	 = Training   runtime
Fitting 1 L1 models ...
Fitting model: LightGBM/T13_FULL ...
	4.22s	 = Training   runtime
Fitting 1 L1 models ...
Fitting model: NeuralNetTorch/cb0b0369_FULL ...
	5.59s	 = Training   runtime
Fitting 1 L1 models ...
Fitting model: LightGBMLarge_FULL ...
	3.88s	 = Training   runtime
Fitting model: WeightedEnsemble_L2_FULL | Skipping fit via cloning parent ...
	0.76s	 = Training   runtime
Refit complete, total runtime = 54.21s
Deleting model LightGBMXT/T1. All files under /content/AutogluonModels/ag-20230528_104827/models/LightGBMXT/T1/ will be removed.
Deleting model LightGBMXT/T2. All files under /content/AutogluonModels/ag-20230528_104827/models/LightGBMXT/T2/ will be removed.
Deleting model LightGBMXT/T3. All files under /content/AutogluonModels/ag-20230528_104827/models/LightGBMXT/T3/ will be removed.
Deleting model LightGBMXT/T4. All files under /content/AutogluonModels/ag-20230528_104827/models/LightGBMXT/T4/ will be removed.
Deleting model LightGBMXT/T5. All files under /content/AutogluonModels/ag-20230528_104827/models/LightGBMXT/T5/ will be removed.
Deleting model LightGBMXT/T6. All files under /content/AutogluonModels/ag-20230528_104827/models/LightGBMXT/T6/ will be removed.
Deleting model LightGBMXT/T7. All files under /content/AutogluonModels/ag-20230528_104827/models/LightGBMXT/T7/ will be removed.
Deleting model LightGBMXT/T8. All files under /content/AutogluonModels/ag-20230528_104827/models/LightGBMXT/T8/ will be removed.
Deleting model LightGBMXT/T9. All files under /content/AutogluonModels/ag-20230528_104827/models/LightGBMXT/T9/ will be removed.
Deleting model LightGBMXT/T10. All files under /content/AutogluonModels/ag-20230528_104827/models/LightGBMXT/T10/ will be removed.
Deleting model LightGBMXT/T11. All files under /content/AutogluonModels/ag-20230528_104827/models/LightGBMXT/T11/ will be removed.
Deleting model LightGBMXT/T12. All files under /content/AutogluonModels/ag-20230528_104827/models/LightGBMXT/T12/ will be removed.
Deleting model LightGBMXT/T13. All files under /content/AutogluonModels/ag-20230528_104827/models/LightGBMXT/T13/ will be removed.
Deleting model LightGBMXT/T14. All files under /content/AutogluonModels/ag-20230528_104827/models/LightGBMXT/T14/ will be removed.
Deleting model LightGBMXT/T15. All files under /content/AutogluonModels/ag-20230528_104827/models/LightGBMXT/T15/ will be removed.
Deleting model LightGBMXT/T16. All files under /content/AutogluonModels/ag-20230528_104827/models/LightGBMXT/T16/ will be removed.
Deleting model LightGBMXT/T17. All files under /content/AutogluonModels/ag-20230528_104827/models/LightGBMXT/T17/ will be removed.
Deleting model LightGBMXT/T18. All files under /content/AutogluonModels/ag-20230528_104827/models/LightGBMXT/T18/ will be removed.
Deleting model LightGBMXT/T19. All files under /content/AutogluonModels/ag-20230528_104827/models/LightGBMXT/T19/ will be removed.
Deleting model LightGBMXT/T20. All files under /content/AutogluonModels/ag-20230528_104827/models/LightGBMXT/T20/ will be removed.
Deleting model LightGBM/T1. All files under /content/AutogluonModels/ag-20230528_104827/models/LightGBM/T1/ will be removed.
Deleting model LightGBM/T2. All files under /content/AutogluonModels/ag-20230528_104827/models/LightGBM/T2/ will be removed.
Deleting model LightGBM/T3. All files under /content/AutogluonModels/ag-20230528_104827/models/LightGBM/T3/ will be removed.
Deleting model LightGBM/T5. All files under /content/AutogluonModels/ag-20230528_104827/models/LightGBM/T5/ will be removed.
Deleting model LightGBM/T6. All files under /content/AutogluonModels/ag-20230528_104827/models/LightGBM/T6/ will be removed.
Deleting model LightGBM/T7. All files under /content/AutogluonModels/ag-20230528_104827/models/LightGBM/T7/ will be removed.
Deleting model LightGBM/T8. All files under /content/AutogluonModels/ag-20230528_104827/models/LightGBM/T8/ will be removed.
Deleting model LightGBM/T9. All files under /content/AutogluonModels/ag-20230528_104827/models/LightGBM/T9/ will be removed.
Deleting model LightGBM/T10. All files under /content/AutogluonModels/ag-20230528_104827/models/LightGBM/T10/ will be removed.
Deleting model LightGBM/T11. All files under /content/AutogluonModels/ag-20230528_104827/models/LightGBM/T11/ will be removed.
Deleting model LightGBM/T14. All files under /content/AutogluonModels/ag-20230528_104827/models/LightGBM/T14/ will be removed.
Deleting model LightGBM/T15. All files under /content/AutogluonModels/ag-20230528_104827/models/LightGBM/T15/ will be removed.
Deleting model NeuralNetTorch/f6367f2c. All files under /content/AutogluonModels/ag-20230528_104827/models/NeuralNetTorch/f6367f2c/ will be removed.
Deleting model NeuralNetTorch/68146a22. All files under /content/AutogluonModels/ag-20230528_104827/models/NeuralNetTorch/68146a22/ will be removed.
Deleting model NeuralNetTorch/7158da8b. All files under /content/AutogluonModels/ag-20230528_104827/models/NeuralNetTorch/7158da8b/ will be removed.
Deleting model NeuralNetTorch/e6298ce5. All files under /content/AutogluonModels/ag-20230528_104827/models/NeuralNetTorch/e6298ce5/ will be removed.
Deleting model NeuralNetTorch/cea582b0. All files under /content/AutogluonModels/ag-20230528_104827/models/NeuralNetTorch/cea582b0/ will be removed.
Deleting model NeuralNetTorch/d57dd54a. All files under /content/AutogluonModels/ag-20230528_104827/models/NeuralNetTorch/d57dd54a/ will be removed.
Deleting model NeuralNetTorch/510a8f71. All files under /content/AutogluonModels/ag-20230528_104827/models/NeuralNetTorch/510a8f71/ will be removed.
Deleting model NeuralNetTorch/53894f56. All files under /content/AutogluonModels/ag-20230528_104827/models/NeuralNetTorch/53894f56/ will be removed.
Deleting model NeuralNetTorch/b8fd56b2. All files under /content/AutogluonModels/ag-20230528_104827/models/NeuralNetTorch/b8fd56b2/ will be removed.
Deleting model NeuralNetTorch/f8bb9c37. All files under /content/AutogluonModels/ag-20230528_104827/models/NeuralNetTorch/f8bb9c37/ will be removed.
Deleting model NeuralNetTorch/cd4e9819. All files under /content/AutogluonModels/ag-20230528_104827/models/NeuralNetTorch/cd4e9819/ will be removed.
Deleting model NeuralNetTorch/4c75b6bd. All files under /content/AutogluonModels/ag-20230528_104827/models/NeuralNetTorch/4c75b6bd/ will be removed.
Deleting model NeuralNetTorch/c743df40. All files under /content/AutogluonModels/ag-20230528_104827/models/NeuralNetTorch/c743df40/ will be removed.
Deleting model NeuralNetTorch/c631557f. All files under /content/AutogluonModels/ag-20230528_104827/models/NeuralNetTorch/c631557f/ will be removed.
Deleting model NeuralNetTorch/dbc5ec80. All files under /content/AutogluonModels/ag-20230528_104827/models/NeuralNetTorch/dbc5ec80/ will be removed.
Deleting model NeuralNetTorch/bfb55fa1. All files under /content/AutogluonModels/ag-20230528_104827/models/NeuralNetTorch/bfb55fa1/ will be removed.
Deleting model NeuralNetTorch/b6238d52. All files under /content/AutogluonModels/ag-20230528_104827/models/NeuralNetTorch/b6238d52/ will be removed.
Deleting model NeuralNetTorch/f463f2a1. All files under /content/AutogluonModels/ag-20230528_104827/models/NeuralNetTorch/f463f2a1/ will be removed.
Deleting model NeuralNetTorch/091cb07e. All files under /content/AutogluonModels/ag-20230528_104827/models/NeuralNetTorch/091cb07e/ will be removed.
Deleting model LightGBM/T4_FULL. All files under /content/AutogluonModels/ag-20230528_104827/models/LightGBM/T4_FULL/ will be removed.
Deleting model LightGBM/T12_FULL. All files under /content/AutogluonModels/ag-20230528_104827/models/LightGBM/T12_FULL/ will be removed.
Deleting model LightGBM/T13_FULL. All files under /content/AutogluonModels/ag-20230528_104827/models/LightGBM/T13_FULL/ will be removed.
Deleting model NeuralNetTorch/cb0b0369_FULL. All files under /content/AutogluonModels/ag-20230528_104827/models/NeuralNetTorch/cb0b0369_FULL/ will be removed.
Deleting model LightGBMLarge_FULL. All files under AutogluonModels/ag-20230528_104827/models/LightGBMLarge_FULL/ will be removed.
Deleting model WeightedEnsemble_L2_FULL. All files under AutogluonModels/ag-20230528_104827/models/WeightedEnsemble_L2_FULL/ will be removed.
TabularPredictor saved. To load, use: predictor = TabularPredictor.load(&quot;AutogluonModels/ag-20230528_104827/&quot;)
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="68"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="Pt8IvrhnBI_z" data-outputId="a7708c70-5a14-44cb-ec7e-0b353481724c">
<div class="sourceCode" id="cb98"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>predictor_new_hpo.fit_summary()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>*** Summary of fit() ***
Estimated performance of each model:
                     model  score_val  pred_time_val   fit_time  pred_time_val_marginal  fit_time_marginal  stack_level  can_infer  fit_order
0      WeightedEnsemble_L2 -37.622232       7.672721  53.668308                0.001290           0.755413            2       True          6
1              LightGBM/T4 -38.124006       3.226732  15.737828                3.226732          15.737828            1       True          1
2             LightGBM/T13 -38.369670       1.207577   9.069551                1.207577           9.069551            1       True          3
3             LightGBM/T12 -38.431862       2.405685  13.558131                2.405685          13.558131            1       True          2
4            LightGBMLarge -38.516436       0.694972   7.023361                0.694972           7.023361            1       True          5
5  NeuralNetTorch/cb0b0369 -63.825104       0.136465   7.524023                0.136465           7.524023            1       True          4
Number of models trained: 6
Types of models trained:
{&#39;WeightedEnsembleModel&#39;, &#39;TabularNeuralNetTorchModel&#39;, &#39;LGBModel&#39;}
Bagging used: False 
Multi-layer stack-ensembling used: False 
Feature Metadata (Processed):
(raw dtype, special dtypes):
(&#39;category&#39;, [])  : 3 | [&#39;season&#39;, &#39;weather&#39;, &#39;day_type&#39;]
(&#39;float&#39;, [])     : 2 | [&#39;temp&#39;, &#39;windspeed&#39;]
(&#39;int&#39;, [])       : 4 | [&#39;humidity&#39;, &#39;month&#39;, &#39;day&#39;, &#39;hour&#39;]
(&#39;int&#39;, [&#39;bool&#39;]) : 3 | [&#39;holiday&#39;, &#39;workingday&#39;, &#39;year&#39;]
*** End of fit() summary ***
</code></pre>
</div>
<div class="output stream stderr">
<pre><code>/usr/local/lib/python3.10/dist-packages/autogluon/core/utils/plots.py:138: UserWarning: AutoGluon summary plots cannot be created because bokeh is not installed. To see plots, please do: &quot;pip install bokeh==2.0.1&quot;
  warnings.warn(&#39;AutoGluon summary plots cannot be created because bokeh is not installed. To see plots, please do: &quot;pip install bokeh==2.0.1&quot;&#39;)
</code></pre>
</div>
<div class="output execute_result" data-execution_count="68">
<pre><code>{&#39;model_types&#39;: {&#39;LightGBM/T4&#39;: &#39;LGBModel&#39;,
  &#39;LightGBM/T12&#39;: &#39;LGBModel&#39;,
  &#39;LightGBM/T13&#39;: &#39;LGBModel&#39;,
  &#39;NeuralNetTorch/cb0b0369&#39;: &#39;TabularNeuralNetTorchModel&#39;,
  &#39;LightGBMLarge&#39;: &#39;LGBModel&#39;,
  &#39;WeightedEnsemble_L2&#39;: &#39;WeightedEnsembleModel&#39;},
 &#39;model_performance&#39;: {&#39;LightGBM/T4&#39;: -38.12400606130618,
  &#39;LightGBM/T12&#39;: -38.431861570431245,
  &#39;LightGBM/T13&#39;: -38.3696701247306,
  &#39;NeuralNetTorch/cb0b0369&#39;: -63.825103906026925,
  &#39;LightGBMLarge&#39;: -38.51643622165731,
  &#39;WeightedEnsemble_L2&#39;: -37.62223205964976},
 &#39;model_best&#39;: &#39;WeightedEnsemble_L2&#39;,
 &#39;model_paths&#39;: {&#39;LightGBM/T4&#39;: &#39;/content/AutogluonModels/ag-20230528_104827/models/LightGBM/T4/&#39;,
  &#39;LightGBM/T12&#39;: &#39;/content/AutogluonModels/ag-20230528_104827/models/LightGBM/T12/&#39;,
  &#39;LightGBM/T13&#39;: &#39;/content/AutogluonModels/ag-20230528_104827/models/LightGBM/T13/&#39;,
  &#39;NeuralNetTorch/cb0b0369&#39;: &#39;/content/AutogluonModels/ag-20230528_104827/models/NeuralNetTorch/cb0b0369/&#39;,
  &#39;LightGBMLarge&#39;: &#39;AutogluonModels/ag-20230528_104827/models/LightGBMLarge/&#39;,
  &#39;WeightedEnsemble_L2&#39;: &#39;AutogluonModels/ag-20230528_104827/models/WeightedEnsemble_L2/&#39;},
 &#39;model_fit_times&#39;: {&#39;LightGBM/T4&#39;: 15.737828254699707,
  &#39;LightGBM/T12&#39;: 13.558130979537964,
  &#39;LightGBM/T13&#39;: 9.069551229476929,
  &#39;NeuralNetTorch/cb0b0369&#39;: 7.5240232944488525,
  &#39;LightGBMLarge&#39;: 7.0233612060546875,
  &#39;WeightedEnsemble_L2&#39;: 0.7554125785827637},
 &#39;model_pred_times&#39;: {&#39;LightGBM/T4&#39;: 3.226731777191162,
  &#39;LightGBM/T12&#39;: 2.40568470954895,
  &#39;LightGBM/T13&#39;: 1.2075772285461426,
  &#39;NeuralNetTorch/cb0b0369&#39;: 0.13646507263183594,
  &#39;LightGBMLarge&#39;: 0.6949715614318848,
  &#39;WeightedEnsemble_L2&#39;: 0.0012903213500976562},
 &#39;num_bag_folds&#39;: 0,
 &#39;max_stack_level&#39;: 2,
 &#39;model_hyperparams&#39;: {&#39;LightGBM/T4&#39;: {&#39;learning_rate&#39;: 0.006163502781172814,
   &#39;feature_fraction&#39;: 0.824383651636118,
   &#39;min_data_in_leaf&#39;: 14,
   &#39;num_leaves&#39;: 74},
  &#39;LightGBM/T12&#39;: {&#39;learning_rate&#39;: 0.008233749120302263,
   &#39;feature_fraction&#39;: 0.804137588606093,
   &#39;min_data_in_leaf&#39;: 38,
   &#39;num_leaves&#39;: 69},
  &#39;LightGBM/T13&#39;: {&#39;learning_rate&#39;: 0.011353825252123055,
   &#39;feature_fraction&#39;: 0.7874187167959208,
   &#39;min_data_in_leaf&#39;: 19,
   &#39;num_leaves&#39;: 95},
  &#39;NeuralNetTorch/cb0b0369&#39;: {&#39;num_epochs&#39;: 5,
   &#39;epochs_wo_improve&#39;: 20,
   &#39;activation&#39;: &#39;relu&#39;,
   &#39;embedding_size_factor&#39;: 0.6,
   &#39;embed_exponent&#39;: 0.56,
   &#39;max_embedding_dim&#39;: 100,
   &#39;y_range&#39;: None,
   &#39;y_range_extend&#39;: 0.05,
   &#39;dropout_prob&#39;: 0.3292125420189381,
   &#39;optimizer&#39;: &#39;adam&#39;,
   &#39;learning_rate&#39;: 0.002897575755228465,
   &#39;weight_decay&#39;: 2.0139214655902376e-08,
   &#39;proc.embed_min_categories&#39;: 1000,
   &#39;proc.impute_strategy&#39;: &#39;most_frequent&#39;,
   &#39;proc.max_category_levels&#39;: 10,
   &#39;proc.skew_threshold&#39;: 100.0,
   &#39;use_ngram_features&#39;: False,
   &#39;num_layers&#39;: 4,
   &#39;hidden_size&#39;: 256,
   &#39;max_batch_size&#39;: 512,
   &#39;use_batchnorm&#39;: False,
   &#39;loss_function&#39;: &#39;auto&#39;},
  &#39;LightGBMLarge&#39;: {&#39;learning_rate&#39;: 0.03,
   &#39;num_leaves&#39;: 128,
   &#39;feature_fraction&#39;: 0.9,
   &#39;min_data_in_leaf&#39;: 5},
  &#39;WeightedEnsemble_L2&#39;: {&#39;use_orig_features&#39;: False,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True}},
 &#39;leaderboard&#39;:                      model  score_val  pred_time_val   fit_time  \
 0      WeightedEnsemble_L2 -37.622232       7.672721  53.668308   
 1              LightGBM/T4 -38.124006       3.226732  15.737828   
 2             LightGBM/T13 -38.369670       1.207577   9.069551   
 3             LightGBM/T12 -38.431862       2.405685  13.558131   
 4            LightGBMLarge -38.516436       0.694972   7.023361   
 5  NeuralNetTorch/cb0b0369 -63.825104       0.136465   7.524023   
 
    pred_time_val_marginal  fit_time_marginal  stack_level  can_infer  \
 0                0.001290           0.755413            2       True   
 1                3.226732          15.737828            1       True   
 2                1.207577           9.069551            1       True   
 3                2.405685          13.558131            1       True   
 4                0.694972           7.023361            1       True   
 5                0.136465           7.524023            1       True   
 
    fit_order  
 0          6  
 1          1  
 2          3  
 3          2  
 4          5  
 5          4  }</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="72"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:423}"
id="uwArdbcaBkOd" data-outputId="dbdcbe29-6fcf-4f88-cb85-46bd87a8c8cd">
<div class="sourceCode" id="cb102"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>predictor_new_hpo.leaderboard()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>                     model  score_val  pred_time_val   fit_time  pred_time_val_marginal  fit_time_marginal  stack_level  can_infer  fit_order
0      WeightedEnsemble_L2 -37.622232       7.672721  53.668308                0.001290           0.755413            2       True          6
1              LightGBM/T4 -38.124006       3.226732  15.737828                3.226732          15.737828            1       True          1
2             LightGBM/T13 -38.369670       1.207577   9.069551                1.207577           9.069551            1       True          3
3             LightGBM/T12 -38.431862       2.405685  13.558131                2.405685          13.558131            1       True          2
4            LightGBMLarge -38.516436       0.694972   7.023361                0.694972           7.023361            1       True          5
5  NeuralNetTorch/cb0b0369 -63.825104       0.136465   7.524023                0.136465           7.524023            1       True          4
</code></pre>
</div>
<div class="output execute_result" data-execution_count="72">

  <div id="df-b24949ea-bfa2-46d6-8d3f-06d4112299cd">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>model</th>
      <th>score_val</th>
      <th>pred_time_val</th>
      <th>fit_time</th>
      <th>pred_time_val_marginal</th>
      <th>fit_time_marginal</th>
      <th>stack_level</th>
      <th>can_infer</th>
      <th>fit_order</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>WeightedEnsemble_L2</td>
      <td>-37.622232</td>
      <td>7.672721</td>
      <td>53.668308</td>
      <td>0.001290</td>
      <td>0.755413</td>
      <td>2</td>
      <td>True</td>
      <td>6</td>
    </tr>
    <tr>
      <th>1</th>
      <td>LightGBM/T4</td>
      <td>-38.124006</td>
      <td>3.226732</td>
      <td>15.737828</td>
      <td>3.226732</td>
      <td>15.737828</td>
      <td>1</td>
      <td>True</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>LightGBM/T13</td>
      <td>-38.369670</td>
      <td>1.207577</td>
      <td>9.069551</td>
      <td>1.207577</td>
      <td>9.069551</td>
      <td>1</td>
      <td>True</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>LightGBM/T12</td>
      <td>-38.431862</td>
      <td>2.405685</td>
      <td>13.558131</td>
      <td>2.405685</td>
      <td>13.558131</td>
      <td>1</td>
      <td>True</td>
      <td>2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>LightGBMLarge</td>
      <td>-38.516436</td>
      <td>0.694972</td>
      <td>7.023361</td>
      <td>0.694972</td>
      <td>7.023361</td>
      <td>1</td>
      <td>True</td>
      <td>5</td>
    </tr>
    <tr>
      <th>5</th>
      <td>NeuralNetTorch/cb0b0369</td>
      <td>-63.825104</td>
      <td>0.136465</td>
      <td>7.524023</td>
      <td>0.136465</td>
      <td>7.524023</td>
      <td>1</td>
      <td>True</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-b24949ea-bfa2-46d6-8d3f-06d4112299cd')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-b24949ea-bfa2-46d6-8d3f-06d4112299cd button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-b24949ea-bfa2-46d6-8d3f-06d4112299cd');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell code" data-execution_count="73"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:773}"
id="Z4bELEgxB_gI" data-outputId="780c34e6-75dc-428f-ba0e-a79d965283a2">
<div class="sourceCode" id="cb104"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Output the model&#39;s `score_val` in a bar chart to compare performance</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>predictor_new_hpo.leaderboard().plot(kind<span class="op">=</span><span class="st">&quot;bar&quot;</span>, x<span class="op">=</span><span class="st">&quot;model&quot;</span>, y<span class="op">=</span><span class="st">&quot;score_val&quot;</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>))</span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&quot;RMSE Scores&quot;</span>)</span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>                     model  score_val  pred_time_val   fit_time  pred_time_val_marginal  fit_time_marginal  stack_level  can_infer  fit_order
0      WeightedEnsemble_L2 -37.622232       7.672721  53.668308                0.001290           0.755413            2       True          6
1              LightGBM/T4 -38.124006       3.226732  15.737828                3.226732          15.737828            1       True          1
2             LightGBM/T13 -38.369670       1.207577   9.069551                1.207577           9.069551            1       True          3
3             LightGBM/T12 -38.431862       2.405685  13.558131                2.405685          13.558131            1       True          2
4            LightGBMLarge -38.516436       0.694972   7.023361                0.694972           7.023361            1       True          5
5  NeuralNetTorch/cb0b0369 -63.825104       0.136465   7.524023                0.136465           7.524023            1       True          4
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_37271c91d75944799fe9745642b73185/967e5a50bed951df6a239448ee01001588e3b34d.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="74"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="nhA94a6uC3Rg" data-outputId="a6b70bac-7ba5-43c2-e92e-6dab2a3432e7">
<div class="sourceCode" id="cb106"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>predictions_new_hpo <span class="op">=</span> predictor_new_hpo.predict(test)</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>predictions_new_hpo.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="74">
<pre><code>0    17.042290
1     2.736429
2     0.310958
3     0.677150
4     0.697125
Name: count, dtype: float32</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="75"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="ET6WOmSSDFEO" data-outputId="d9bdca38-1fd3-435f-f105-dc9cfc48c14c">
<div class="sourceCode" id="cb108"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Describe the `predictions_new_hpo` series to see if there are any negative values</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>predictions_new_hpo.describe()</span></code></pre></div>
<div class="output execute_result" data-execution_count="75">
<pre><code>count    6493.000000
mean      190.035110
std       173.922516
min       -19.203064
25%        45.833160
50%       147.955322
75%       284.720123
max       931.766479
Name: count, dtype: float64</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="76"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="zNMd3zqoDJ1n" data-outputId="f7cf16d7-ec55-4f90-e675-3b3f874bbd8c">
<div class="sourceCode" id="cb110"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co"># How many negative values do we have?</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Rechecking the predictions in predictions_new_hpo</span></span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>negative_pred_count <span class="op">=</span> predictions_new_hpo.<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="dv">1</span> <span class="cf">if</span> x<span class="op">&lt;</span><span class="dv">0</span> <span class="cf">else</span> <span class="dv">0</span>)</span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a>pred_pos_count <span class="op">=</span> (negative_pred_count<span class="op">==</span><span class="dv">0</span>).<span class="bu">sum</span>()</span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a>pred_neg_count <span class="op">=</span> (negative_pred_count<span class="op">==</span><span class="dv">1</span>).<span class="bu">sum</span>()</span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Total predictions                :&quot;</span>, <span class="bu">len</span>(predictions_new_hpo.index))</span>
<span id="cb110-10"><a href="#cb110-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Total positive prediction values :&quot;</span>, pred_pos_count)</span>
<span id="cb110-11"><a href="#cb110-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Total negative prediction values :&quot;</span>, pred_neg_count)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Total predictions                : 6493
Total positive prediction values : 6412
Total negative prediction values : 81
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="77"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="sk36aEKuE87p" data-outputId="879301f9-1574-4926-a030-870cd6ad0792">
<div class="sourceCode" id="cb112"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remember to set all negative values to zero </span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>predictions_new_hpo[predictions_new_hpo<span class="op">&lt;</span><span class="dv">0</span>] <span class="op">=</span> <span class="dv">0</span>    <span class="co"># (In case, if negative values exist in the predictions_new_hpo, set them to 0)</span></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Rechecking, if no predictions are less than 0</span></span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>negative_pred_count <span class="op">=</span> predictions_new_hpo.<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="dv">1</span> <span class="cf">if</span> x<span class="op">&lt;</span><span class="dv">0</span> <span class="cf">else</span> <span class="dv">0</span>)</span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a>pred_neg_count <span class="op">=</span> (negative_pred_count<span class="op">==</span><span class="dv">1</span>).<span class="bu">sum</span>()</span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;No. of negative predictions: </span><span class="sc">{</span>pred_neg_count<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;All negative values in the predictions (if any) are set to zero successfully.&quot;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>No. of negative predictions: 0
All negative values in the predictions (if any) are set to zero successfully.
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="78"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:206}"
id="rAtUK63iE87q" data-outputId="49071f41-0e2d-4ae0-99d0-3682f85f6e32">
<div class="sourceCode" id="cb114"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Same thing as train and test dataset</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>submission_new_hpo <span class="op">=</span> pd.read_csv(<span class="st">&#39;sampleSubmission.csv&#39;</span>, parse_dates <span class="op">=</span> [<span class="st">&#39;datetime&#39;</span>])</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>submission_new_hpo.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="78">

  <div id="df-68efa08b-7c45-4b6e-9e5e-5d114ab20ca1">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>datetime</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2011-01-20 00:00:00</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2011-01-20 01:00:00</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2011-01-20 02:00:00</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2011-01-20 03:00:00</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2011-01-20 04:00:00</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-68efa08b-7c45-4b6e-9e5e-5d114ab20ca1')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-68efa08b-7c45-4b6e-9e5e-5d114ab20ca1 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-68efa08b-7c45-4b6e-9e5e-5d114ab20ca1');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell code" data-execution_count="79" id="uWuZl0WQDX8m">
<div class="sourceCode" id="cb115"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Same submitting predictions</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>submission_new_hpo[<span class="st">&quot;count&quot;</span>] <span class="op">=</span> predictions_new_hpo</span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>submission_new_hpo.to_csv(<span class="st">&quot;submission_new_hpo.csv&quot;</span>, index<span class="op">=</span><span class="va">False</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="80"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="5A4GGwD_E87q" data-outputId="5e433f0a-ccc4-4d9f-c07f-f6d9e22a2e37">
<div class="sourceCode" id="cb116"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>kaggle competitions submit <span class="op">-</span>c bike<span class="op">-</span>sharing<span class="op">-</span>demand <span class="op">-</span>f submission_new_hpo.csv <span class="op">-</span>m <span class="st">&quot;new features with hyperparameters&quot;</span></span></code></pre></div>
<div class="output stream stdout">
<pre><code>  0% 0.00/188k [00:00&lt;?, ?B/s]100% 188k/188k [00:00&lt;00:00, 885kB/s]
Successfully submitted to Bike Sharing Demand</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="81"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="frs3KGacE87q" data-outputId="3f263003-20eb-483f-ad35-4982c2b35056">
<div class="sourceCode" id="cb118"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>kaggle competitions submissions <span class="op">-</span>c bike<span class="op">-</span>sharing<span class="op">-</span>demand <span class="op">|</span> tail <span class="op">-</span>n <span class="op">+</span><span class="dv">1</span> <span class="op">|</span> head <span class="op">-</span>n <span class="dv">6</span></span></code></pre></div>
<div class="output stream stdout">
<pre><code>fileName                     date                 description                        status    publicScore  privateScore  
---------------------------  -------------------  ---------------------------------  --------  -----------  ------------  
submission_new_hpo.csv       2023-05-28 11:11:02  new features with hyperparameters  complete  0.52785      0.52785       
submission_new_features.csv  2023-05-28 10:44:54  new features                       complete  0.44956      0.44956       
submission.csv               2023-05-28 09:38:25  first raw submission               complete  1.80520      1.80520       
submission.csv               2023-05-28 08:50:43  first raw submission               complete  1.80552      1.80552       
</code></pre>
</div>
</div>
<section id="new-score-of-052785" class="cell markdown"
id="7xIuiQI9E87r">
<h4>New Score of <code>0.52785</code></h4>
</section>
<section id="step-6_a-hyper-parameter-optimization"
class="cell markdown" id="nZaSsgItHdrN">
<h2>Step 6_A: Hyper parameter optimization</h2>
</section>
<div class="cell code" data-execution_count="85" id="YbU3einjH05V">
<div class="sourceCode" id="cb120"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Requirements: (Same settings as initial run) For AutoGluon&#39;s Tabular Predictions</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>eval_metric <span class="op">=</span> <span class="st">&#39;root_mean_squared_error&#39;</span> </span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>label <span class="op">=</span> <span class="st">&#39;count&#39;</span></span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a>ignored_columns <span class="op">=</span> [<span class="st">&quot;casual&quot;</span>, <span class="st">&quot;registered&quot;</span>]   <span class="co"># Ignored columns while training</span></span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a>train_data <span class="op">=</span> train                           <span class="co"># &#39;casual&#39; and &#39;registered&#39; columns are already dropped/ignored</span></span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a>time_limit <span class="op">=</span> <span class="dv">600</span>                             <span class="co"># 10 minutes -&gt; 600 seconds</span></span>
<span id="cb120-7"><a href="#cb120-7" aria-hidden="true" tabindex="-1"></a>presets <span class="op">=</span> <span class="st">&quot;optimize_for_deployment&quot;</span>          <span class="co"># Lighter preset options (faster)</span></span></code></pre></div>
</div>
<div class="cell code" data-execution_count="86"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:1000,&quot;referenced_widgets&quot;:[&quot;7a5f7f3c2db34e118a7fb4786cd91f3f&quot;,&quot;ffe9ae2999d2464bb26396f812c7988b&quot;,&quot;2d5f22b033c9442a84d8bb4b242a46e7&quot;,&quot;4fef0f426b704f61ad5868c6bf5d732f&quot;,&quot;037e9ba8385f4eab91fbe782942d3398&quot;,&quot;d70455aa11204149a27ceea7e632bb00&quot;,&quot;198c9154f63247488bae1687ba3f8c20&quot;,&quot;17a8e23746bc4127b36ad3b977aae9a5&quot;,&quot;1096709486774fde9fcec93add6e4483&quot;,&quot;c28c73f68f86404993f7594ebb9c7783&quot;,&quot;7dd0182a89464dbaa984b768405580c3&quot;,&quot;b6564985c14c4443949ea9da065bc886&quot;,&quot;ce84e3cada3b4e7bbde0b8d6d95bcecb&quot;,&quot;3bd01e110dad4ab9ab46f555a8008eb2&quot;,&quot;6e28382b498c4bc7b048099cc7772941&quot;,&quot;a7bb91cb10c24cdfa69fca6edc5f0ed9&quot;,&quot;114919fe27ad49eabdcbe9bf8a32a2ff&quot;,&quot;4b44ffe732714d119ab98996058b9833&quot;,&quot;06582b61a9e34784846e1fcfe947ad73&quot;,&quot;eae9c58d02ed408fb609bcaf9897d5ec&quot;,&quot;450015ebb4e140959e5ae100080da2e2&quot;,&quot;c5a7fe755fb842b89c5eb791e4f8e34f&quot;,&quot;a4c36909683240f78ce735bab94551a7&quot;,&quot;e0d27d7c9d0142169520ef94d1c1be9b&quot;,&quot;c41531752cf448c0bdd9eff82e5e5edb&quot;,&quot;b32ce2445f894c44ab4ae7ae9153769b&quot;,&quot;b2b731765b6b4bebb0910eb521bef9db&quot;,&quot;39bc98d86fb84ccb82518bc30eea645c&quot;,&quot;d56df02875c249b8bbcf331ad951f512&quot;,&quot;a55387128c2b4a00b9483e49d85538b9&quot;,&quot;82774008b1e3427e950888a79fb5cf76&quot;,&quot;4b4a2f0c40d74b2f8ac3451e84e42029&quot;,&quot;52fa133150f34da3b77f519bacf377a9&quot;]}"
id="wFuIh8qqIB6C" data-outputId="2309cc8c-e87c-4bf6-fc7e-177d20b46748">
<div class="sourceCode" id="cb121"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> autogluon.core <span class="im">as</span> ag</span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a><span class="co">## From autogluon documentation: </span></span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Exclude [&#39;NN_TORCH&#39;] family of models</span></span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a>excluded_model_types <span class="op">=</span> [<span class="st">&#39;NN_TORCH&#39;</span>]</span>
<span id="cb121-6"><a href="#cb121-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-7"><a href="#cb121-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-8"><a href="#cb121-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Considering GBM, XT and XGB model types (as these along with WeightedEnsembles have shown good results)</span></span>
<span id="cb121-9"><a href="#cb121-9" aria-hidden="true" tabindex="-1"></a><span class="co"># For GBM</span></span>
<span id="cb121-10"><a href="#cb121-10" aria-hidden="true" tabindex="-1"></a>gbm_options <span class="op">=</span> [{<span class="st">&#39;extra_trees&#39;</span>: <span class="va">True</span>, </span>
<span id="cb121-11"><a href="#cb121-11" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;num_boost_round&#39;</span>: ag.space.Int(lower<span class="op">=</span><span class="dv">100</span>, upper<span class="op">=</span><span class="dv">800</span>, default<span class="op">=</span><span class="dv">100</span>),</span>
<span id="cb121-12"><a href="#cb121-12" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;num_leaves&#39;</span>: ag.space.Int(lower<span class="op">=</span><span class="dv">26</span>, upper<span class="op">=</span><span class="dv">66</span>, default<span class="op">=</span><span class="dv">36</span>),  <span class="co"># number of leaves in trees (integer hyperparameter)</span></span>
<span id="cb121-13"><a href="#cb121-13" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;ag_args&#39;</span>: {<span class="st">&#39;name_suffix&#39;</span>: <span class="st">&#39;XT&#39;</span>}}, {}, <span class="st">&#39;GBMLarge&#39;</span>]</span>
<span id="cb121-14"><a href="#cb121-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-15"><a href="#cb121-15" aria-hidden="true" tabindex="-1"></a><span class="co"># XT Models</span></span>
<span id="cb121-16"><a href="#cb121-16" aria-hidden="true" tabindex="-1"></a>xt_options <span class="op">=</span> {<span class="st">&#39;criterion&#39;</span>: <span class="st">&#39;squared_error&#39;</span>, <span class="st">&#39;ag_args&#39;</span>: {<span class="st">&#39;name_suffix&#39;</span>: <span class="st">&#39;MSE&#39;</span>, <span class="st">&#39;problem_types&#39;</span>: [<span class="st">&#39;regression&#39;</span>]}}</span>
<span id="cb121-17"><a href="#cb121-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-18"><a href="#cb121-18" aria-hidden="true" tabindex="-1"></a><span class="co"># XGB Models</span></span>
<span id="cb121-19"><a href="#cb121-19" aria-hidden="true" tabindex="-1"></a>xgb_options <span class="op">=</span> [{<span class="st">&#39;objective&#39;</span>: <span class="st">&#39;reg:squarederror&#39;</span>, <span class="co"># &#39;reg:linear&#39; is deprecated</span></span>
<span id="cb121-20"><a href="#cb121-20" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;eval_metric&#39;</span>: <span class="st">&#39;rmse&#39;</span>, </span>
<span id="cb121-21"><a href="#cb121-21" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;max_depth&#39;</span>:ag.space.Int(lower<span class="op">=</span><span class="dv">5</span>, upper<span class="op">=</span><span class="dv">8</span>, default<span class="op">=</span><span class="dv">6</span>), </span>
<span id="cb121-22"><a href="#cb121-22" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;n_estimators&#39;</span>: ag.space.Int(lower<span class="op">=</span><span class="dv">100</span>, upper<span class="op">=</span><span class="dv">500</span>, default<span class="op">=</span><span class="dv">100</span>), </span>
<span id="cb121-23"><a href="#cb121-23" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;eta&#39;</span>:<span class="fl">.3</span>, </span>
<span id="cb121-24"><a href="#cb121-24" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;subsample&#39;</span>: <span class="dv">1</span>,</span>
<span id="cb121-25"><a href="#cb121-25" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;colsample_bytree&#39;</span>: <span class="dv">1</span>}]</span>
<span id="cb121-26"><a href="#cb121-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-27"><a href="#cb121-27" aria-hidden="true" tabindex="-1"></a>hyperparameters <span class="op">=</span> {  <span class="co"># hyperparameters of each model type</span></span>
<span id="cb121-28"><a href="#cb121-28" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&#39;GBM&#39;</span>: gbm_options,</span>
<span id="cb121-29"><a href="#cb121-29" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&#39;XT&#39;</span>: xt_options,</span>
<span id="cb121-30"><a href="#cb121-30" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&#39;XGB&#39;</span>: xgb_options</span>
<span id="cb121-31"><a href="#cb121-31" aria-hidden="true" tabindex="-1"></a>                  }  </span>
<span id="cb121-32"><a href="#cb121-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-33"><a href="#cb121-33" aria-hidden="true" tabindex="-1"></a>num_trials <span class="op">=</span> <span class="dv">20</span>            <span class="co"># Number of hyperparameter optimization trials you want to perform</span></span>
<span id="cb121-34"><a href="#cb121-34" aria-hidden="true" tabindex="-1"></a>search_strategy <span class="op">=</span> <span class="st">&#39;auto&#39;</span>  <span class="co"># tune hyperparameters using Bayesian optimization routine with a local scheduler</span></span>
<span id="cb121-35"><a href="#cb121-35" aria-hidden="true" tabindex="-1"></a>scheduler <span class="op">=</span> <span class="st">&#39;local&#39;</span>       <span class="co"># Local FIFO scheduler</span></span>
<span id="cb121-36"><a href="#cb121-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-37"><a href="#cb121-37" aria-hidden="true" tabindex="-1"></a>hyperparameter_tune_kwargs <span class="op">=</span> { </span>
<span id="cb121-38"><a href="#cb121-38" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&#39;num_trials&#39;</span>: num_trials,</span>
<span id="cb121-39"><a href="#cb121-39" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&#39;scheduler&#39;</span> : scheduler,</span>
<span id="cb121-40"><a href="#cb121-40" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&#39;searcher&#39;</span>: search_strategy,</span>
<span id="cb121-41"><a href="#cb121-41" aria-hidden="true" tabindex="-1"></a>                        }</span>
<span id="cb121-42"><a href="#cb121-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-43"><a href="#cb121-43" aria-hidden="true" tabindex="-1"></a>predictor_new_hpo1 <span class="op">=</span> TabularPredictor(label<span class="op">=</span><span class="st">&#39;count&#39;</span>, problem_type<span class="op">=</span><span class="st">&#39;regression&#39;</span>, eval_metric<span class="op">=</span><span class="st">&#39;root_mean_squared_error&#39;</span>,</span>
<span id="cb121-44"><a href="#cb121-44" aria-hidden="true" tabindex="-1"></a>                                    learner_kwargs<span class="op">=</span>{<span class="st">&#39;ignored_columns&#39;</span>: ignored_columns}).fit(</span>
<span id="cb121-45"><a href="#cb121-45" aria-hidden="true" tabindex="-1"></a>                                                                         train_data<span class="op">=</span>train, </span>
<span id="cb121-46"><a href="#cb121-46" aria-hidden="true" tabindex="-1"></a>                                                                         time_limit<span class="op">=</span>time_limit,</span>
<span id="cb121-47"><a href="#cb121-47" aria-hidden="true" tabindex="-1"></a>                                                                         presets<span class="op">=</span>presets, </span>
<span id="cb121-48"><a href="#cb121-48" aria-hidden="true" tabindex="-1"></a>                                                                         hyperparameters<span class="op">=</span>hyperparameters, </span>
<span id="cb121-49"><a href="#cb121-49" aria-hidden="true" tabindex="-1"></a>                                                                         hyperparameter_tune_kwargs<span class="op">=</span>hyperparameter_tune_kwargs,</span>
<span id="cb121-50"><a href="#cb121-50" aria-hidden="true" tabindex="-1"></a>                                                                         excluded_model_types<span class="op">=</span>excluded_model_types,</span>
<span id="cb121-51"><a href="#cb121-51" aria-hidden="true" tabindex="-1"></a>                                                                         refit_full<span class="op">=</span><span class="st">&#39;best&#39;</span>)</span></code></pre></div>
<div class="output stream stderr">
<pre><code>No path specified. Models will be saved in: &quot;AutogluonModels/ag-20230528_113056/&quot;
Presets specified: [&#39;optimize_for_deployment&#39;]
Warning: hyperparameter tuning is currently experimental and may cause the process to hang.
Beginning AutoGluon training ... Time limit = 600s
AutoGluon will save models to &quot;AutogluonModels/ag-20230528_113056/&quot;
AutoGluon Version:  0.7.0
Python Version:     3.10.11
Operating System:   Linux
Platform Machine:   x86_64
Platform Version:   #1 SMP Sat Apr 29 09:15:28 UTC 2023
Train Data Rows:    10886
Train Data Columns: 14
Label Column: count
Preprocessing data ...
Using Feature Generators to preprocess the data ...
Dropping user-specified ignored columns: [&#39;casual&#39;, &#39;registered&#39;]
Fitting AutoMLPipelineFeatureGenerator...
	Available Memory:                    10190.58 MB
	Train Data (Original)  Memory Usage: 0.82 MB (0.0% of available memory)
	Inferring data type of each feature based on column values. Set feature_metadata_in to manually specify special dtypes of the features.
	Stage 1 Generators:
		Fitting AsTypeFeatureGenerator...
			Note: Converting 3 features to boolean dtype as they only contain 2 unique values.
	Stage 2 Generators:
		Fitting FillNaFeatureGenerator...
	Stage 3 Generators:
		Fitting IdentityFeatureGenerator...
		Fitting CategoryFeatureGenerator...
			Fitting CategoryMemoryMinimizeFeatureGenerator...
	Stage 4 Generators:
		Fitting DropUniqueFeatureGenerator...
	Types of features in original data (raw dtype, special dtypes):
		(&#39;category&#39;, []) : 3 | [&#39;season&#39;, &#39;weather&#39;, &#39;day_type&#39;]
		(&#39;float&#39;, [])    : 2 | [&#39;temp&#39;, &#39;windspeed&#39;]
		(&#39;int&#39;, [])      : 7 | [&#39;holiday&#39;, &#39;workingday&#39;, &#39;humidity&#39;, &#39;year&#39;, &#39;month&#39;, ...]
	Types of features in processed data (raw dtype, special dtypes):
		(&#39;category&#39;, [])  : 3 | [&#39;season&#39;, &#39;weather&#39;, &#39;day_type&#39;]
		(&#39;float&#39;, [])     : 2 | [&#39;temp&#39;, &#39;windspeed&#39;]
		(&#39;int&#39;, [])       : 4 | [&#39;humidity&#39;, &#39;month&#39;, &#39;day&#39;, &#39;hour&#39;]
		(&#39;int&#39;, [&#39;bool&#39;]) : 3 | [&#39;holiday&#39;, &#39;workingday&#39;, &#39;year&#39;]
	0.3s = Fit runtime
	12 features in original data used to generate 12 features in processed data.
	Train Data (Processed) Memory Usage: 0.59 MB (0.0% of available memory)
Data preprocessing and feature engineering runtime = 0.38s ...
AutoGluon will gauge predictive performance using evaluation metric: &#39;root_mean_squared_error&#39;
	This metric&#39;s sign has been flipped to adhere to being higher_is_better. The metric score can be multiplied by -1 to get the metric value.
	To change this, specify the eval_metric parameter of Predictor()
Automatically generating train/validation split with holdout_frac=0.2, Train Rows: 8708, Val Rows: 2178
Excluded Model Types: [&#39;NN_TORCH&#39;]
Fitting 5 L1 models ...
Hyperparameter tuning model: LightGBMXT ... Tuning model for up to 107.93s of the 599.6s of remaining time.
</code></pre>
</div>
<div class="output display_data">
<div class="sourceCode" id="cb123"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;7a5f7f3c2db34e118a7fb4786cd91f3f&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output stream stderr">
<pre><code>Fitted model: LightGBMXT/T1 ...
	-71.9711	 = Validation score   (-root_mean_squared_error)
	1.62s	 = Training   runtime
	0.06s	 = Validation runtime
Fitted model: LightGBMXT/T2 ...
	-43.8633	 = Validation score   (-root_mean_squared_error)
	1.74s	 = Training   runtime
	0.17s	 = Validation runtime
Fitted model: LightGBMXT/T3 ...
	-88.1544	 = Validation score   (-root_mean_squared_error)
	1.04s	 = Training   runtime
	0.06s	 = Validation runtime
Fitted model: LightGBMXT/T4 ...
	-50.4195	 = Validation score   (-root_mean_squared_error)
	1.76s	 = Training   runtime
	0.26s	 = Validation runtime
Fitted model: LightGBMXT/T5 ...
	-90.0782	 = Validation score   (-root_mean_squared_error)
	0.66s	 = Training   runtime
	0.04s	 = Validation runtime
Fitted model: LightGBMXT/T6 ...
	-58.3299	 = Validation score   (-root_mean_squared_error)
	1.2s	 = Training   runtime
	0.12s	 = Validation runtime
Fitted model: LightGBMXT/T7 ...
	-40.3716	 = Validation score   (-root_mean_squared_error)
	1.85s	 = Training   runtime
	0.33s	 = Validation runtime
Fitted model: LightGBMXT/T8 ...
	-43.8404	 = Validation score   (-root_mean_squared_error)
	2.07s	 = Training   runtime
	0.37s	 = Validation runtime
Fitted model: LightGBMXT/T9 ...
	-52.6528	 = Validation score   (-root_mean_squared_error)
	1.97s	 = Training   runtime
	0.29s	 = Validation runtime
Fitted model: LightGBMXT/T10 ...
	-96.8619	 = Validation score   (-root_mean_squared_error)
	1.36s	 = Training   runtime
	0.09s	 = Validation runtime
Fitted model: LightGBMXT/T11 ...
	-50.586	 = Validation score   (-root_mean_squared_error)
	1.72s	 = Training   runtime
	0.15s	 = Validation runtime
Fitted model: LightGBMXT/T12 ...
	-60.3276	 = Validation score   (-root_mean_squared_error)
	1.37s	 = Training   runtime
	0.12s	 = Validation runtime
Fitted model: LightGBMXT/T13 ...
	-44.8927	 = Validation score   (-root_mean_squared_error)
	1.1s	 = Training   runtime
	0.09s	 = Validation runtime
Fitted model: LightGBMXT/T14 ...
	-76.6831	 = Validation score   (-root_mean_squared_error)
	2.67s	 = Training   runtime
	0.35s	 = Validation runtime
Fitted model: LightGBMXT/T15 ...
	-82.0295	 = Validation score   (-root_mean_squared_error)
	1.28s	 = Training   runtime
	0.07s	 = Validation runtime
Fitted model: LightGBMXT/T16 ...
	-55.9012	 = Validation score   (-root_mean_squared_error)
	1.41s	 = Training   runtime
	0.1s	 = Validation runtime
Fitted model: LightGBMXT/T17 ...
	-84.9096	 = Validation score   (-root_mean_squared_error)
	1.79s	 = Training   runtime
	0.15s	 = Validation runtime
Fitted model: LightGBMXT/T18 ...
	-42.4013	 = Validation score   (-root_mean_squared_error)
	1.56s	 = Training   runtime
	0.24s	 = Validation runtime
Fitted model: LightGBMXT/T19 ...
	-95.0394	 = Validation score   (-root_mean_squared_error)
	1.26s	 = Training   runtime
	0.12s	 = Validation runtime
Fitted model: LightGBMXT/T20 ...
	-41.5532	 = Validation score   (-root_mean_squared_error)
	1.48s	 = Training   runtime
	0.21s	 = Validation runtime
Hyperparameter tuning model: LightGBM ... Tuning model for up to 107.93s of the 560.93s of remaining time.
</code></pre>
</div>
<div class="output display_data">
<div class="sourceCode" id="cb125"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;b6564985c14c4443949ea9da065bc886&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output stream stdout">
<pre><code>[1000]	valid_set&#39;s rmse: 38.8412
[1000]	valid_set&#39;s rmse: 39.722
[1000]	valid_set&#39;s rmse: 39.5199
[2000]	valid_set&#39;s rmse: 38.3691
[3000]	valid_set&#39;s rmse: 38.1532
[4000]	valid_set&#39;s rmse: 38.1416
[5000]	valid_set&#39;s rmse: 38.1845
[1000]	valid_set&#39;s rmse: 39.0485
[1000]	valid_set&#39;s rmse: 39.3696
[2000]	valid_set&#39;s rmse: 38.677
[3000]	valid_set&#39;s rmse: 38.6376
[1000]	valid_set&#39;s rmse: 38.5283
[2000]	valid_set&#39;s rmse: 38.2386
[1000]	valid_set&#39;s rmse: 39.1305
[2000]	valid_set&#39;s rmse: 38.5694
[3000]	valid_set&#39;s rmse: 38.5402
[4000]	valid_set&#39;s rmse: 38.4337
[5000]	valid_set&#39;s rmse: 38.4924
[1000]	valid_set&#39;s rmse: 38.5145
[2000]	valid_set&#39;s rmse: 38.3808
[1000]	valid_set&#39;s rmse: 40.8581
</code></pre>
</div>
<div class="output stream stderr">
<pre><code>	Ran out of time, early stopping on iteration 2116. Best iteration is:
	[2105]	valid_set&#39;s rmse: 39.8383
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>[2000]	valid_set&#39;s rmse: 39.9082
</code></pre>
</div>
<div class="output stream stderr">
<pre><code>	Stopping HPO to satisfy time limit...
Fitted model: LightGBM/T1 ...
	-38.7749	 = Validation score   (-root_mean_squared_error)
	3.2s	 = Training   runtime
	0.42s	 = Validation runtime
Fitted model: LightGBM/T2 ...
	-39.278	 = Validation score   (-root_mean_squared_error)
	2.57s	 = Training   runtime
	0.11s	 = Validation runtime
Fitted model: LightGBM/T3 ...
	-39.6569	 = Validation score   (-root_mean_squared_error)
	4.2s	 = Training   runtime
	0.56s	 = Validation runtime
Fitted model: LightGBM/T4 ...
	-38.124	 = Validation score   (-root_mean_squared_error)
	12.02s	 = Training   runtime
	3.59s	 = Validation runtime
Fitted model: LightGBM/T5 ...
	-39.5392	 = Validation score   (-root_mean_squared_error)
	2.77s	 = Training   runtime
	0.25s	 = Validation runtime
Fitted model: LightGBM/T6 ...
	-39.0408	 = Validation score   (-root_mean_squared_error)
	5.14s	 = Training   runtime
	0.52s	 = Validation runtime
Fitted model: LightGBM/T7 ...
	-38.6204	 = Validation score   (-root_mean_squared_error)
	1.79s	 = Training   runtime
	0.12s	 = Validation runtime
Fitted model: LightGBM/T8 ...
	-39.6364	 = Validation score   (-root_mean_squared_error)
	1.82s	 = Training   runtime
	0.22s	 = Validation runtime
Fitted model: LightGBM/T9 ...
	-38.5911	 = Validation score   (-root_mean_squared_error)
	12.01s	 = Training   runtime
	2.15s	 = Validation runtime
Fitted model: LightGBM/T10 ...
	-38.5597	 = Validation score   (-root_mean_squared_error)
	1.33s	 = Training   runtime
	0.05s	 = Validation runtime
Fitted model: LightGBM/T11 ...
	-38.2283	 = Validation score   (-root_mean_squared_error)
	5.5s	 = Training   runtime
	0.86s	 = Validation runtime
Fitted model: LightGBM/T12 ...
	-38.4319	 = Validation score   (-root_mean_squared_error)
	16.82s	 = Training   runtime
	2.1s	 = Validation runtime
Fitted model: LightGBM/T13 ...
	-38.3697	 = Validation score   (-root_mean_squared_error)
	5.61s	 = Training   runtime
	1.03s	 = Validation runtime
Fitted model: LightGBM/T14 ...
	-39.8383	 = Validation score   (-root_mean_squared_error)
	3.94s	 = Training   runtime
	0.66s	 = Validation runtime
Hyperparameter tuning model: ExtraTreesMSE ... Tuning model for up to 107.93s of the 453.43s of remaining time.
	No hyperparameter search space specified for ExtraTreesMSE. Skipping HPO. Will train one model based on the provided hyperparameters.
Fitted model: ExtraTreesMSE ...
	-39.5841	 = Validation score   (-root_mean_squared_error)
	5.95s	 = Training   runtime
	0.57s	 = Validation runtime
Hyperparameter tuning model: XGBoost ... Tuning model for up to 107.93s of the 445.39s of remaining time.
</code></pre>
</div>
<div class="output display_data">
<div class="sourceCode" id="cb130"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;a4c36909683240f78ce735bab94551a7&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output stream stderr">
<pre><code>Fitted model: XGBoost/T1 ...
	-41.7563	 = Validation score   (-root_mean_squared_error)
	0.69s	 = Training   runtime
	0.03s	 = Validation runtime
Fitted model: XGBoost/T2 ...
	-40.9482	 = Validation score   (-root_mean_squared_error)
	2.0s	 = Training   runtime
	0.08s	 = Validation runtime
Fitted model: XGBoost/T3 ...
	-40.1906	 = Validation score   (-root_mean_squared_error)
	1.93s	 = Training   runtime
	0.06s	 = Validation runtime
Fitted model: XGBoost/T4 ...
	-45.25	 = Validation score   (-root_mean_squared_error)
	1.47s	 = Training   runtime
	0.04s	 = Validation runtime
Fitted model: XGBoost/T5 ...
	-44.6192	 = Validation score   (-root_mean_squared_error)
	3.6s	 = Training   runtime
	0.14s	 = Validation runtime
Fitted model: XGBoost/T6 ...
	-40.6271	 = Validation score   (-root_mean_squared_error)
	2.9s	 = Training   runtime
	0.1s	 = Validation runtime
Fitted model: XGBoost/T7 ...
	-43.0461	 = Validation score   (-root_mean_squared_error)
	2.09s	 = Training   runtime
	0.06s	 = Validation runtime
Fitted model: XGBoost/T8 ...
	-39.3848	 = Validation score   (-root_mean_squared_error)
	3.89s	 = Training   runtime
	0.1s	 = Validation runtime
Fitted model: XGBoost/T9 ...
	-41.7707	 = Validation score   (-root_mean_squared_error)
	1.86s	 = Training   runtime
	0.08s	 = Validation runtime
Fitted model: XGBoost/T10 ...
	-40.1718	 = Validation score   (-root_mean_squared_error)
	1.96s	 = Training   runtime
	0.07s	 = Validation runtime
Fitted model: XGBoost/T11 ...
	-44.1231	 = Validation score   (-root_mean_squared_error)
	1.55s	 = Training   runtime
	0.05s	 = Validation runtime
Fitted model: XGBoost/T12 ...
	-39.941	 = Validation score   (-root_mean_squared_error)
	2.48s	 = Training   runtime
	0.12s	 = Validation runtime
Fitted model: XGBoost/T13 ...
	-41.6414	 = Validation score   (-root_mean_squared_error)
	1.58s	 = Training   runtime
	0.09s	 = Validation runtime
Fitted model: XGBoost/T14 ...
	-45.3902	 = Validation score   (-root_mean_squared_error)
	2.9s	 = Training   runtime
	0.09s	 = Validation runtime
Fitted model: XGBoost/T15 ...
	-64.6749	 = Validation score   (-root_mean_squared_error)
	1.67s	 = Training   runtime
	0.04s	 = Validation runtime
Fitted model: XGBoost/T16 ...
	-46.9138	 = Validation score   (-root_mean_squared_error)
	3.04s	 = Training   runtime
	0.09s	 = Validation runtime
Fitted model: XGBoost/T17 ...
	-54.6651	 = Validation score   (-root_mean_squared_error)
	3.83s	 = Training   runtime
	0.16s	 = Validation runtime
Fitted model: XGBoost/T18 ...
	-40.1631	 = Validation score   (-root_mean_squared_error)
	1.51s	 = Training   runtime
	0.05s	 = Validation runtime
Fitted model: XGBoost/T19 ...
	-38.7402	 = Validation score   (-root_mean_squared_error)
	1.32s	 = Training   runtime
	0.07s	 = Validation runtime
Fitted model: XGBoost/T20 ...
	-61.6071	 = Validation score   (-root_mean_squared_error)
	2.53s	 = Training   runtime
	0.14s	 = Validation runtime
Fitting model: LightGBMLarge ... Training model for up to 107.93s of the 397.63s of remaining time.
	-38.5164	 = Validation score   (-root_mean_squared_error)
	2.98s	 = Training   runtime
	0.3s	 = Validation runtime
Fitting model: WeightedEnsemble_L2 ... Training model for up to 360.0s of the 370.71s of remaining time.
	-37.3291	 = Validation score   (-root_mean_squared_error)
	0.47s	 = Training   runtime
	0.0s	 = Validation runtime
AutoGluon training complete, total runtime = 229.85s ... Best model: &quot;WeightedEnsemble_L2&quot;
Automatically performing refit_full as a post-fit operation (due to `.fit(..., refit_full=True)`
Refitting models via `predictor.refit_full` using all of the data (combined train and validation)...
	Models trained in this way will have the suffix &quot;_FULL&quot; and have NaN validation score.
	This process is not bound by time_limit, but should take less time than the original `predictor.fit` call.
	To learn more, refer to the `.refit_full` method docstring which explains how &quot;_FULL&quot; models differ from normal models.
Fitting 1 L1 models ...
Fitting model: LightGBM/T4_FULL ...
	14.34s	 = Training   runtime
Fitting 1 L1 models ...
Fitting model: LightGBM/T12_FULL ...
	8.69s	 = Training   runtime
Fitting 1 L1 models ...
Fitting model: LightGBM/T13_FULL ...
	7.24s	 = Training   runtime
Fitting 1 L1 models ...
Fitting model: ExtraTreesMSE_FULL ...
	6.31s	 = Training   runtime
Fitting 1 L1 models ...
Fitting model: XGBoost/T8_FULL ...
	1.11s	 = Training   runtime
Fitting 1 L1 models ...
Fitting model: XGBoost/T19_FULL ...
	0.68s	 = Training   runtime
Fitting 1 L1 models ...
Fitting model: LightGBMLarge_FULL ...
	3.34s	 = Training   runtime
Fitting model: WeightedEnsemble_L2_FULL | Skipping fit via cloning parent ...
	0.47s	 = Training   runtime
Refit complete, total runtime = 68.97s
Deleting model LightGBMXT/T1. All files under /content/AutogluonModels/ag-20230528_113056/models/LightGBMXT/T1/ will be removed.
Deleting model LightGBMXT/T2. All files under /content/AutogluonModels/ag-20230528_113056/models/LightGBMXT/T2/ will be removed.
Deleting model LightGBMXT/T3. All files under /content/AutogluonModels/ag-20230528_113056/models/LightGBMXT/T3/ will be removed.
Deleting model LightGBMXT/T4. All files under /content/AutogluonModels/ag-20230528_113056/models/LightGBMXT/T4/ will be removed.
Deleting model LightGBMXT/T5. All files under /content/AutogluonModels/ag-20230528_113056/models/LightGBMXT/T5/ will be removed.
Deleting model LightGBMXT/T6. All files under /content/AutogluonModels/ag-20230528_113056/models/LightGBMXT/T6/ will be removed.
Deleting model LightGBMXT/T7. All files under /content/AutogluonModels/ag-20230528_113056/models/LightGBMXT/T7/ will be removed.
Deleting model LightGBMXT/T8. All files under /content/AutogluonModels/ag-20230528_113056/models/LightGBMXT/T8/ will be removed.
Deleting model LightGBMXT/T9. All files under /content/AutogluonModels/ag-20230528_113056/models/LightGBMXT/T9/ will be removed.
Deleting model LightGBMXT/T10. All files under /content/AutogluonModels/ag-20230528_113056/models/LightGBMXT/T10/ will be removed.
Deleting model LightGBMXT/T11. All files under /content/AutogluonModels/ag-20230528_113056/models/LightGBMXT/T11/ will be removed.
Deleting model LightGBMXT/T12. All files under /content/AutogluonModels/ag-20230528_113056/models/LightGBMXT/T12/ will be removed.
Deleting model LightGBMXT/T13. All files under /content/AutogluonModels/ag-20230528_113056/models/LightGBMXT/T13/ will be removed.
Deleting model LightGBMXT/T14. All files under /content/AutogluonModels/ag-20230528_113056/models/LightGBMXT/T14/ will be removed.
Deleting model LightGBMXT/T15. All files under /content/AutogluonModels/ag-20230528_113056/models/LightGBMXT/T15/ will be removed.
Deleting model LightGBMXT/T16. All files under /content/AutogluonModels/ag-20230528_113056/models/LightGBMXT/T16/ will be removed.
Deleting model LightGBMXT/T17. All files under /content/AutogluonModels/ag-20230528_113056/models/LightGBMXT/T17/ will be removed.
Deleting model LightGBMXT/T18. All files under /content/AutogluonModels/ag-20230528_113056/models/LightGBMXT/T18/ will be removed.
Deleting model LightGBMXT/T19. All files under /content/AutogluonModels/ag-20230528_113056/models/LightGBMXT/T19/ will be removed.
Deleting model LightGBMXT/T20. All files under /content/AutogluonModels/ag-20230528_113056/models/LightGBMXT/T20/ will be removed.
Deleting model LightGBM/T1. All files under /content/AutogluonModels/ag-20230528_113056/models/LightGBM/T1/ will be removed.
Deleting model LightGBM/T2. All files under /content/AutogluonModels/ag-20230528_113056/models/LightGBM/T2/ will be removed.
Deleting model LightGBM/T3. All files under /content/AutogluonModels/ag-20230528_113056/models/LightGBM/T3/ will be removed.
Deleting model LightGBM/T5. All files under /content/AutogluonModels/ag-20230528_113056/models/LightGBM/T5/ will be removed.
Deleting model LightGBM/T6. All files under /content/AutogluonModels/ag-20230528_113056/models/LightGBM/T6/ will be removed.
Deleting model LightGBM/T7. All files under /content/AutogluonModels/ag-20230528_113056/models/LightGBM/T7/ will be removed.
Deleting model LightGBM/T8. All files under /content/AutogluonModels/ag-20230528_113056/models/LightGBM/T8/ will be removed.
Deleting model LightGBM/T9. All files under /content/AutogluonModels/ag-20230528_113056/models/LightGBM/T9/ will be removed.
Deleting model LightGBM/T10. All files under /content/AutogluonModels/ag-20230528_113056/models/LightGBM/T10/ will be removed.
Deleting model LightGBM/T11. All files under /content/AutogluonModels/ag-20230528_113056/models/LightGBM/T11/ will be removed.
Deleting model LightGBM/T14. All files under /content/AutogluonModels/ag-20230528_113056/models/LightGBM/T14/ will be removed.
Deleting model XGBoost/T1. All files under /content/AutogluonModels/ag-20230528_113056/models/XGBoost/T1/ will be removed.
Deleting model XGBoost/T2. All files under /content/AutogluonModels/ag-20230528_113056/models/XGBoost/T2/ will be removed.
Deleting model XGBoost/T3. All files under /content/AutogluonModels/ag-20230528_113056/models/XGBoost/T3/ will be removed.
Deleting model XGBoost/T4. All files under /content/AutogluonModels/ag-20230528_113056/models/XGBoost/T4/ will be removed.
Deleting model XGBoost/T5. All files under /content/AutogluonModels/ag-20230528_113056/models/XGBoost/T5/ will be removed.
Deleting model XGBoost/T6. All files under /content/AutogluonModels/ag-20230528_113056/models/XGBoost/T6/ will be removed.
Deleting model XGBoost/T7. All files under /content/AutogluonModels/ag-20230528_113056/models/XGBoost/T7/ will be removed.
Deleting model XGBoost/T9. All files under /content/AutogluonModels/ag-20230528_113056/models/XGBoost/T9/ will be removed.
Deleting model XGBoost/T10. All files under /content/AutogluonModels/ag-20230528_113056/models/XGBoost/T10/ will be removed.
Deleting model XGBoost/T11. All files under /content/AutogluonModels/ag-20230528_113056/models/XGBoost/T11/ will be removed.
Deleting model XGBoost/T12. All files under /content/AutogluonModels/ag-20230528_113056/models/XGBoost/T12/ will be removed.
Deleting model XGBoost/T13. All files under /content/AutogluonModels/ag-20230528_113056/models/XGBoost/T13/ will be removed.
Deleting model XGBoost/T14. All files under /content/AutogluonModels/ag-20230528_113056/models/XGBoost/T14/ will be removed.
Deleting model XGBoost/T15. All files under /content/AutogluonModels/ag-20230528_113056/models/XGBoost/T15/ will be removed.
Deleting model XGBoost/T16. All files under /content/AutogluonModels/ag-20230528_113056/models/XGBoost/T16/ will be removed.
Deleting model XGBoost/T17. All files under /content/AutogluonModels/ag-20230528_113056/models/XGBoost/T17/ will be removed.
Deleting model XGBoost/T18. All files under /content/AutogluonModels/ag-20230528_113056/models/XGBoost/T18/ will be removed.
Deleting model XGBoost/T20. All files under /content/AutogluonModels/ag-20230528_113056/models/XGBoost/T20/ will be removed.
Deleting model LightGBM/T4_FULL. All files under /content/AutogluonModels/ag-20230528_113056/models/LightGBM/T4_FULL/ will be removed.
Deleting model LightGBM/T12_FULL. All files under /content/AutogluonModels/ag-20230528_113056/models/LightGBM/T12_FULL/ will be removed.
Deleting model LightGBM/T13_FULL. All files under /content/AutogluonModels/ag-20230528_113056/models/LightGBM/T13_FULL/ will be removed.
Deleting model ExtraTreesMSE_FULL. All files under AutogluonModels/ag-20230528_113056/models/ExtraTreesMSE_FULL/ will be removed.
Deleting model XGBoost/T8_FULL. All files under /content/AutogluonModels/ag-20230528_113056/models/XGBoost/T8_FULL/ will be removed.
Deleting model XGBoost/T19_FULL. All files under /content/AutogluonModels/ag-20230528_113056/models/XGBoost/T19_FULL/ will be removed.
Deleting model LightGBMLarge_FULL. All files under AutogluonModels/ag-20230528_113056/models/LightGBMLarge_FULL/ will be removed.
Deleting model WeightedEnsemble_L2_FULL. All files under AutogluonModels/ag-20230528_113056/models/WeightedEnsemble_L2_FULL/ will be removed.
TabularPredictor saved. To load, use: predictor = TabularPredictor.load(&quot;AutogluonModels/ag-20230528_113056/&quot;)
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="87"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="ko2EorR9IJiz" data-outputId="f47e6a61-969c-4ae0-c8a0-46b5565704dc">
<div class="sourceCode" id="cb132"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>predictor_new_hpo1.fit_summary()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>*** Summary of fit() ***
Estimated performance of each model:
                 model  score_val  pred_time_val   fit_time  pred_time_val_marginal  fit_time_marginal  stack_level  can_infer  fit_order
0  WeightedEnsemble_L2 -37.329139       7.760167  49.063486                0.001100           0.471725            2       True          8
1          LightGBM/T4 -38.124006       3.589866  12.020875                3.589866          12.020875            1       True          1
2         LightGBM/T13 -38.369670       1.026404   5.612533                1.026404           5.612533            1       True          3
3         LightGBM/T12 -38.431862       2.101555  16.820948                2.101555          16.820948            1       True          2
4        LightGBMLarge -38.516436       0.304621   2.983486                0.304621           2.983486            1       True          7
5          XGBoost/T19 -38.740239       0.065890   1.318914                0.065890           1.318914            1       True          6
6           XGBoost/T8 -39.384803       0.099771   3.886645                0.099771           3.886645            1       True          5
7        ExtraTreesMSE -39.584076       0.570961   5.948359                0.570961           5.948359            1       True          4
Number of models trained: 8
Types of models trained:
{&#39;WeightedEnsembleModel&#39;, &#39;XTModel&#39;, &#39;LGBModel&#39;, &#39;XGBoostModel&#39;}
Bagging used: False 
Multi-layer stack-ensembling used: False 
Feature Metadata (Processed):
(raw dtype, special dtypes):
(&#39;category&#39;, [])  : 3 | [&#39;season&#39;, &#39;weather&#39;, &#39;day_type&#39;]
(&#39;float&#39;, [])     : 2 | [&#39;temp&#39;, &#39;windspeed&#39;]
(&#39;int&#39;, [])       : 4 | [&#39;humidity&#39;, &#39;month&#39;, &#39;day&#39;, &#39;hour&#39;]
(&#39;int&#39;, [&#39;bool&#39;]) : 3 | [&#39;holiday&#39;, &#39;workingday&#39;, &#39;year&#39;]
*** End of fit() summary ***
</code></pre>
</div>
<div class="output stream stderr">
<pre><code>/usr/local/lib/python3.10/dist-packages/autogluon/core/utils/plots.py:138: UserWarning: AutoGluon summary plots cannot be created because bokeh is not installed. To see plots, please do: &quot;pip install bokeh==2.0.1&quot;
  warnings.warn(&#39;AutoGluon summary plots cannot be created because bokeh is not installed. To see plots, please do: &quot;pip install bokeh==2.0.1&quot;&#39;)
</code></pre>
</div>
<div class="output execute_result" data-execution_count="87">
<pre><code>{&#39;model_types&#39;: {&#39;LightGBM/T4&#39;: &#39;LGBModel&#39;,
  &#39;LightGBM/T12&#39;: &#39;LGBModel&#39;,
  &#39;LightGBM/T13&#39;: &#39;LGBModel&#39;,
  &#39;ExtraTreesMSE&#39;: &#39;XTModel&#39;,
  &#39;XGBoost/T8&#39;: &#39;XGBoostModel&#39;,
  &#39;XGBoost/T19&#39;: &#39;XGBoostModel&#39;,
  &#39;LightGBMLarge&#39;: &#39;LGBModel&#39;,
  &#39;WeightedEnsemble_L2&#39;: &#39;WeightedEnsembleModel&#39;},
 &#39;model_performance&#39;: {&#39;LightGBM/T4&#39;: -38.12400606130618,
  &#39;LightGBM/T12&#39;: -38.431861570431245,
  &#39;LightGBM/T13&#39;: -38.3696701247306,
  &#39;ExtraTreesMSE&#39;: -39.584076050325685,
  &#39;XGBoost/T8&#39;: -39.38480317646934,
  &#39;XGBoost/T19&#39;: -38.7402388682388,
  &#39;LightGBMLarge&#39;: -38.51643622165731,
  &#39;WeightedEnsemble_L2&#39;: -37.329139013323804},
 &#39;model_best&#39;: &#39;WeightedEnsemble_L2&#39;,
 &#39;model_paths&#39;: {&#39;LightGBM/T4&#39;: &#39;/content/AutogluonModels/ag-20230528_113056/models/LightGBM/T4/&#39;,
  &#39;LightGBM/T12&#39;: &#39;/content/AutogluonModels/ag-20230528_113056/models/LightGBM/T12/&#39;,
  &#39;LightGBM/T13&#39;: &#39;/content/AutogluonModels/ag-20230528_113056/models/LightGBM/T13/&#39;,
  &#39;ExtraTreesMSE&#39;: &#39;AutogluonModels/ag-20230528_113056/models/ExtraTreesMSE/&#39;,
  &#39;XGBoost/T8&#39;: &#39;/content/AutogluonModels/ag-20230528_113056/models/XGBoost/T8/&#39;,
  &#39;XGBoost/T19&#39;: &#39;/content/AutogluonModels/ag-20230528_113056/models/XGBoost/T19/&#39;,
  &#39;LightGBMLarge&#39;: &#39;AutogluonModels/ag-20230528_113056/models/LightGBMLarge/&#39;,
  &#39;WeightedEnsemble_L2&#39;: &#39;AutogluonModels/ag-20230528_113056/models/WeightedEnsemble_L2/&#39;},
 &#39;model_fit_times&#39;: {&#39;LightGBM/T4&#39;: 12.020875453948975,
  &#39;LightGBM/T12&#39;: 16.820947885513306,
  &#39;LightGBM/T13&#39;: 5.612533330917358,
  &#39;ExtraTreesMSE&#39;: 5.948359251022339,
  &#39;XGBoost/T8&#39;: 3.8866450786590576,
  &#39;XGBoost/T19&#39;: 1.3189139366149902,
  &#39;LightGBMLarge&#39;: 2.9834864139556885,
  &#39;WeightedEnsemble_L2&#39;: 0.4717249870300293},
 &#39;model_pred_times&#39;: {&#39;LightGBM/T4&#39;: 3.5898656845092773,
  &#39;LightGBM/T12&#39;: 2.1015546321868896,
  &#39;LightGBM/T13&#39;: 1.0264036655426025,
  &#39;ExtraTreesMSE&#39;: 0.570960521697998,
  &#39;XGBoost/T8&#39;: 0.09977126121520996,
  &#39;XGBoost/T19&#39;: 0.06589031219482422,
  &#39;LightGBMLarge&#39;: 0.30462098121643066,
  &#39;WeightedEnsemble_L2&#39;: 0.0011000633239746094},
 &#39;num_bag_folds&#39;: 0,
 &#39;max_stack_level&#39;: 2,
 &#39;model_hyperparams&#39;: {&#39;LightGBM/T4&#39;: {&#39;learning_rate&#39;: 0.006163502781172814,
   &#39;feature_fraction&#39;: 0.824383651636118,
   &#39;min_data_in_leaf&#39;: 14,
   &#39;num_leaves&#39;: 74},
  &#39;LightGBM/T12&#39;: {&#39;learning_rate&#39;: 0.008233749120302263,
   &#39;feature_fraction&#39;: 0.804137588606093,
   &#39;min_data_in_leaf&#39;: 38,
   &#39;num_leaves&#39;: 69},
  &#39;LightGBM/T13&#39;: {&#39;learning_rate&#39;: 0.011353825252123055,
   &#39;feature_fraction&#39;: 0.7874187167959208,
   &#39;min_data_in_leaf&#39;: 19,
   &#39;num_leaves&#39;: 95},
  &#39;ExtraTreesMSE&#39;: {&#39;n_estimators&#39;: 300,
   &#39;max_leaf_nodes&#39;: 15000,
   &#39;n_jobs&#39;: -1,
   &#39;random_state&#39;: 0,
   &#39;bootstrap&#39;: True,
   &#39;criterion&#39;: &#39;squared_error&#39;},
  &#39;XGBoost/T8&#39;: {&#39;n_estimators&#39;: 438,
   &#39;learning_rate&#39;: 0.08823152832086026,
   &#39;n_jobs&#39;: -1,
   &#39;proc.max_category_levels&#39;: 100,
   &#39;objective&#39;: &#39;reg:squarederror&#39;,
   &#39;booster&#39;: &#39;gbtree&#39;,
   &#39;eval_metric&#39;: &#39;rmse&#39;,
   &#39;max_depth&#39;: 8,
   &#39;eta&#39;: 0.3,
   &#39;subsample&#39;: 1,
   &#39;colsample_bytree&#39;: 1,
   &#39;min_child_weight&#39;: 1},
  &#39;XGBoost/T19&#39;: {&#39;n_estimators&#39;: 221,
   &#39;learning_rate&#39;: 0.07972861819129476,
   &#39;n_jobs&#39;: -1,
   &#39;proc.max_category_levels&#39;: 100,
   &#39;objective&#39;: &#39;reg:squarederror&#39;,
   &#39;booster&#39;: &#39;gbtree&#39;,
   &#39;eval_metric&#39;: &#39;rmse&#39;,
   &#39;max_depth&#39;: 8,
   &#39;eta&#39;: 0.3,
   &#39;subsample&#39;: 1,
   &#39;colsample_bytree&#39;: 1,
   &#39;min_child_weight&#39;: 5},
  &#39;LightGBMLarge&#39;: {&#39;learning_rate&#39;: 0.03,
   &#39;num_leaves&#39;: 128,
   &#39;feature_fraction&#39;: 0.9,
   &#39;min_data_in_leaf&#39;: 5},
  &#39;WeightedEnsemble_L2&#39;: {&#39;use_orig_features&#39;: False,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True}},
 &#39;leaderboard&#39;:                  model  score_val  pred_time_val   fit_time  \
 0  WeightedEnsemble_L2 -37.329139       7.760167  49.063486   
 1          LightGBM/T4 -38.124006       3.589866  12.020875   
 2         LightGBM/T13 -38.369670       1.026404   5.612533   
 3         LightGBM/T12 -38.431862       2.101555  16.820948   
 4        LightGBMLarge -38.516436       0.304621   2.983486   
 5          XGBoost/T19 -38.740239       0.065890   1.318914   
 6           XGBoost/T8 -39.384803       0.099771   3.886645   
 7        ExtraTreesMSE -39.584076       0.570961   5.948359   
 
    pred_time_val_marginal  fit_time_marginal  stack_level  can_infer  \
 0                0.001100           0.471725            2       True   
 1                3.589866          12.020875            1       True   
 2                1.026404           5.612533            1       True   
 3                2.101555          16.820948            1       True   
 4                0.304621           2.983486            1       True   
 5                0.065890           1.318914            1       True   
 6                0.099771           3.886645            1       True   
 7                0.570961           5.948359            1       True   
 
    fit_order  
 0          8  
 1          1  
 2          3  
 3          2  
 4          7  
 5          6  
 6          5  
 7          4  }</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="88"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:520}"
id="XESPDadLJkaq" data-outputId="3834545b-0c19-4930-a1f4-173dd0c26601">
<div class="sourceCode" id="cb136"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>predictor_new_hpo1.leaderboard()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>                 model  score_val  pred_time_val   fit_time  pred_time_val_marginal  fit_time_marginal  stack_level  can_infer  fit_order
0  WeightedEnsemble_L2 -37.329139       7.760167  49.063486                0.001100           0.471725            2       True          8
1          LightGBM/T4 -38.124006       3.589866  12.020875                3.589866          12.020875            1       True          1
2         LightGBM/T13 -38.369670       1.026404   5.612533                1.026404           5.612533            1       True          3
3         LightGBM/T12 -38.431862       2.101555  16.820948                2.101555          16.820948            1       True          2
4        LightGBMLarge -38.516436       0.304621   2.983486                0.304621           2.983486            1       True          7
5          XGBoost/T19 -38.740239       0.065890   1.318914                0.065890           1.318914            1       True          6
6           XGBoost/T8 -39.384803       0.099771   3.886645                0.099771           3.886645            1       True          5
7        ExtraTreesMSE -39.584076       0.570961   5.948359                0.570961           5.948359            1       True          4
</code></pre>
</div>
<div class="output execute_result" data-execution_count="88">

  <div id="df-6b045a20-75ad-41aa-b594-9b7a75c3880a">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>model</th>
      <th>score_val</th>
      <th>pred_time_val</th>
      <th>fit_time</th>
      <th>pred_time_val_marginal</th>
      <th>fit_time_marginal</th>
      <th>stack_level</th>
      <th>can_infer</th>
      <th>fit_order</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>WeightedEnsemble_L2</td>
      <td>-37.329139</td>
      <td>7.760167</td>
      <td>49.063486</td>
      <td>0.001100</td>
      <td>0.471725</td>
      <td>2</td>
      <td>True</td>
      <td>8</td>
    </tr>
    <tr>
      <th>1</th>
      <td>LightGBM/T4</td>
      <td>-38.124006</td>
      <td>3.589866</td>
      <td>12.020875</td>
      <td>3.589866</td>
      <td>12.020875</td>
      <td>1</td>
      <td>True</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>LightGBM/T13</td>
      <td>-38.369670</td>
      <td>1.026404</td>
      <td>5.612533</td>
      <td>1.026404</td>
      <td>5.612533</td>
      <td>1</td>
      <td>True</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>LightGBM/T12</td>
      <td>-38.431862</td>
      <td>2.101555</td>
      <td>16.820948</td>
      <td>2.101555</td>
      <td>16.820948</td>
      <td>1</td>
      <td>True</td>
      <td>2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>LightGBMLarge</td>
      <td>-38.516436</td>
      <td>0.304621</td>
      <td>2.983486</td>
      <td>0.304621</td>
      <td>2.983486</td>
      <td>1</td>
      <td>True</td>
      <td>7</td>
    </tr>
    <tr>
      <th>5</th>
      <td>XGBoost/T19</td>
      <td>-38.740239</td>
      <td>0.065890</td>
      <td>1.318914</td>
      <td>0.065890</td>
      <td>1.318914</td>
      <td>1</td>
      <td>True</td>
      <td>6</td>
    </tr>
    <tr>
      <th>6</th>
      <td>XGBoost/T8</td>
      <td>-39.384803</td>
      <td>0.099771</td>
      <td>3.886645</td>
      <td>0.099771</td>
      <td>3.886645</td>
      <td>1</td>
      <td>True</td>
      <td>5</td>
    </tr>
    <tr>
      <th>7</th>
      <td>ExtraTreesMSE</td>
      <td>-39.584076</td>
      <td>0.570961</td>
      <td>5.948359</td>
      <td>0.570961</td>
      <td>5.948359</td>
      <td>1</td>
      <td>True</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-6b045a20-75ad-41aa-b594-9b7a75c3880a')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-6b045a20-75ad-41aa-b594-9b7a75c3880a button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-6b045a20-75ad-41aa-b594-9b7a75c3880a');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell code" data-execution_count="89"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:787}"
id="VCpMyaB_JwFS" data-outputId="037081f0-b801-46e7-f871-121e13330b9a">
<div class="sourceCode" id="cb138"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Output the model&#39;s `score_val` in a bar chart to compare performance</span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a>predictor_new_hpo1.leaderboard().plot(kind<span class="op">=</span><span class="st">&quot;bar&quot;</span>, x<span class="op">=</span><span class="st">&quot;model&quot;</span>, y<span class="op">=</span><span class="st">&quot;score_val&quot;</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>))</span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&quot;RMSE Scores&quot;</span>)</span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>                 model  score_val  pred_time_val   fit_time  pred_time_val_marginal  fit_time_marginal  stack_level  can_infer  fit_order
0  WeightedEnsemble_L2 -37.329139       7.760167  49.063486                0.001100           0.471725            2       True          8
1          LightGBM/T4 -38.124006       3.589866  12.020875                3.589866          12.020875            1       True          1
2         LightGBM/T13 -38.369670       1.026404   5.612533                1.026404           5.612533            1       True          3
3         LightGBM/T12 -38.431862       2.101555  16.820948                2.101555          16.820948            1       True          2
4        LightGBMLarge -38.516436       0.304621   2.983486                0.304621           2.983486            1       True          7
5          XGBoost/T19 -38.740239       0.065890   1.318914                0.065890           1.318914            1       True          6
6           XGBoost/T8 -39.384803       0.099771   3.886645                0.099771           3.886645            1       True          5
7        ExtraTreesMSE -39.584076       0.570961   5.948359                0.570961           5.948359            1       True          4
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_37271c91d75944799fe9745642b73185/7b0cba8f2ec7acd85f91e297126eaee2dea96d6d.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="91"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="57gbULJfKHms" data-outputId="eec42d00-21d1-42f5-c4a5-b1a35ef2ea09">
<div class="sourceCode" id="cb140"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>predictions_new_hpo1 <span class="op">=</span> predictor_new_hpo1.predict(test)</span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>predictions_new_hpo1.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="91">
<pre><code>0    16.033894
1     3.644415
2     1.690593
3     1.489766
4     1.508111
Name: count, dtype: float32</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="92"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="JNG40WCkLH0g" data-outputId="5f52d68e-21b4-4e64-f5ac-5459cdd06992">
<div class="sourceCode" id="cb142"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Describe the `predictions_new_hpo1` series to see if there are any negative values</span></span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>predictions_new_hpo1.describe()</span></code></pre></div>
<div class="output execute_result" data-execution_count="92">
<pre><code>count    6493.000000
mean      190.507812
std       173.572083
min       -12.272228
25%        46.968765
50%       149.752762
75%       283.867035
max       937.209473
Name: count, dtype: float64</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="93"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="IhA74nHdLPdo" data-outputId="aeeb095f-ade9-43cc-93fe-c601c43a9d6a">
<div class="sourceCode" id="cb144"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="co"># How many negative values do we have?</span></span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Rechecking the predictions in predictions_new_hpo1</span></span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a>negative_pred_count <span class="op">=</span> predictions_new_hpo1.<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="dv">1</span> <span class="cf">if</span> x<span class="op">&lt;</span><span class="dv">0</span> <span class="cf">else</span> <span class="dv">0</span>)</span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-6"><a href="#cb144-6" aria-hidden="true" tabindex="-1"></a>pred_pos_count <span class="op">=</span> (negative_pred_count<span class="op">==</span><span class="dv">0</span>).<span class="bu">sum</span>()</span>
<span id="cb144-7"><a href="#cb144-7" aria-hidden="true" tabindex="-1"></a>pred_neg_count <span class="op">=</span> (negative_pred_count<span class="op">==</span><span class="dv">1</span>).<span class="bu">sum</span>()</span>
<span id="cb144-8"><a href="#cb144-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-9"><a href="#cb144-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Total predictions                :&quot;</span>, <span class="bu">len</span>(predictions_new_hpo1.index))</span>
<span id="cb144-10"><a href="#cb144-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Total positive prediction values :&quot;</span>, pred_pos_count)</span>
<span id="cb144-11"><a href="#cb144-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Total negative prediction values :&quot;</span>, pred_neg_count)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Total predictions                : 6493
Total positive prediction values : 6443
Total negative prediction values : 50
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="94"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="ep6pHAw4LTeC" data-outputId="6197a9d5-cac8-4284-caf0-86dc3e8b83df">
<div class="sourceCode" id="cb146"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remember to set all negative values to zero </span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>predictions_new_hpo1[predictions_new_hpo1<span class="op">&lt;</span><span class="dv">0</span>] <span class="op">=</span> <span class="dv">0</span>    <span class="co"># (In case, if negative values exist in the predictions_new_hpo1, set them to 0)</span></span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Rechecking, if no predictions are less than 0</span></span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a>negative_pred_count <span class="op">=</span> predictions_new_hpo1.<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="dv">1</span> <span class="cf">if</span> x<span class="op">&lt;</span><span class="dv">0</span> <span class="cf">else</span> <span class="dv">0</span>)</span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true" tabindex="-1"></a>pred_neg_count <span class="op">=</span> (negative_pred_count<span class="op">==</span><span class="dv">1</span>).<span class="bu">sum</span>()</span>
<span id="cb146-7"><a href="#cb146-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;No.of negative predictions: </span><span class="sc">{</span>pred_neg_count<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb146-8"><a href="#cb146-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;All negative values in the predictions (if any) are set to zero successfully.&quot;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>No.of negative predictions: 0
All negative values in the predictions (if any) are set to zero successfully.
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="95"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:206}"
id="_WGCbQiLLX_O" data-outputId="18dca9ff-e712-4b60-c475-de894a9937ad">
<div class="sourceCode" id="cb148"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Same thing as train and test dataset</span></span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a>submission_new_hpo1 <span class="op">=</span> pd.read_csv(<span class="st">&#39;sampleSubmission.csv&#39;</span>, parse_dates <span class="op">=</span> [<span class="st">&#39;datetime&#39;</span>])</span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a>submission_new_hpo1.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="95">

  <div id="df-e747eb65-37ca-451c-9a8c-c1280997a491">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>datetime</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2011-01-20 00:00:00</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2011-01-20 01:00:00</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2011-01-20 02:00:00</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2011-01-20 03:00:00</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2011-01-20 04:00:00</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-e747eb65-37ca-451c-9a8c-c1280997a491')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-e747eb65-37ca-451c-9a8c-c1280997a491 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-e747eb65-37ca-451c-9a8c-c1280997a491');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell code" data-execution_count="97"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:206}"
id="m5gwLRl6Lazi" data-outputId="1dd634db-6fa4-4ddb-9c7c-a01a24e4e6f2">
<div class="sourceCode" id="cb149"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Same submitting predictions</span></span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>submission_new_hpo1[<span class="st">&quot;count&quot;</span>] <span class="op">=</span> predictions_new_hpo1</span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a>submission_new_hpo1.to_csv(<span class="st">&quot;submission_new_hpo1.csv&quot;</span>, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a>submission_new_hpo1.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="97">

  <div id="df-bedd309d-47d2-473d-b6b9-e053dcc92f4d">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>datetime</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2011-01-20 00:00:00</td>
      <td>16.033894</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2011-01-20 01:00:00</td>
      <td>3.644415</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2011-01-20 02:00:00</td>
      <td>1.690593</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2011-01-20 03:00:00</td>
      <td>1.489766</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2011-01-20 04:00:00</td>
      <td>1.508111</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-bedd309d-47d2-473d-b6b9-e053dcc92f4d')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-bedd309d-47d2-473d-b6b9-e053dcc92f4d button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-bedd309d-47d2-473d-b6b9-e053dcc92f4d');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell code" data-execution_count="100"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="59RbeWDSLhrB" data-outputId="20675129-3b5f-40e3-e32b-ec354f8959d6">
<div class="sourceCode" id="cb150"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>kaggle competitions submit <span class="op">-</span>c bike<span class="op">-</span>sharing<span class="op">-</span>demand <span class="op">-</span>f submission_new_hpo1.csv <span class="op">-</span>m <span class="st">&quot;new features with hyperparameters 1&quot;</span></span></code></pre></div>
<div class="output stream stdout">
<pre><code>  0% 0.00/188k [00:00&lt;?, ?B/s]100% 188k/188k [00:00&lt;00:00, 1.01MB/s]
Successfully submitted to Bike Sharing Demand</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="102"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="4MyRbbQrL2Nf" data-outputId="796858b2-d5c0-4faf-bb02-f1027381a759">
<div class="sourceCode" id="cb152"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>kaggle competitions submissions <span class="op">-</span>c bike<span class="op">-</span>sharing<span class="op">-</span>demand <span class="op">|</span> tail <span class="op">-</span>n <span class="op">+</span><span class="dv">1</span> <span class="op">|</span> head <span class="op">-</span>n <span class="dv">7</span></span></code></pre></div>
<div class="output stream stdout">
<pre><code>fileName                     date                 description                          status    publicScore  privateScore  
---------------------------  -------------------  -----------------------------------  --------  -----------  ------------  
submission_new_hpo1.csv      2023-05-28 11:48:05  new features with hyperparameters 1  complete  0.49469      0.49469       
submission_new_hpo.csv       2023-05-28 11:47:18  new features with hyperparameters 1  complete  0.52785      0.52785       
submission_new_hpo.csv       2023-05-28 11:11:02  new features with hyperparameters    complete  0.52785      0.52785       
submission_new_features.csv  2023-05-28 10:44:54  new features                         complete  0.44956      0.44956       
submission.csv               2023-05-28 09:38:25  first raw submission                 complete  1.80520      1.80520       
</code></pre>
</div>
</div>
<section id="step-7-write-a-report" class="cell markdown"
id="I57XlDszE87r">
<h2>Step 7: Write a Report</h2>
<h3 id="refer-to-the-markdown-file-for-the-full-report">Refer to the
markdown file for the full report</h3>
<h3 id="creating-plots-and-table-for-report">Creating plots and table
for report</h3>
</section>
<div class="cell code" data-execution_count="107"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:542}"
id="E_Se41NQE87r" data-jupyter="{&quot;source_hidden&quot;:true}"
data-outputId="27e8d6ab-4d65-4022-df59-a905c12b4158">
<div class="sourceCode" id="cb154"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Taking the top model score from each training run and creating a line plot to show improvement</span></span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a><span class="co"># You can create these in the notebook and save them to PNG or use some other tool (e.g. google sheets, excel)</span></span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> pd.DataFrame(</span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb154-5"><a href="#cb154-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;model&quot;</span>: [<span class="st">&quot;initial&quot;</span>, <span class="st">&quot;add_features&quot;</span>, <span class="st">&quot;hpo&quot;</span>, <span class="st">&quot;hpo1&quot;</span>], </span>
<span id="cb154-6"><a href="#cb154-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;RMSE score (validation)&quot;</span>: [<span class="fl">53.0918</span>, <span class="fl">34.2609</span>, <span class="fl">37.622232</span>, <span class="fl">37.329139</span>]  <span class="co"># Note: Actual RMSE values are considered</span></span>
<span id="cb154-7"><a href="#cb154-7" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb154-8"><a href="#cb154-8" aria-hidden="true" tabindex="-1"></a>).plot(x<span class="op">=</span><span class="st">&quot;model&quot;</span>, y<span class="op">=</span><span class="st">&quot;RMSE score (validation)&quot;</span>, figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>)).get_figure()</span>
<span id="cb154-9"><a href="#cb154-9" aria-hidden="true" tabindex="-1"></a><span class="co"># fig.savefig(&#39;img/model_train_score.png&#39;)</span></span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_37271c91d75944799fe9745642b73185/b568ee465891720db261993088648825c706c0fc.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="109" id="5IyW1sEJSseN">
<div class="sourceCode" id="cb155"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a> fig.savefig(<span class="st">&#39;/content/sample_data/img/model_train_score.png&#39;</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="106"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:542}"
id="iUFfdNTPE87r" data-outputId="9513abf8-eb07-4e24-8adc-e645d84a98f3">
<div class="sourceCode" id="cb156"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Take the 3 kaggle scores (or more) and create a line plot to show improvement</span></span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> pd.DataFrame(</span>
<span id="cb156-3"><a href="#cb156-3" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb156-4"><a href="#cb156-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;test_eval&quot;</span>: [<span class="st">&quot;initial&quot;</span>, <span class="st">&quot;add_features&quot;</span>, <span class="st">&quot;hpo&quot;</span>, <span class="st">&quot;hpo1&quot;</span>],  </span>
<span id="cb156-5"><a href="#cb156-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;kaggle test_eval score&quot;</span>: [<span class="fl">1.80520</span>, <span class="fl">0.44956</span>, <span class="fl">0.52785</span>, <span class="fl">0.49469</span>]</span>
<span id="cb156-6"><a href="#cb156-6" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb156-7"><a href="#cb156-7" aria-hidden="true" tabindex="-1"></a>).plot(x<span class="op">=</span><span class="st">&quot;test_eval&quot;</span>, y<span class="op">=</span><span class="st">&quot;kaggle test_eval score&quot;</span>, figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>)).get_figure()</span>
<span id="cb156-8"><a href="#cb156-8" aria-hidden="true" tabindex="-1"></a><span class="co"># fig.savefig(&#39;img/model_test_score.png&#39;)</span></span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_37271c91d75944799fe9745642b73185/43749f265c8ca593ac32f0de152c68c56b82ea89.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="105" id="ayjorr6oTJcz">
<div class="sourceCode" id="cb157"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a>fig.savefig(<span class="st">&#39;/content/sample_data/img/model_test_score.png&#39;</span>)</span></code></pre></div>
</div>
<section id="hyperparameter-table" class="cell markdown"
id="d-EGmfkyE87s">
<h3>Hyperparameter table</h3>
</section>
<div class="cell code" data-execution_count="114"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:187}"
id="rlTnNiGdE87s" data-outputId="979e63f6-6df5-49b9-f630-8d6b4f6a3706">
<div class="sourceCode" id="cb158"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The 3 hyperparameters we tuned with the kaggle score as the result</span></span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">NOTE</span><span class="co">: Here the last &#39;hpo&#39; based top-model is the &#39;hpo1&#39; model with best Kaggle score within hyperparameter optimization category</span></span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a>pd.DataFrame({</span>
<span id="cb158-5"><a href="#cb158-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;model&quot;</span>: [<span class="st">&quot;initial&quot;</span>, <span class="st">&quot;add_features&quot;</span>, <span class="st">&quot;hpo (top-hpo-model: hpo1)&quot;</span>],</span>
<span id="cb158-6"><a href="#cb158-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;hpo1&quot;</span>: [<span class="st">&quot;prescribed_values&quot;</span>, <span class="st">&quot;prescribed_values&quot;</span>, <span class="st">&quot;Tree-Based Models: (GBM, XT, &amp; XGB)&quot;</span>],</span>
<span id="cb158-7"><a href="#cb158-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;hpo2&quot;</span>: [<span class="st">&quot;prescribed_values&quot;</span>, <span class="st">&quot;prescribed_values&quot;</span>, <span class="st">&quot;LightGBMXT&quot;</span>],</span>
<span id="cb158-8"><a href="#cb158-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;hpo3&quot;</span>: [<span class="st">&quot;presets: &#39;best quality&#39;&quot;</span>, <span class="st">&quot;presets: &#39;best quality&#39;&quot;</span>, <span class="st">&quot;presets: &#39;optimize_for_deployment&quot;</span>],</span>
<span id="cb158-9"><a href="#cb158-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;score&quot;</span>: [<span class="fl">1.80520</span>, <span class="fl">0.44956</span>, <span class="fl">0.49440</span>]</span>
<span id="cb158-10"><a href="#cb158-10" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<div class="output execute_result" data-execution_count="114">

  <div id="df-585eb180-760c-4d7c-a473-d92b19f718ee">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>model</th>
      <th>hpo1</th>
      <th>hpo2</th>
      <th>hpo3</th>
      <th>score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>initial</td>
      <td>prescribed_values</td>
      <td>prescribed_values</td>
      <td>presets: 'best quality'</td>
      <td>1.80520</td>
    </tr>
    <tr>
      <th>1</th>
      <td>add_features</td>
      <td>prescribed_values</td>
      <td>prescribed_values</td>
      <td>presets: 'best quality'</td>
      <td>0.44956</td>
    </tr>
    <tr>
      <th>2</th>
      <td>hpo (top-hpo-model: hpo1)</td>
      <td>Tree-Based Models: (GBM, XT, &amp; XGB)</td>
      <td>LightGBMXT</td>
      <td>presets: 'optimize_for_deployment</td>
      <td>0.49440</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-585eb180-760c-4d7c-a473-d92b19f718ee')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-585eb180-760c-4d7c-a473-d92b19f718ee button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-585eb180-760c-4d7c-a473-d92b19f718ee');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell code" data-execution_count="115"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="ZV_Eo5NNYIcD" data-outputId="067fee5f-12ca-4458-bc99-b10f235e1887">
<div class="sourceCode" id="cb159"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>jupyter nbconvert <span class="op">--</span>to html Udacity_bike_sharing_project.ipynb</span></code></pre></div>
<div class="output stream stdout">
<pre><code>[NbConvertApp] WARNING | pattern &#39;Udacity_bike_sharing_project.ipynb&#39; matched no files
This application is used to convert notebook files (*.ipynb)
        to various other formats.

        WARNING: THE COMMANDLINE INTERFACE MAY CHANGE IN FUTURE RELEASES.

Options
=======
The options below are convenience aliases to configurable class-options,
as listed in the &quot;Equivalent to&quot; description-line of the aliases.
To see all configurable class-options for some &lt;cmd&gt;, use:
    &lt;cmd&gt; --help-all

--debug
    set log level to logging.DEBUG (maximize logging output)
    Equivalent to: [--Application.log_level=10]
--show-config
    Show the application&#39;s configuration (human-readable format)
    Equivalent to: [--Application.show_config=True]
--show-config-json
    Show the application&#39;s configuration (json format)
    Equivalent to: [--Application.show_config_json=True]
--generate-config
    generate default config file
    Equivalent to: [--JupyterApp.generate_config=True]
-y
    Answer yes to any questions instead of prompting.
    Equivalent to: [--JupyterApp.answer_yes=True]
--execute
    Execute the notebook prior to export.
    Equivalent to: [--ExecutePreprocessor.enabled=True]
--allow-errors
    Continue notebook execution even if one of the cells throws an error and include the error message in the cell output (the default behaviour is to abort conversion). This flag is only relevant if &#39;--execute&#39; was specified, too.
    Equivalent to: [--ExecutePreprocessor.allow_errors=True]
--stdin
    read a single notebook file from stdin. Write the resulting notebook with default basename &#39;notebook.*&#39;
    Equivalent to: [--NbConvertApp.from_stdin=True]
--stdout
    Write notebook output to stdout instead of files.
    Equivalent to: [--NbConvertApp.writer_class=StdoutWriter]
--inplace
    Run nbconvert in place, overwriting the existing notebook (only
            relevant when converting to notebook format)
    Equivalent to: [--NbConvertApp.use_output_suffix=False --NbConvertApp.export_format=notebook --FilesWriter.build_directory=]
--clear-output
    Clear output of current file and save in place,
            overwriting the existing notebook.
    Equivalent to: [--NbConvertApp.use_output_suffix=False --NbConvertApp.export_format=notebook --FilesWriter.build_directory= --ClearOutputPreprocessor.enabled=True]
--no-prompt
    Exclude input and output prompts from converted document.
    Equivalent to: [--TemplateExporter.exclude_input_prompt=True --TemplateExporter.exclude_output_prompt=True]
--no-input
    Exclude input cells and output prompts from converted document.
            This mode is ideal for generating code-free reports.
    Equivalent to: [--TemplateExporter.exclude_output_prompt=True --TemplateExporter.exclude_input=True --TemplateExporter.exclude_input_prompt=True]
--allow-chromium-download
    Whether to allow downloading chromium if no suitable version is found on the system.
    Equivalent to: [--WebPDFExporter.allow_chromium_download=True]
--disable-chromium-sandbox
    Disable chromium security sandbox when converting to PDF..
    Equivalent to: [--WebPDFExporter.disable_sandbox=True]
--show-input
    Shows code input. This flag is only useful for dejavu users.
    Equivalent to: [--TemplateExporter.exclude_input=False]
--embed-images
    Embed the images as base64 dataurls in the output. This flag is only useful for the HTML/WebPDF/Slides exports.
    Equivalent to: [--HTMLExporter.embed_images=True]
--sanitize-html
    Whether the HTML in Markdown cells and cell outputs should be sanitized..
    Equivalent to: [--HTMLExporter.sanitize_html=True]
--log-level=&lt;Enum&gt;
    Set the log level by value or name.
    Choices: any of [0, 10, 20, 30, 40, 50, &#39;DEBUG&#39;, &#39;INFO&#39;, &#39;WARN&#39;, &#39;ERROR&#39;, &#39;CRITICAL&#39;]
    Default: 30
    Equivalent to: [--Application.log_level]
--config=&lt;Unicode&gt;
    Full path of a config file.
    Default: &#39;&#39;
    Equivalent to: [--JupyterApp.config_file]
--to=&lt;Unicode&gt;
    The export format to be used, either one of the built-in formats
            [&#39;asciidoc&#39;, &#39;custom&#39;, &#39;html&#39;, &#39;latex&#39;, &#39;markdown&#39;, &#39;notebook&#39;, &#39;pdf&#39;, &#39;python&#39;, &#39;rst&#39;, &#39;script&#39;, &#39;slides&#39;, &#39;webpdf&#39;]
            or a dotted object name that represents the import path for an
            ``Exporter`` class
    Default: &#39;&#39;
    Equivalent to: [--NbConvertApp.export_format]
--template=&lt;Unicode&gt;
    Name of the template to use
    Default: &#39;&#39;
    Equivalent to: [--TemplateExporter.template_name]
--template-file=&lt;Unicode&gt;
    Name of the template file to use
    Default: None
    Equivalent to: [--TemplateExporter.template_file]
--theme=&lt;Unicode&gt;
    Template specific theme(e.g. the name of a JupyterLab CSS theme distributed
    as prebuilt extension for the lab template)
    Default: &#39;light&#39;
    Equivalent to: [--HTMLExporter.theme]
--sanitize_html=&lt;Bool&gt;
    Whether the HTML in Markdown cells and cell outputs should be sanitized.This
    should be set to True by nbviewer or similar tools.
    Default: False
    Equivalent to: [--HTMLExporter.sanitize_html]
--writer=&lt;DottedObjectName&gt;
    Writer class used to write the
                                        results of the conversion
    Default: &#39;FilesWriter&#39;
    Equivalent to: [--NbConvertApp.writer_class]
--post=&lt;DottedOrNone&gt;
    PostProcessor class used to write the
                                        results of the conversion
    Default: &#39;&#39;
    Equivalent to: [--NbConvertApp.postprocessor_class]
--output=&lt;Unicode&gt;
    overwrite base name use for output files.
                can only be used when converting one notebook at a time.
    Default: &#39;&#39;
    Equivalent to: [--NbConvertApp.output_base]
--output-dir=&lt;Unicode&gt;
    Directory to write output(s) to. Defaults
                                  to output to the directory of each notebook. To recover
                                  previous default behaviour (outputting to the current
                                  working directory) use . as the flag value.
    Default: &#39;&#39;
    Equivalent to: [--FilesWriter.build_directory]
--reveal-prefix=&lt;Unicode&gt;
    The URL prefix for reveal.js (version 3.x).
            This defaults to the reveal CDN, but can be any url pointing to a copy
            of reveal.js.
            For speaker notes to work, this must be a relative path to a local
            copy of reveal.js: e.g., &quot;reveal.js&quot;.
            If a relative path is given, it must be a subdirectory of the
            current directory (from which the server is run).
            See the usage documentation
            (https://nbconvert.readthedocs.io/en/latest/usage.html#reveal-js-html-slideshow)
            for more details.
    Default: &#39;&#39;
    Equivalent to: [--SlidesExporter.reveal_url_prefix]
--nbformat=&lt;Enum&gt;
    The nbformat version to write.
            Use this to downgrade notebooks.
    Choices: any of [1, 2, 3, 4]
    Default: 4
    Equivalent to: [--NotebookExporter.nbformat_version]

Examples
--------

    The simplest way to use nbconvert is

            &gt; jupyter nbconvert mynotebook.ipynb --to html

            Options include [&#39;asciidoc&#39;, &#39;custom&#39;, &#39;html&#39;, &#39;latex&#39;, &#39;markdown&#39;, &#39;notebook&#39;, &#39;pdf&#39;, &#39;python&#39;, &#39;rst&#39;, &#39;script&#39;, &#39;slides&#39;, &#39;webpdf&#39;].

            &gt; jupyter nbconvert --to latex mynotebook.ipynb

            Both HTML and LaTeX support multiple output templates. LaTeX includes
            &#39;base&#39;, &#39;article&#39; and &#39;report&#39;.  HTML includes &#39;basic&#39;, &#39;lab&#39; and
            &#39;classic&#39;. You can specify the flavor of the format used.

            &gt; jupyter nbconvert --to html --template lab mynotebook.ipynb

            You can also pipe the output to stdout, rather than a file

            &gt; jupyter nbconvert mynotebook.ipynb --stdout

            PDF is generated via latex

            &gt; jupyter nbconvert mynotebook.ipynb --to pdf

            You can get (and serve) a Reveal.js-powered slideshow

            &gt; jupyter nbconvert myslides.ipynb --to slides --post serve

            Multiple notebooks can be given at the command line in a couple of
            different ways:

            &gt; jupyter nbconvert notebook*.ipynb
            &gt; jupyter nbconvert notebook1.ipynb notebook2.ipynb

            or you can specify the notebooks list in a config file, containing::

                c.NbConvertApp.notebooks = [&quot;my_notebook.ipynb&quot;]

            &gt; jupyter nbconvert --config mycfg.py

To see all available configurables, use `--help-all`.

</code></pre>
</div>
</div>
</body>
</html>
